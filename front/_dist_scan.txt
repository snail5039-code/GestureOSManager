C:\puh\puh\manager\GestureOSManager\front\dist\assets\index-BOxduUqw.js:8:`+N.stack}return{value:s,source:a,stack:A,digest:null}}function P(s,a,p){return{value:s,source:null,stack:p??null,digest:a??null}}function I(s,a){try{console.error(a.value)}catch(p){setTimeout(function(){throw p})}}var te=typeof WeakMap=="function"?WeakMap:Map;function me(s,a,p){p=Nn(-1,p),p.tag=3,p.payload={element:null};var y=a.value;return p.callback=function(){Dp||(Dp=!0,x0=y),I(s,a)},p}function ze(s,a,p){p=Nn(-1,p),p.tag=3;var y=s.type.getDerivedStateFromError;if(typeof y=="function"){var A=a.value;p.payload=function(){return y(A)},p.callback=function(){I(s,a)}}var N=s.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(p.callback=function(){I(s,a),typeof y!="function"&&(al===null?al=new Set([this]):al.add(this));var z=a.stack;this.componentDidCatch(a.value,{componentStack:z!==null?z:""})}),p}function Qe(s,a,p){var y=s.pingCache;if(y===null){y=s.pingCache=new te;var A=new Set;y.set(a,A)}else A=y.get(a),A===void 0&&(A=new Set,y.set(a,A));A.has(p)||(A.add(p),s=Ab.bind(null,s,a,p),a.then(s,s))}function wt(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function Qt(s,a,p,y,A){return(s.mode&1)===0?(s===a?s.flags|=65536:(s.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(a=Nn(-1,1),a.tag=2,Gn(p,a,1))),p.lanes|=1),s):(s.flags|=65536,s.lanes=A,s)}var Ht=L.ReactCurrentOwner,sn=!1;function xt(s,a,p,y){a.child=s===null?rc(a,null,p,y):oa(a,s.child,p,y)}function Dr(s,a,p,y,A){p=p.render;var N=a.ref;return bo(a,A),y=cc(s,a,p,y,N,A),p=Nf(),s!==null&&!sn?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~A,ga(s,a,A)):(Hn&&p&&Ef(a),a.flags|=1,xt(s,a,y,A),a.child)}function Ri(s,a,p,y,A){if(s===null){var N=p.type;return typeof N=="function"&&!b0(N)&&N.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(a.tag=15,a.type=N,Ce(s,a,N,y,A)):(s=zp(p.type,null,y,a,a.mode,A),s.ref=a.ref,s.return=a,a.child=s)}if(N=s.child,(s.lanes&A)===0){var z=N.memoizedProps;if(p=p.compare,p=p!==null?p:Zo,p(z,y)&&s.ref===a.ref)return ga(s,a,A)}return a.flags|=1,s=dl(N,y),s.ref=a.ref,s.return=a,a.child=s}function Ce(s,a,p,y,A){if(s!==null){var N=s.memoizedProps;if(Zo(N,y)&&s.ref===a.ref)if(sn=!1,a.pendingProps=y=N,(s.lanes&A)!==0)(s.flags&131072)!==0&&(sn=!0);else return a.lanes=s.lanes,ga(s,a,A)}return pt(s,a,p,y,A)}function xe(s,a,p){var y=a.pendingProps,A=y.children,N=s!==null?s.memoizedState:null;if(y.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dn(qu,fs),fs|=p;else{if((p&1073741824)===0)return s=N!==null?N.baseLanes|p:p,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,Dn(qu,fs),fs|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=N!==null?N.baseLanes:p,Dn(qu,fs),fs|=y}else N!==null?(y=N.baseLanes|p,a.memoizedState=null):y=p,Dn(qu,fs),fs|=y;return xt(s,a,A,p),a.child}function Ie(s,a){var p=a.ref;(s===null&&p!==null||s!==null&&s.ref!==p)&&(a.flags|=512,a.flags|=2097152)}function pt(s,a,p,y,A){var N=Hr(p)?js:Pr.current;return N=na(a,N),bo(a,A),p=cc(s,a,p,y,N,A),y=Nf(),s!==null&&!sn?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~A,ga(s,a,A)):(Hn&&y&&Ef(a),a.flags|=1,xt(s,a,p,A),a.child)}function Pt(s,a,p,y,A){if(Hr(p)){var N=!0;ra(a)}else N=!1;if(bo(a,A),a.stateNode===null)Rp(s,a),c(a,p,y),x(a,p,y,A),y=!0;else if(s===null){var z=a.stateNode,re=a.memoizedProps;z.props=re;var le=z.context,Ne=p.contextType;typeof Ne=="object"&&Ne!==null?Ne=bi(Ne):(Ne=Hr(p)?js:Pr.current,Ne=na(a,Ne));var Ke=p.getDerivedStateFromProps,Je=typeof Ke=="function"||typeof z.getSnapshotBeforeUpdate=="function";Je||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(re!==y||le!==Ne)&&d(a,z,y,Ne),Pn=!1;var Ye=a.memoizedState;z.state=Ye,tr(a,y,z,A),le=a.memoizedState,re!==y||Ye!==le||Qr.current||Pn?(typeof Ke=="function"&&(pc(a,p,Ke,y),le=a.memoizedState),(re=Pn||Ap(a,p,re,y,Ye,le,Ne))?(Je||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(a.flags|=4194308)):(typeof z.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=y,a.memoizedState=le),z.props=y,z.state=le,z.context=Ne,y=re):(typeof z.componentDidMount=="function"&&(a.flags|=4194308),y=!1)}else{z=a.stateNode,or(s,a),re=a.memoizedProps,Ne=a.type===a.elementType?re:Xi(a.type,re),z.props=Ne,Je=a.pendingProps,Ye=z.context,le=p.contextType,typeof le=="object"&&le!==null?le=bi(le):(le=Hr(p)?js:Pr.current,le=na(a,le));var St=p.getDerivedStateFromProps;(Ke=typeof St=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(re!==Je||Ye!==le)&&d(a,z,y,le),Pn=!1,Ye=a.memoizedState,z.state=Ye,tr(a,y,z,A);var Tt=a.memoizedState;re!==Je||Ye!==Tt||Qr.current||Pn?(typeof St=="function"&&(pc(a,p,St,y),Tt=a.memoizedState),(Ne=Pn||Ap(a,p,Ne,y,Ye,Tt,le)||!1)?(Ke||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(y,Tt,le),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(y,Tt,le)),typeof z.componentDidUpdate=="function"&&(a.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof z.componentDidUpdate!="function"||re===s.memoizedProps&&Ye===s.memoizedState||(a.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||re===s.memoizedProps&&Ye===s.memoizedState||(a.flags|=1024),a.memoizedProps=y,a.memoizedState=Tt),z.props=y,z.state=Tt,z.context=le,y=Ne):(typeof z.componentDidUpdate!="function"||re===s.memoizedProps&&Ye===s.memoizedState||(a.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||re===s.memoizedProps&&Ye===s.memoizedState||(a.flags|=1024),y=!1)}return nn(s,a,p,y,N,A)}function nn(s,a,p,y,A,N){Ie(s,a);var z=(a.flags&128)!==0;if(!y&&!z)return A&&wf(a,p,!1),ga(s,a,N);y=a.stateNode,Ht.current=a;var re=z&&typeof p.getDerivedStateFromError!="function"?null:y.render();return a.flags|=1,s!==null&&z?(a.child=oa(a,s.child,null,N),a.child=oa(a,null,re,N)):xt(s,a,re,N),a.memoizedState=y.state,A&&wf(a,p,!0),a.child}function en(s){var a=s.stateNode;a.pendingContext?Sf(s,a.pendingContext,a.pendingContext!==a.context):a.context&&Sf(s,a.context,!1),ac(s,a.containerInfo)}function Sn(s,a,p,y,A){return Eo(),el(A),a.flags|=256,xt(s,a,p,y),a.child}var cr={dehydrated:null,treeContext:null,retryLane:0};function yn(s){return{baseLanes:s,cachePool:null,transitions:null}}function Js(s,a,p){var y=a.pendingProps,A=jn.current,N=!1,z=(a.flags&128)!==0,re;if((re=z)||(re=s!==null&&s.memoizedState===null?!1:(A&2)!==0),re?(N=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(A|=1),Dn(jn,A&1),s===null)return Uu(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((a.mode&1)===0?a.lanes=1:s.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(z=y.children,s=y.fallback,N?(y=a.mode,N=a.child,z={mode:"hidden",children:z},(y&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=z):N=Hp(z,y,0,null),s=yc(s,y,p,null),N.return=a,s.return=a,N.sibling=s,a.child=N,a.child.memoizedState=yn(p),a.memoizedState=cr,s):Bf(a,z));if(A=s.memoizedState,A!==null&&(re=A.dehydrated,re!==null))return mb(s,a,z,y,re,A,p);if(N){N=y.fallback,z=a.mode,A=s.child,re=A.sibling;var le={mode:"hidden",children:y.children};return(z&1)===0&&a.child!==A?(y=a.child,y.childLanes=0,y.pendingProps=le,a.deletions=null):(y=dl(A,le),y.subtreeFlags=A.subtreeFlags&14680064),re!==null?N=dl(re,N):(N=yc(N,z,p,null),N.flags|=2),N.return=a,y.return=a,y.sibling=N,a.child=y,y=N,N=a.child,z=s.child.memoizedState,z=z===null?yn(p):{baseLanes:z.baseLanes|p,cachePool:null,transitions:z.transitions},N.memoizedState=z,N.childLanes=s.childLanes&~p,a.memoizedState=cr,y}return N=s.child,s=N.sibling,y=dl(N,{mode:"visible",children:y.children}),(a.mode&1)===0&&(y.lanes=p),y.return=a,y.sibling=null,s!==null&&(p=a.deletions,p===null?(a.deletions=[s],a.flags|=16):p.push(s)),a.child=y,a.memoizedState=null,y}function Bf(s,a){return a=Hp({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function Cp(s,a,p,y){return y!==null&&el(y),oa(a,s.child,null,p),s=Bf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function mb(s,a,p,y,A,N,z){if(p)return a.flags&256?(a.flags&=-257,y=P(Error(t(422))),Cp(s,a,z,y)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(N=y.fallback,A=a.mode,y=Hp({mode:"visible",children:y.children},A,0,null),N=yc(N,A,z,null),N.flags|=2,y.return=a,N.return=a,y.sibling=N,a.child=y,(a.mode&1)!==0&&oa(a,s.child,null,z),a.child.memoizedState=yn(z),a.memoizedState=cr,N);if((a.mode&1)===0)return Cp(s,a,z,null);if(A.data==="$!"){if(y=A.nextSibling&&A.nextSibling.dataset,y)var re=y.dgst;return y=re,N=Error(t(419)),y=P(N,y,void 0),Cp(s,a,z,y)}if(re=(z&s.childLanes)!==0,sn||re){if(y=Gr,y!==null){switch(z&-z){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}A=(A&(y.suspendedLanes|z))!==0?0:A,A!==0&&A!==N.retryLane&&(N.retryLane=A,ls(s,A),eo(y,s,A,-1))}return E0(),y=P(Error(t(421))),Cp(s,a,z,y)}return A.data==="$?"?(a.flags|=128,a.child=s.child,a=Cb.bind(null,s),A._reactRetry=a,null):(s=N.treeContext,ti=Bs(A.nextSibling),Nr=a,Hn=!0,Wi=null,s!==null&&(ei[br++]=at,ei[br++]=Gi,ei[br++]=sa,at=s.id,Gi=s.overflow,sa=a),a=Bf(a,y.children),a.flags|=4096,a)}function Oy(s,a,p){s.lanes|=a;var y=s.alternate;y!==null&&(y.lanes|=a),sc(s.return,a,p)}function c0(s,a,p,y,A){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:A}:(N.isBackwards=a,N.rendering=null,N.renderingStartTime=0,N.last=y,N.tail=p,N.tailMode=A)}function Uy(s,a,p){var y=a.pendingProps,A=y.revealOrder,N=y.tail;if(xt(s,a,y.children,p),y=jn.current,(y&2)!==0)y=y&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Oy(s,p,a);else if(s.tag===19)Oy(s,p,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}y&=1}if(Dn(jn,y),(a.mode&1)===0)a.memoizedState=null;else switch(A){case"forwards":for(p=a.child,A=null;p!==null;)s=p.alternate,s!==null&&cs(s)===null&&(A=p),p=p.sibling;p=A,p===null?(A=a.child,a.child=null):(A=p.sibling,p.sibling=null),c0(a,!1,A,p,N);break;case"backwards":for(p=null,A=a.child,a.child=null;A!==null;){if(s=A.alternate,s!==null&&cs(s)===null){a.child=A;break}s=A.sibling,A.sibling=p,p=A,A=s}c0(a,!0,p,null,N);break;case"together":c0(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Rp(s,a){(a.mode&1)===0&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function ga(s,a,p){if(s!==null&&(a.dependencies=s.dependencies),mc|=a.lanes,(p&a.childLanes)===0)return null;if(s!==null&&a.child!==s.child)throw Error(t(153));if(a.child!==null){for(s=a.child,p=dl(s,s.pendingProps),a.child=p,p.return=a;s.sibling!==null;)s=s.sibling,p=p.sibling=dl(s,s.pendingProps),p.return=a;p.sibling=null}return a.child}function gb(s,a,p){switch(a.tag){case 3:en(a),Eo();break;case 5:fa(a);break;case 1:Hr(a.type)&&ra(a);break;case 4:ac(a,a.stateNode.containerInfo);break;case 10:var y=a.type._context,A=a.memoizedProps.value;Dn(aa,y._currentValue),y._currentValue=A;break;case 13:if(y=a.memoizedState,y!==null)return y.dehydrated!==null?(Dn(jn,jn.current&1),a.flags|=128,null):(p&a.child.childLanes)!==0?Js(s,a,p):(Dn(jn,jn.current&1),s=ga(s,a,p),s!==null?s.sibling:null);Dn(jn,jn.current&1);break;case 19:if(y=(p&a.childLanes)!==0,(s.flags&128)!==0){if(y)return Uy(s,a,p);a.flags|=128}if(A=a.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Dn(jn,jn.current),y)break;return null;case 22:case 23:return a.lanes=0,xe(s,a,p)}return ga(s,a,p)}var Fy,u0,By,zy;Fy=function(s,a){for(var p=a.child;p!==null;){if(p.tag===5||p.tag===6)s.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break;for(;p.sibling===null;){if(p.return===null||p.return===a)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},u0=function(){},By=function(s,a,p,y){var A=s.memoizedProps;if(A!==y){s=a.stateNode,lr(Ti.current);var N=null;switch(p){case"input":A=Ee(s,A),y=Ee(s,y),N=[];break;case"select":A=V({},A,{value:void 0}),y=V({},y,{value:void 0}),N=[];break;case"textarea":A=Pe(s,A),y=Pe(s,y),N=[];break;default:typeof A.onClick!="function"&&typeof y.onClick=="function"&&(s.onclick=Zl)}Wt(p,y);var z;p=null;for(Ne in A)if(!y.hasOwnProperty(Ne)&&A.hasOwnProperty(Ne)&&A[Ne]!=null)if(Ne==="style"){var re=A[Ne];for(z in re)re.hasOwnProperty(z)&&(p||(p={}),p[z]="")}else Ne!=="dangerouslySetInnerHTML"&&Ne!=="children"&&Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&Ne!=="autoFocus"&&(r.hasOwnProperty(Ne)?N||(N=[]):(N=N||[]).push(Ne,null));for(Ne in y){var le=y[Ne];if(re=A?.[Ne],y.hasOwnProperty(Ne)&&le!==re&&(le!=null||re!=null))if(Ne==="style")if(re){for(z in re)!re.hasOwnProperty(z)||le&&le.hasOwnProperty(z)||(p||(p={}),p[z]="");for(z in le)le.hasOwnProperty(z)&&re[z]!==le[z]&&(p||(p={}),p[z]=le[z])}else p||(N||(N=[]),N.push(Ne,p)),p=le;else Ne==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,re=re?re.__html:void 0,le!=null&&re!==le&&(N=N||[]).push(Ne,le)):Ne==="children"?typeof le!="string"&&typeof le!="number"||(N=N||[]).push(Ne,""+le):Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&(r.hasOwnProperty(Ne)?(le!=null&&Ne==="onScroll"&&Fn("scroll",s),N||re===le||(N=[])):(N=N||[]).push(Ne,le))}p&&(N=N||[]).push("style",p);var Ne=N;(a.updateQueue=Ne)&&(a.flags|=4)}},zy=function(s,a,p,y){p!==y&&(a.flags|=4)};function zf(s,a){if(!Hn)switch(s.tailMode){case"hidden":a=s.tail;for(var p=null;a!==null;)a.alternate!==null&&(p=a),a=a.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:y.sibling=null}}function di(s){var a=s.alternate!==null&&s.alternate.child===s.child,p=0,y=0;if(a)for(var A=s.child;A!==null;)p|=A.lanes|A.childLanes,y|=A.subtreeFlags&14680064,y|=A.flags&14680064,A.return=s,A=A.sibling;else for(A=s.child;A!==null;)p|=A.lanes|A.childLanes,y|=A.subtreeFlags,y|=A.flags,A.return=s,A=A.sibling;return s.subtreeFlags|=y,s.childLanes=p,a}function vb(s,a,p){var y=a.pendingProps;switch(Gs(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return di(a),null;case 1:return Hr(a.type)&&Jl(),di(a),null;case 3:return y=a.stateNode,To(),Bn(Qr),Bn(Pr),bs(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(s===null||s.child===null)&&(Qa(a)?a.flags|=4:s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Wi!==null&&(S0(Wi),Wi=null))),u0(s,a),di(a),null;case 5:rl(a);var A=lr(Ys.current);if(p=a.type,s!==null&&a.stateNode!=null)By(s,a,p,y,A),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!y){if(a.stateNode===null)throw Error(t(166));return di(a),null}if(s=lr(Ti.current),Qa(a)){y=a.stateNode,p=a.type;var N=a.memoizedProps;switch(y[mr]=a,y[$a]=N,s=(a.mode&1)!==0,p){case"dialog":Fn("cancel",y),Fn("close",y);break;case"iframe":case"object":case"embed":Fn("load",y);break;case"video":case"audio":for(A=0;A<wo.length;A++)Fn(wo[A],y);break;case"source":Fn("error",y);break;case"img":case"image":case"link":Fn("error",y),Fn("load",y);break;case"details":Fn("toggle",y);break;case"input":ke(y,N),Fn("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!N.multiple},Fn("invalid",y);break;case"textarea":we(y,N),Fn("invalid",y)}Wt(p,N),A=null;for(var z in N)if(N.hasOwnProperty(z)){var re=N[z];z==="children"?typeof re=="string"?y.textContent!==re&&(N.suppressHydrationWarning!==!0&&Kl(y.textContent,re,s),A=["children",re]):typeof re=="number"&&y.textContent!==""+re&&(N.suppressHydrationWarning!==!0&&Kl(y.textContent,re,s),A=["children",""+re]):r.hasOwnProperty(z)&&re!=null&&z==="onScroll"&&Fn("scroll",y)}switch(p){case"input":st(y),se(y,N,!0);break;case"textarea":st(y),rt(y);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(y.onclick=Zl)}y=A,a.updateQueue=y,y!==null&&(a.flags|=4)}else{z=A.nodeType===9?A:A.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=He(p)),s==="http://www.w3.org/1999/xhtml"?p==="script"?(s=z.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof y.is=="string"?s=z.createElement(p,{is:y.is}):(s=z.createElement(p),p==="select"&&(z=s,y.multiple?z.multiple=!0:y.size&&(z.size=y.size))):s=z.createElementNS(s,p),s[mr]=a,s[$a]=y,Fy(s,a,!1,!1),a.stateNode=s;e:{switch(z=on(p,y),p){case"dialog":Fn("cancel",s),Fn("close",s),A=y;break;case"iframe":case"object":case"embed":Fn("load",s),A=y;break;case"video":case"audio":for(A=0;A<wo.length;A++)Fn(wo[A],s);A=y;break;case"source":Fn("error",s),A=y;break;case"img":case"image":case"link":Fn("error",s),Fn("load",s),A=y;break;case"details":Fn("toggle",s),A=y;break;case"input":ke(s,y),A=Ee(s,y),Fn("invalid",s);break;case"option":A=y;break;case"select":s._wrapperState={wasMultiple:!!y.multiple},A=V({},y,{value:void 0}),Fn("invalid",s);break;case"textarea":we(s,y),A=Pe(s,y),Fn("invalid",s);break;default:A=y}Wt(p,A),re=A;for(N in re)if(re.hasOwnProperty(N)){var le=re[N];N==="style"?bt(s,le):N==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,le!=null&&Et(s,le)):N==="children"?typeof le=="string"?(p!=="textarea"||le!=="")&&Oe(s,le):typeof le=="number"&&Oe(s,""+le):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(r.hasOwnProperty(N)?le!=null&&N==="onScroll"&&Fn("scroll",s):le!=null&&R(s,N,le,z))}switch(p){case"input":st(s),se(s,y,!1);break;case"textarea":st(s),rt(s);break;case"option":y.value!=null&&s.setAttribute("value",""+Ge(y.value));break;case"select":s.multiple=!!y.multiple,N=y.value,N!=null?ce(s,!!y.multiple,N,!1):y.defaultValue!=null&&ce(s,!!y.multiple,y.defaultValue,!0);break;default:typeof A.onClick=="function"&&(s.onclick=Zl)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return di(a),null;case 6:if(s&&a.stateNode!=null)zy(s,a,s.memoizedProps,y);else{if(typeof y!="string"&&a.stateNode===null)throw Error(t(166));if(p=lr(Ys.current),lr(Ti.current),Qa(a)){if(y=a.stateNode,p=a.memoizedProps,y[mr]=a,(N=y.nodeValue!==p)&&(s=Nr,s!==null))switch(s.tag){case 3:Kl(y.nodeValue,p,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Kl(y.nodeValue,p,(s.mode&1)!==0)}N&&(a.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[mr]=a,a.stateNode=y}return di(a),null;case 13:if(Bn(jn),y=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Hn&&ti!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Af(),Eo(),a.flags|=98560,N=!1;else if(N=Qa(a),y!==null&&y.dehydrated!==null){if(s===null){if(!N)throw Error(t(318));if(N=a.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(t(317));N[mr]=a}else Eo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;di(a),N=!1}else Wi!==null&&(S0(Wi),Wi=null),N=!0;if(!N)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=p,a):(y=y!==null,y!==(s!==null&&s.memoizedState!==null)&&y&&(a.child.flags|=8192,(a.mode&1)!==0&&(s===null||(jn.current&1)!==0?kr===0&&(kr=3):E0())),a.updateQueue!==null&&(a.flags|=4),di(a),null);case 4:return To(),u0(s,a),s===null&&Ka(a.stateNode.containerInfo),di(a),null;case 10:return ic(a.type._context),di(a),null;case 17:return Hr(a.type)&&Jl(),di(a),null;case 19:if(Bn(jn),N=a.memoizedState,N===null)return di(a),null;if(y=(a.flags&128)!==0,z=N.rendering,z===null)if(y)zf(N,!1);else{if(kr!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(z=cs(s),z!==null){for(a.flags|=128,zf(N,!1),y=z.updateQueue,y!==null&&(a.updateQueue=y,a.flags|=4),a.subtreeFlags=0,y=p,p=a.child;p!==null;)N=p,s=y,N.flags&=14680066,z=N.alternate,z===null?(N.childLanes=0,N.lanes=s,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=z.childLanes,N.lanes=z.lanes,N.child=z.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=z.memoizedProps,N.memoizedState=z.memoizedState,N.updateQueue=z.updateQueue,N.type=z.type,s=z.dependencies,N.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),p=p.sibling;return Dn(jn,jn.current&1|2),a.child}s=s.sibling}N.tail!==null&&tt()>Ku&&(a.flags|=128,y=!0,zf(N,!1),a.lanes=4194304)}else{if(!y)if(s=cs(z),s!==null){if(a.flags|=128,y=!0,p=s.updateQueue,p!==null&&(a.updateQueue=p,a.flags|=4),zf(N,!0),N.tail===null&&N.tailMode==="hidden"&&!z.alternate&&!Hn)return di(a),null}else 2*tt()-N.renderingStartTime>Ku&&p!==1073741824&&(a.flags|=128,y=!0,zf(N,!1),a.lanes=4194304);N.isBackwards?(z.sibling=a.child,a.child=z):(p=N.last,p!==null?p.sibling=z:a.child=z,N.last=z)}return N.tail!==null?(a=N.tail,N.rendering=a,N.tail=a.sibling,N.renderingStartTime=tt(),a.sibling=null,p=jn.current,Dn(jn,y?p&1|2:p&1),a):(di(a),null);case 22:case 23:return M0(),y=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==y&&(a.flags|=8192),y&&(a.mode&1)!==0?(fs&1073741824)!==0&&(di(a),a.subtreeFlags&6&&(a.flags|=8192)):di(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function xb(s,a){switch(Gs(a),a.tag){case 1:return Hr(a.type)&&Jl(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return To(),Bn(Qr),Bn(Pr),bs(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 5:return rl(a),null;case 13:if(Bn(jn),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(t(340));Eo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return Bn(jn),null;case 4:return To(),null;case 10:return ic(a.type._context),null;case 22:case 23:return M0(),null;case 24:return null;default:return null}}var Pp=!1,fi=!1,yb=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function Yu(s,a){var p=s.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){ur(s,a,y)}else p.current=null}function d0(s,a,p){try{p()}catch(y){ur(s,a,y)}}var Hy=!1;function _b(s,a){if(Ja=Fi,s=Jn(),Sr(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var A=y.anchorOffset,N=y.focusNode;y=y.focusOffset;try{p.nodeType,N.nodeType}catch{p=null;break e}var z=0,re=-1,le=-1,Ne=0,Ke=0,Je=s,Ye=null;t:for(;;){for(var St;Je!==p||A!==0&&Je.nodeType!==3||(re=z+A),Je!==N||y!==0&&Je.nodeType!==3||(le=z+y),Je.nodeType===3&&(z+=Je.nodeValue.length),(St=Je.firstChild)!==null;)Ye=Je,Je=St;for(;;){if(Je===s)break t;if(Ye===p&&++Ne===A&&(re=z),Ye===N&&++Ke===y&&(le=z),(St=Je.nextSibling)!==null)break;Je=Ye,Ye=Je.parentNode}Je=St}p=re===-1||le===-1?null:{start:re,end:le}}else p=null}p=p||{start:0,end:0}}else p=null;for(mf={focusedElem:s,selectionRange:p},Fi=!1,Mt=a;Mt!==null;)if(a=Mt,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Mt=s;else for(;Mt!==null;){a=Mt;try{var Tt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var At=Tt.memoizedProps,gr=Tt.memoizedState,Me=a.stateNode,pe=Me.getSnapshotBeforeUpdate(a.elementType===a.type?At:Xi(a.type,At),gr);Me.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var Ae=a.stateNode.containerInfo;Ae.nodeType===1?Ae.textContent="":Ae.nodeType===9&&Ae.documentElement&&Ae.removeChild(Ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(nt){ur(a,a.return,nt)}if(s=a.sibling,s!==null){s.return=a.return,Mt=s;break}Mt=a.return}return Tt=Hy,Hy=!1,Tt}function Hf(s,a,p){var y=a.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var A=y=y.next;do{if((A.tag&s)===s){var N=A.destroy;A.destroy=void 0,N!==void 0&&d0(a,p,N)}A=A.next}while(A!==y)}}function Np(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var p=a=a.next;do{if((p.tag&s)===s){var y=p.create;p.destroy=y()}p=p.next}while(p!==a)}}function f0(s){var a=s.ref;if(a!==null){var p=s.stateNode;s.tag,s=p,typeof a=="function"?a(s):a.current=s}}function jy(s){var a=s.alternate;a!==null&&(s.alternate=null,jy(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&(delete a[mr],delete a[$a],delete a[ta],delete a[Pu],delete a[Nu])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Vy(s){return s.tag===5||s.tag===3||s.tag===4}function Gy(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Vy(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function h0(s,a,p){var y=s.tag;if(y===5||y===6)s=s.stateNode,a?p.nodeType===8?p.parentNode.insertBefore(s,a):p.insertBefore(s,a):(p.nodeType===8?(a=p.parentNode,a.insertBefore(s,p)):(a=p,a.appendChild(s)),p=p._reactRootContainer,p!=null||a.onclick!==null||(a.onclick=Zl));else if(y!==4&&(s=s.child,s!==null))for(h0(s,a,p),s=s.sibling;s!==null;)h0(s,a,p),s=s.sibling}function p0(s,a,p){var y=s.tag;if(y===5||y===6)s=s.stateNode,a?p.insertBefore(s,a):p.appendChild(s);else if(y!==4&&(s=s.child,s!==null))for(p0(s,a,p),s=s.sibling;s!==null;)p0(s,a,p),s=s.sibling}var ri=null,$s=!1;function ol(s,a,p){for(p=p.child;p!==null;)Wy(s,a,p),p=p.sibling}function Wy(s,a,p){if(ft&&typeof ft.onCommitFiberUnmount=="function")try{ft.onCommitFiberUnmount($t,p)}catch{}switch(p.tag){case 5:fi||Yu(p,a);case 6:var y=ri,A=$s;ri=null,ol(s,a,p),ri=y,$s=A,ri!==null&&($s?(s=ri,p=p.stateNode,s.nodeType===8?s.parentNode.removeChild(p):s.removeChild(p)):ri.removeChild(p.stateNode));break;case 18:ri!==null&&($s?(s=ri,p=p.stateNode,s.nodeType===8?Ru(s.parentNode,p):s.nodeType===1&&Ru(s,p),Fl(s)):Ru(ri,p.stateNode));break;case 4:y=ri,A=$s,ri=p.stateNode.containerInfo,$s=!0,ol(s,a,p),ri=y,$s=A;break;case 0:case 11:case 14:case 15:if(!fi&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){A=y=y.next;do{var N=A,z=N.destroy;N=N.tag,z!==void 0&&((N&2)!==0||(N&4)!==0)&&d0(p,a,z),A=A.next}while(A!==y)}ol(s,a,p);break;case 1:if(!fi&&(Yu(p,a),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(re){ur(p,a,re)}ol(s,a,p);break;case 21:ol(s,a,p);break;case 22:p.mode&1?(fi=(y=fi)||p.memoizedState!==null,ol(s,a,p),fi=y):ol(s,a,p);break;default:ol(s,a,p)}}function Xy(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var p=s.stateNode;p===null&&(p=s.stateNode=new yb),a.forEach(function(y){var A=Rb.bind(null,s,y);p.has(y)||(p.add(y),y.then(A,A))})}}function Qs(s,a){var p=a.deletions;if(p!==null)for(var y=0;y<p.length;y++){var A=p[y];try{var N=s,z=a,re=z;e:for(;re!==null;){switch(re.tag){case 5:ri=re.stateNode,$s=!1;break e;case 3:ri=re.stateNode.containerInfo,$s=!0;break e;case 4:ri=re.stateNode.containerInfo,$s=!0;break e}re=re.return}if(ri===null)throw Error(t(160));Wy(N,z,A),ri=null,$s=!1;var le=A.alternate;le!==null&&(le.return=null),A.return=null}catch(Ne){ur(A,a,Ne)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Yy(a,s),a=a.sibling}function Yy(s,a){var p=s.alternate,y=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Qs(a,s),Co(s),y&4){try{Hf(3,s,s.return),Np(3,s)}catch(At){ur(s,s.return,At)}try{Hf(5,s,s.return)}catch(At){ur(s,s.return,At)}}break;case 1:Qs(a,s),Co(s),y&512&&p!==null&&Yu(p,p.return);break;case 5:if(Qs(a,s),Co(s),y&512&&p!==null&&Yu(p,p.return),s.flags&32){var A=s.stateNode;try{Oe(A,"")}catch(At){ur(s,s.return,At)}}if(y&4&&(A=s.stateNode,A!=null)){var N=s.memoizedProps,z=p!==null?p.memoizedProps:N,re=s.type,le=s.updateQueue;if(s.updateQueue=null,le!==null)try{re==="input"&&N.type==="radio"&&N.name!=null&&Se(A,N),on(re,z);var Ne=on(re,N);for(z=0;z<le.length;z+=2){var Ke=le[z],Je=le[z+1];Ke==="style"?bt(A,Je):Ke==="dangerouslySetInnerHTML"?Et(A,Je):Ke==="children"?Oe(A,Je):R(A,Ke,Je,Ne)}switch(re){case"input":be(A,N);break;case"textarea":Te(A,N);break;case"select":var Ye=A._wrapperState.wasMultiple;A._wrapperState.wasMultiple=!!N.multiple;var St=N.value;St!=null?ce(A,!!N.multiple,St,!1):Ye!==!!N.multiple&&(N.defaultValue!=null?ce(A,!!N.multiple,N.defaultValue,!0):ce(A,!!N.multiple,N.multiple?[]:"",!1))}A[$a]=N}catch(At){ur(s,s.return,At)}}break;case 6:if(Qs(a,s),Co(s),y&4){if(s.stateNode===null)throw Error(t(162));A=s.stateNode,N=s.memoizedProps;try{A.nodeValue=N}catch(At){ur(s,s.return,At)}}break;case 3:if(Qs(a,s),Co(s),y&4&&p!==null&&p.memoizedState.isDehydrated)try{Fl(a.containerInfo)}catch(At){ur(s,s.return,At)}break;case 4:Qs(a,s),Co(s);break;case 13:Qs(a,s),Co(s),A=s.child,A.flags&8192&&(N=A.memoizedState!==null,A.stateNode.isHidden=N,!N||A.alternate!==null&&A.alternate.memoizedState!==null||(v0=tt())),y&4&&Xy(s);break;case 22:if(Ke=p!==null&&p.memoizedState!==null,s.mode&1?(fi=(Ne=fi)||Ke,Qs(a,s),fi=Ne):Qs(a,s),Co(s),y&8192){if(Ne=s.memoizedState!==null,(s.stateNode.isHidden=Ne)&&!Ke&&(s.mode&1)!==0)for(Mt=s,Ke=s.child;Ke!==null;){for(Je=Mt=Ke;Mt!==null;){switch(Ye=Mt,St=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:Hf(4,Ye,Ye.return);break;case 1:Yu(Ye,Ye.return);var Tt=Ye.stateNode;if(typeof Tt.componentWillUnmount=="function"){y=Ye,p=Ye.return;try{a=y,Tt.props=a.memoizedProps,Tt.state=a.memoizedState,Tt.componentWillUnmount()}catch(At){ur(y,p,At)}}break;case 5:Yu(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){Zy(Je);continue}}St!==null?(St.return=Ye,Mt=St):Zy(Je)}Ke=Ke.sibling}e:for(Ke=null,Je=s;;){if(Je.tag===5){if(Ke===null){Ke=Je;try{A=Je.stateNode,Ne?(N=A.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(re=Je.stateNode,le=Je.memoizedProps.style,z=le!=null&&le.hasOwnProperty("display")?le.display:null,re.style.display=Ct("display",z))}catch(At){ur(s,s.return,At)}}}else if(Je.tag===6){if(Ke===null)try{Je.stateNode.nodeValue=Ne?"":Je.memoizedProps}catch(At){ur(s,s.return,At)}}else if((Je.tag!==22&&Je.tag!==23||Je.memoizedState===null||Je===s)&&Je.child!==null){Je.child.return=Je,Je=Je.child;continue}if(Je===s)break e;for(;Je.sibling===null;){if(Je.return===null||Je.return===s)break e;Ke===Je&&(Ke=null),Je=Je.return}Ke===Je&&(Ke=null),Je.sibling.return=Je.return,Je=Je.sibling}}break;case 19:Qs(a,s),Co(s),y&4&&Xy(s);break;case 21:break;default:Qs(a,s),Co(s)}}function Co(s){var a=s.flags;if(a&2){try{e:{for(var p=s.return;p!==null;){if(Vy(p)){var y=p;break e}p=p.return}throw Error(t(160))}switch(y.tag){case 5:var A=y.stateNode;y.flags&32&&(Oe(A,""),y.flags&=-33);var N=Gy(s);p0(s,N,A);break;case 3:case 4:var z=y.stateNode.containerInfo,re=Gy(s);h0(s,re,z);break;default:throw Error(t(161))}}catch(le){ur(s,s.return,le)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function Sb(s,a,p){Mt=s,qy(s)}function qy(s,a,p){for(var y=(s.mode&1)!==0;Mt!==null;){var A=Mt,N=A.child;if(A.tag===22&&y){var z=A.memoizedState!==null||Pp;if(!z){var re=A.alternate,le=re!==null&&re.memoizedState!==null||fi;re=Pp;var Ne=fi;if(Pp=z,(fi=le)&&!Ne)for(Mt=A;Mt!==null;)z=Mt,le=z.child,z.tag===22&&z.memoizedState!==null?Jy(A):le!==null?(le.return=z,Mt=le):Jy(A);for(;N!==null;)Mt=N,qy(N),N=N.sibling;Mt=A,Pp=re,fi=Ne}Ky(s)}else(A.subtreeFlags&8772)!==0&&N!==null?(N.return=A,Mt=N):Ky(s)}}function Ky(s){for(;Mt!==null;){var a=Mt;if((a.flags&8772)!==0){var p=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:fi||Np(5,a);break;case 1:var y=a.stateNode;if(a.flags&4&&!fi)if(p===null)y.componentDidMount();else{var A=a.elementType===a.type?p.memoizedProps:Xi(a.type,p.memoizedProps);y.componentDidUpdate(A,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var N=a.updateQueue;N!==null&&nl(a,N,y);break;case 3:var z=a.updateQueue;if(z!==null){if(p=null,a.child!==null)switch(a.child.tag){case 5:p=a.child.stateNode;break;case 1:p=a.child.stateNode}nl(a,z,p)}break;case 5:var re=a.stateNode;if(p===null&&a.flags&4){p=re;var le=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":le.autoFocus&&p.focus();break;case"img":le.src&&(p.src=le.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Ne=a.alternate;if(Ne!==null){var Ke=Ne.memoizedState;if(Ke!==null){var Je=Ke.dehydrated;Je!==null&&Fl(Je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}fi||a.flags&512&&f0(a)}catch(Ye){ur(a,a.return,Ye)}}if(a===s){Mt=null;break}if(p=a.sibling,p!==null){p.return=a.return,Mt=p;break}Mt=a.return}}function Zy(s){for(;Mt!==null;){var a=Mt;if(a===s){Mt=null;break}var p=a.sibling;if(p!==null){p.return=a.return,Mt=p;break}Mt=a.return}}function Jy(s){for(;Mt!==null;){var a=Mt;try{switch(a.tag){case 0:case 11:case 15:var p=a.return;try{Np(4,a)}catch(le){ur(a,p,le)}break;case 1:var y=a.stateNode;if(typeof y.componentDidMount=="function"){var A=a.return;try{y.componentDidMount()}catch(le){ur(a,A,le)}}var N=a.return;try{f0(a)}catch(le){ur(a,N,le)}break;case 5:var z=a.return;try{f0(a)}catch(le){ur(a,z,le)}}}catch(le){ur(a,a.return,le)}if(a===s){Mt=null;break}var re=a.sibling;if(re!==null){re.return=a.return,Mt=re;break}Mt=a.return}}var wb=Math.ceil,Lp=L.ReactCurrentDispatcher,m0=L.ReactCurrentOwner,As=L.ReactCurrentBatchConfig,En=0,Gr=null,Tr=null,ii=0,fs=0,qu=er(0),kr=0,jf=null,mc=0,Ip=0,g0=0,Vf=null,Yi=null,v0=0,Ku=1/0,va=null,Dp=!1,x0=null,al=null,kp=!1,ll=null,Op=0,Gf=0,y0=null,Up=-1,Fp=0;function Pi(){return(En&6)!==0?tt():Up!==-1?Up:Up=tt()}function cl(s){return(s.mode&1)===0?1:(En&2)!==0&&ii!==0?ii&-ii:a0.transition!==null?(Fp===0&&(Fp=si()),Fp):(s=wn,s!==0||(s=window.event,s=s===void 0?16:rp(s.type)),s)}function eo(s,a,p,y){if(50<Gf)throw Gf=0,y0=null,Error(t(185));Dl(s,p,y),((En&2)===0||s!==Gr)&&(s===Gr&&((En&2)===0&&(Ip|=p),kr===4&&ul(s,ii)),qi(s,y),p===1&&En===0&&(a.mode&1)===0&&(Ku=tt()+500,Ql&&Ms()))}function qi(s,a){var p=s.callbackNode;Cr(s,a);var y=Kr(s,s===Gr?ii:0);if(y===0)p!==null&&Ze(p),s.callbackNode=null,s.callbackPriority=0;else if(a=y&-y,s.callbackPriority!==a){if(p!=null&&Ze(p),a===1)s.tag===0?vp(Qy.bind(null,s)):ec(Qy.bind(null,s)),o0(function(){(En&6)===0&&Ms()}),p=null;else{switch(Oa(y)){case 1:p=Ft;break;case 4:p=jt;break;case 16:p=mt;break;case 536870912:p=Xe;break;default:p=mt}p=a_(p,$y.bind(null,s))}s.callbackPriority=a,s.callbackNode=p}}function $y(s,a){if(Up=-1,Fp=0,(En&6)!==0)throw Error(t(327));var p=s.callbackNode;if(Zu()&&s.callbackNode!==p)return null;var y=Kr(s,s===Gr?ii:0);if(y===0)return null;if((y&30)!==0||(y&s.expiredLanes)!==0||a)a=Bp(s,y);else{a=y;var A=En;En|=2;var N=t_();(Gr!==s||ii!==a)&&(va=null,Ku=tt()+500,vc(s,a));do try{bb();break}catch(re){e_(s,re)}while(!0);ca(),Lp.current=N,En=A,Tr!==null?a=0:(Gr=null,ii=0,a=kr)}if(a!==0){if(a===2&&(A=mo(s),A!==0&&(y=A,a=_0(s,A))),a===1)throw p=jf,vc(s,0),ul(s,y),qi(s,tt()),p;if(a===6)ul(s,y);else{if(A=s.current.alternate,(y&30)===0&&!Mb(A)&&(a=Bp(s,y),a===2&&(N=mo(s),N!==0&&(y=N,a=_0(s,N))),a===1))throw p=jf,vc(s,0),ul(s,y),qi(s,tt()),p;switch(s.finishedWork=A,s.finishedLanes=y,a){case 0:case 1:throw Error(t(345));case 2:xc(s,Yi,va);break;case 3:if(ul(s,y),(y&130023424)===y&&(a=v0+500-tt(),10<a)){if(Kr(s,0)!==0)break;if(A=s.suspendedLanes,(A&y)!==y){Pi(),s.pingedLanes|=s.suspendedLanes&A;break}s.timeoutHandle=vf(xc.bind(null,s,Yi,va),a);break}xc(s,Yi,va);break;case 4:if(ul(s,y),(y&4194240)===y)break;for(a=s.eventTimes,A=-1;0<y;){var z=31-Yt(y);N=1<<z,z=a[z],z>A&&(A=z),y&=~N}if(y=A,y=tt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*wb(y/1960))-y,10<y){s.timeoutHandle=vf(xc.bind(null,s,Yi,va),y);break}xc(s,Yi,va);break;case 5:xc(s,Yi,va);break;default:throw Error(t(329))}}}return qi(s,tt()),s.callbackNode===p?$y.bind(null,s):null}function _0(s,a){var p=Vf;return s.current.memoizedState.isDehydrated&&(vc(s,a).flags|=256),s=Bp(s,a),s!==2&&(a=Yi,Yi=p,a!==null&&S0(a)),s}function S0(s){Yi===null?Yi=s:Yi.push.apply(Yi,s)}function Mb(s){for(var a=s;;){if(a.flags&16384){var p=a.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var A=p[y],N=A.getSnapshot;A=A.value;try{if(!wi(N(),A))return!1}catch{return!1}}}if(p=a.child,a.subtreeFlags&16384&&p!==null)p.return=a,a=p;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ul(s,a){for(a&=~g0,a&=~Ip,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var p=31-Yt(a),y=1<<p;s[p]=-1,a&=~y}}function Qy(s){if((En&6)!==0)throw Error(t(327));Zu();var a=Kr(s,0);if((a&1)===0)return qi(s,tt()),null;var p=Bp(s,a);if(s.tag!==0&&p===2){var y=mo(s);y!==0&&(a=y,p=_0(s,y))}if(p===1)throw p=jf,vc(s,0),ul(s,a),qi(s,tt()),p;if(p===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,xc(s,Yi,va),qi(s,tt()),null}function w0(s,a){var p=En;En|=1;try{return s(a)}finally{En=p,En===0&&(Ku=tt()+500,Ql&&Ms())}}function gc(s){ll!==null&&ll.tag===0&&(En&6)===0&&Zu();var a=En;En|=1;var p=As.transition,y=wn;try{if(As.transition=null,wn=1,s)return s()}finally{wn=y,As.transition=p,En=a,(En&6)===0&&Ms()}}function M0(){fs=qu.current,Bn(qu)}function vc(s,a){s.finishedWork=null,s.finishedLanes=0;var p=s.timeoutHandle;if(p!==-1&&(s.timeoutHandle=-1,xf(p)),Tr!==null)for(p=Tr.return;p!==null;){var y=p;switch(Gs(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Jl();break;case 3:To(),Bn(Qr),Bn(Pr),bs();break;case 5:rl(y);break;case 4:To();break;case 13:Bn(jn);break;case 19:Bn(jn);break;case 10:ic(y.type._context);break;case 22:case 23:M0()}p=p.return}if(Gr=s,Tr=s=dl(s.current,null),ii=fs=a,kr=0,jf=null,g0=Ip=mc=0,Yi=Vf=null,Xs!==null){for(a=0;a<Xs.length;a++)if(p=Xs[a],y=p.interleaved,y!==null){p.interleaved=null;var A=y.next,N=p.pending;if(N!==null){var z=N.next;N.next=A,y.next=z}p.pending=y}Xs=null}return s}function e_(s,a){do{var p=Tr;try{if(ca(),ha.current=Wu,us){for(var y=zn.memoizedState;y!==null;){var A=y.queue;A!==null&&(A.pending=null),y=y.next}us=!1}if(qs=0,Mn=nr=zn=null,Vr=!1,Ao=0,m0.current=null,p===null||p.return===null){kr=1,jf=a,Tr=null;break}e:{var N=s,z=p.return,re=p,le=a;if(a=ii,re.flags|=32768,le!==null&&typeof le=="object"&&typeof le.then=="function"){var Ne=le,Ke=re,Je=Ke.tag;if((Ke.mode&1)===0&&(Je===0||Je===11||Je===15)){var Ye=Ke.alternate;Ye?(Ke.updateQueue=Ye.updateQueue,Ke.memoizedState=Ye.memoizedState,Ke.lanes=Ye.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var St=wt(z);if(St!==null){St.flags&=-257,Qt(St,z,re,N,a),St.mode&1&&Qe(N,Ne,a),a=St,le=Ne;var Tt=a.updateQueue;if(Tt===null){var At=new Set;At.add(le),a.updateQueue=At}else Tt.add(le);break e}else{if((a&1)===0){Qe(N,Ne,a),E0();break e}le=Error(t(426))}}else if(Hn&&re.mode&1){var gr=wt(z);if(gr!==null){(gr.flags&65536)===0&&(gr.flags|=256),Qt(gr,z,re,N,a),el(b(le,re));break e}}N=le=b(le,re),kr!==4&&(kr=2),Vf===null?Vf=[N]:Vf.push(N),N=z;do{switch(N.tag){case 3:N.flags|=65536,a&=-a,N.lanes|=a;var Me=me(N,le,a);ua(N,Me);break e;case 1:re=le;var pe=N.type,Ae=N.stateNode;if((N.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||Ae!==null&&typeof Ae.componentDidCatch=="function"&&(al===null||!al.has(Ae)))){N.flags|=65536,a&=-a,N.lanes|=a;var nt=ze(N,re,a);ua(N,nt);break e}}N=N.return}while(N!==null)}r_(p)}catch(Lt){a=Lt,Tr===p&&p!==null&&(Tr=p=p.return);continue}break}while(!0)}function t_(){var s=Lp.current;return Lp.current=Wu,s===null?Wu:s}function E0(){(kr===0||kr===3||kr===2)&&(kr=4),Gr===null||(mc&268435455)===0&&(Ip&268435455)===0||ul(Gr,ii)}function Bp(s,a){var p=En;En|=2;var y=t_();(Gr!==s||ii!==a)&&(va=null,vc(s,a));do try{Eb();break}catch(A){e_(s,A)}while(!0);if(ca(),En=p,Lp.current=y,Tr!==null)throw Error(t(261));return Gr=null,ii=0,kr}function Eb(){for(;Tr!==null;)n_(Tr)}function bb(){for(;Tr!==null&&!vt();)n_(Tr)}function n_(s){var a=o_(s.alternate,s,fs);s.memoizedProps=s.pendingProps,a===null?r_(s):Tr=a,m0.current=null}function r_(s){var a=s;do{var p=a.alternate;if(s=a.return,(a.flags&32768)===0){if(p=vb(p,a,fs),p!==null){Tr=p;return}}else{if(p=xb(p,a),p!==null){p.flags&=32767,Tr=p;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{kr=6,Tr=null;return}}if(a=a.sibling,a!==null){Tr=a;return}Tr=a=s}while(a!==null);kr===0&&(kr=5)}function xc(s,a,p){var y=wn,A=As.transition;try{As.transition=null,wn=1,Tb(s,a,p,y)}finally{As.transition=A,wn=y}return null}function Tb(s,a,p,y){do Zu();while(ll!==null);if((En&6)!==0)throw Error(t(327));p=s.finishedWork;var A=s.finishedLanes;if(p===null)return null;if(s.finishedWork=null,s.finishedLanes=0,p===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var N=p.lanes|p.childLanes;if(n0(s,N),s===Gr&&(Tr=Gr=null,ii=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||kp||(kp=!0,a_(mt,function(){return Zu(),null})),N=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||N){N=As.transition,As.transition=null;var z=wn;wn=1;var re=En;En|=4,m0.current=null,_b(s,p),Yy(p,s),wr(mf),Fi=!!Ja,mf=Ja=null,s.current=p,Sb(p),ut(),En=re,wn=z,As.transition=N}else s.current=p;if(kp&&(kp=!1,ll=s,Op=A),N=s.pendingLanes,N===0&&(al=null),ct(p.stateNode),qi(s,tt()),a!==null)for(y=s.onRecoverableError,p=0;p<a.length;p++)A=a[p],y(A.value,{componentStack:A.stack,digest:A.digest});if(Dp)throw Dp=!1,s=x0,x0=null,s;return(Op&1)!==0&&s.tag!==0&&Zu(),N=s.pendingLanes,(N&1)!==0?s===y0?Gf++:(Gf=0,y0=s):Gf=0,Ms(),null}function Zu(){if(ll!==null){var s=Oa(Op),a=As.transition,p=wn;try{if(As.transition=null,wn=16>s?16:s,ll===null)var y=!1;else{if(s=ll,ll=null,Op=0,(En&6)!==0)throw Error(t(331));var A=En;for(En|=4,Mt=s.current;Mt!==null;){var N=Mt,z=N.child;if((Mt.flags&16)!==0){var re=N.deletions;if(re!==null){for(var le=0;le<re.length;le++){var Ne=re[le];for(Mt=Ne;Mt!==null;){var Ke=Mt;switch(Ke.tag){case 0:case 11:case 15:Hf(8,Ke,N)}var Je=Ke.child;if(Je!==null)Je.return=Ke,Mt=Je;else for(;Mt!==null;){Ke=Mt;var Ye=Ke.sibling,St=Ke.return;if(jy(Ke),Ke===Ne){Mt=null;break}if(Ye!==null){Ye.return=St,Mt=Ye;break}Mt=St}}}var Tt=N.alternate;if(Tt!==null){var At=Tt.child;if(At!==null){Tt.child=null;do{var gr=At.sibling;At.sibling=null,At=gr}while(At!==null)}}Mt=N}}if((N.subtreeFlags&2064)!==0&&z!==null)z.return=N,Mt=z;else e:for(;Mt!==null;){if(N=Mt,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:Hf(9,N,N.return)}var Me=N.sibling;if(Me!==null){Me.return=N.return,Mt=Me;break e}Mt=N.return}}var pe=s.current;for(Mt=pe;Mt!==null;){z=Mt;var Ae=z.child;if((z.subtreeFlags&2064)!==0&&Ae!==null)Ae.return=z,Mt=Ae;else e:for(z=pe;Mt!==null;){if(re=Mt,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:Np(9,re)}}catch(Lt){ur(re,re.return,Lt)}if(re===z){Mt=null;break e}var nt=re.sibling;if(nt!==null){nt.return=re.return,Mt=nt;break e}Mt=re.return}}if(En=A,Ms(),ft&&typeof ft.onPostCommitFiberRoot=="function")try{ft.onPostCommitFiberRoot($t,s)}catch{}y=!0}return y}finally{wn=p,As.transition=a}}return!1}function i_(s,a,p){a=b(p,a),a=me(s,a,1),s=Gn(s,a,1),a=Pi(),s!==null&&(Dl(s,1,a),qi(s,a))}function ur(s,a,p){if(s.tag===3)i_(s,s,p);else for(;a!==null;){if(a.tag===3){i_(a,s,p);break}else if(a.tag===1){var y=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(al===null||!al.has(y))){s=b(p,s),s=ze(a,s,1),a=Gn(a,s,1),s=Pi(),a!==null&&(Dl(a,1,s),qi(a,s));break}}a=a.return}}function Ab(s,a,p){var y=s.pingCache;y!==null&&y.delete(a),a=Pi(),s.pingedLanes|=s.suspendedLanes&p,Gr===s&&(ii&p)===p&&(kr===4||kr===3&&(ii&130023424)===ii&&500>tt()-v0?vc(s,0):g0|=p),qi(s,a)}function s_(s,a){a===0&&((s.mode&1)===0?a=1:(a=In,In<<=1,(In&130023424)===0&&(In=4194304)));var p=Pi();s=ls(s,a),s!==null&&(Dl(s,a,p),qi(s,p))}function Cb(s){var a=s.memoizedState,p=0;a!==null&&(p=a.retryLane),s_(s,p)}function Rb(s,a){var p=0;switch(s.tag){case 13:var y=s.stateNode,A=s.memoizedState;A!==null&&(p=A.retryLane);break;case 19:y=s.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(a),s_(s,p)}var o_;o_=function(s,a,p){if(s!==null)if(s.memoizedProps!==a.pendingProps||Qr.current)sn=!0;else{if((s.lanes&p)===0&&(a.flags&128)===0)return sn=!1,gb(s,a,p);sn=(s.flags&131072)!==0}else sn=!1,Hn&&(a.flags&1048576)!==0&&Mf(a,ku,a.index);switch(a.lanes=0,a.tag){case 2:var y=a.type;Rp(s,a),s=a.pendingProps;var A=na(a,Pr.current);bo(a,p),A=cc(null,a,y,s,A,p);var N=Nf();return a.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Hr(y)?(N=!0,ra(a)):N=!1,a.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,rn(a),A.updater=Xu,a.stateNode=A,A._reactInternals=a,x(a,y,s,p),a=nn(null,a,y,!0,N,p)):(a.tag=0,Hn&&N&&Ef(a),xt(null,a,A,p),a=a.child),a;case 16:y=a.elementType;e:{switch(Rp(s,a),s=a.pendingProps,A=y._init,y=A(y._payload),a.type=y,A=a.tag=Nb(y),s=Xi(y,s),A){case 0:a=pt(null,a,y,s,p);break e;case 1:a=Pt(null,a,y,s,p);break e;case 11:a=Dr(null,a,y,s,p);break e;case 14:a=Ri(null,a,y,Xi(y.type,s),p);break e}throw Error(t(306,y,""))}return a;case 0:return y=a.type,A=a.pendingProps,A=a.elementType===y?A:Xi(y,A),pt(s,a,y,A,p);case 1:return y=a.type,A=a.pendingProps,A=a.elementType===y?A:Xi(y,A),Pt(s,a,y,A,p);case 3:e:{if(en(a),s===null)throw Error(t(387));y=a.pendingProps,N=a.memoizedState,A=N.element,or(s,a),tr(a,y,null,p);var z=a.memoizedState;if(y=z.element,N.isDehydrated)if(N={element:y,isDehydrated:!1,cache:z.cache,pendingSuspenseBoundaries:z.pendingSuspenseBoundaries,transitions:z.transitions},a.updateQueue.baseState=N,a.memoizedState=N,a.flags&256){A=b(Error(t(423)),a),a=Sn(s,a,y,p,A);break e}else if(y!==A){A=b(Error(t(424)),a),a=Sn(s,a,y,p,A);break e}else for(ti=Bs(a.stateNode.containerInfo.firstChild),Nr=a,Hn=!0,Wi=null,p=rc(a,null,y,p),a.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Eo(),y===A){a=ga(s,a,p);break e}xt(s,a,y,p)}a=a.child}return a;case 5:return fa(a),s===null&&Uu(a),y=a.type,A=a.pendingProps,N=s!==null?s.memoizedProps:null,z=A.children,gf(y,A)?z=null:N!==null&&gf(y,N)&&(a.flags|=32),Ie(s,a),xt(s,a,z,p),a.child;case 6:return s===null&&Uu(a),null;case 13:return Js(s,a,p);case 4:return ac(a,a.stateNode.containerInfo),y=a.pendingProps,s===null?a.child=oa(a,null,y,p):xt(s,a,y,p),a.child;case 11:return y=a.type,A=a.pendingProps,A=a.elementType===y?A:Xi(y,A),Dr(s,a,y,A,p);case 7:return xt(s,a,a.pendingProps,p),a.child;case 8:return xt(s,a,a.pendingProps.children,p),a.child;case 12:return xt(s,a,a.pendingProps.children,p),a.child;case 10:e:{if(y=a.type._context,A=a.pendingProps,N=a.memoizedProps,z=A.value,Dn(aa,y._currentValue),y._currentValue=z,N!==null)if(wi(N.value,z)){if(N.children===A.children&&!Qr.current){a=ga(s,a,p);break e}}else for(N=a.child,N!==null&&(N.return=a);N!==null;){var re=N.dependencies;if(re!==null){z=N.child;for(var le=re.firstContext;le!==null;){if(le.context===y){if(N.tag===1){le=Nn(-1,p&-p),le.tag=2;var Ne=N.updateQueue;if(Ne!==null){Ne=Ne.shared;var Ke=Ne.pending;Ke===null?le.next=le:(le.next=Ke.next,Ke.next=le),Ne.pending=le}}N.lanes|=p,le=N.alternate,le!==null&&(le.lanes|=p),sc(N.return,p,a),re.lanes|=p;break}le=le.next}}else if(N.tag===10)z=N.type===a.type?null:N.child;else if(N.tag===18){if(z=N.return,z===null)throw Error(t(341));z.lanes|=p,re=z.alternate,re!==null&&(re.lanes|=p),sc(z,p,a),z=N.sibling}else z=N.child;if(z!==null)z.return=N;else for(z=N;z!==null;){if(z===a){z=null;break}if(N=z.sibling,N!==null){N.return=z.return,z=N;break}z=z.return}N=z}xt(s,a,A.children,p),a=a.child}return a;case 9:return A=a.type,y=a.pendingProps.children,bo(a,p),A=bi(A),y=y(A),a.flags|=1,xt(s,a,y,p),a.child;case 14:return y=a.type,A=Xi(y,a.pendingProps),A=Xi(y.type,A),Ri(s,a,y,A,p);case 15:return Ce(s,a,a.type,a.pendingProps,p);case 17:return y=a.type,A=a.pendingProps,A=a.elementType===y?A:Xi(y,A),Rp(s,a),a.tag=1,Hr(y)?(s=!0,ra(a)):s=!1,bo(a,p),c(a,y,A),x(a,y,A,p),nn(null,a,y,!0,s,p);case 19:return Uy(s,a,p);case 22:return xe(s,a,p)}throw Error(t(156,a.tag))};function a_(s,a){return _e(s,a)}function Pb(s,a,p,y){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cs(s,a,p,y){return new Pb(s,a,p,y)}function b0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Nb(s){if(typeof s=="function")return b0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===ne)return 11;if(s===ie)return 14}return 2}function dl(s,a){var p=s.alternate;return p===null?(p=Cs(s.tag,a,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=a,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&14680064,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,a=s.dependencies,p.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p}function zp(s,a,p,y,A,N){var z=2;if(y=s,typeof s=="function")b0(s)&&(z=1);else if(typeof s=="string")z=5;else e:switch(s){case k:return yc(p.children,A,N,a);case Z:z=8,A|=8;break;case D:return s=Cs(12,p,a,A|2),s.elementType=D,s.lanes=N,s;case ge:return s=Cs(13,p,a,A),s.elementType=ge,s.lanes=N,s;case $:return s=Cs(19,p,a,A),s.elementType=$,s.lanes=N,s;case fe:return Hp(p,A,N,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:z=10;break e;case W:z=9;break e;case ne:z=11;break e;case ie:z=14;break e;case oe:z=16,y=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return a=Cs(z,p,a,A),a.elementType=s,a.type=y,a.lanes=N,a}function yc(s,a,p,y){return s=Cs(7,s,y,a),s.lanes=p,s}function Hp(s,a,p,y){return s=Cs(22,s,y,a),s.elementType=fe,s.lanes=p,s.stateNode={isHidden:!1},s}function T0(s,a,p){return s=Cs(6,s,null,a),s.lanes=p,s}function A0(s,a,p){return a=Cs(4,s.children!==null?s.children:[],s.key,a),a.lanes=p,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function Lb(s,a,p,y,A){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Da(0),this.expirationTimes=Da(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Da(0),this.identifierPrefix=y,this.onRecoverableError=A,this.mutableSourceEagerHydrationData=null}function C0(s,a,p,y,A,N,z,re,le){return s=new Lb(s,a,p,re,le),a===1?(a=1,N===!0&&(a|=8)):a=0,N=Cs(3,null,null,a),s.current=N,N.stateNode=s,N.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},rn(N),s}function Ib(s,a,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:y==null?null:""+y,children:s,containerInfo:a,implementation:p}}function l_(s){if(!s)return Hs;s=s._reactInternals;e:{if(ue(s)!==s||s.tag!==1)throw Error(t(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Hr(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(s.tag===1){var p=s.type;if(Hr(p))return $l(s,p,a)}return a}function c_(s,a,p,y,A,N,z,re,le){return s=C0(p,y,!0,s,A,N,z,re,le),s.context=l_(null),p=s.current,y=Pi(),A=cl(p),N=Nn(y,A),N.callback=a??null,Gn(p,N,A),s.current.lanes=A,Dl(s,A,y),qi(s,y),s}function jp(s,a,p,y){var A=a.current,N=Pi(),z=cl(A);return p=l_(p),a.context===null?a.context=p:a.pendingContext=p,a=Nn(N,z),a.payload={element:s},y=y===void 0?null:y,y!==null&&(a.callback=y),s=Gn(A,a,z),s!==null&&(eo(s,A,z,N),jr(s,A,z)),z}function Vp(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function u_(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<a?p:a}}function R0(s,a){u_(s,a),(s=s.alternate)&&u_(s,a)}function Db(){return null}var d_=typeof reportError=="function"?reportError:function(s){console.error(s)};function P0(s){this._internalRoot=s}Gp.prototype.render=P0.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(t(409));jp(s,a,null,null)},Gp.prototype.unmount=P0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;gc(function(){jp(null,s,null,null)}),a[Ei]=null}};function Gp(s){this._internalRoot=s}Gp.prototype.unstable_scheduleHydration=function(s){if(s){var a=eu();s={blockedOn:null,target:s,priority:a};for(var p=0;p<go.length&&a!==0&&a<go[p].priority;p++);go.splice(p,0,s),p===0&&ru(s)}};function N0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Wp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function f_(){}function kb(s,a,p,y,A){if(A){if(typeof y=="function"){var N=y;y=function(){var Ne=Vp(z);N.call(Ne)}}var z=c_(a,y,s,0,null,!1,!1,"",f_);return s._reactRootContainer=z,s[Ei]=z.current,Ka(s.nodeType===8?s.parentNode:s),gc(),z}for(;A=s.lastChild;)s.removeChild(A);if(typeof y=="function"){var re=y;y=function(){var Ne=Vp(le);re.call(Ne)}}var le=C0(s,0,!1,null,null,!1,!1,"",f_);return s._reactRootContainer=le,s[Ei]=le.current,Ka(s.nodeType===8?s.parentNode:s),gc(function(){jp(a,le,p,y)}),le}function Xp(s,a,p,y,A){var N=p._reactRootContainer;if(N){var z=N;if(typeof A=="function"){var re=A;A=function(){var le=Vp(z);re.call(le)}}jp(a,z,s,A)}else z=kb(p,a,s,A,y);return Vp(z)}kl=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var p=Tn(a.pendingLanes);p!==0&&(ka(a,p|1),qi(a,tt()),(En&6)===0&&(Ku=tt()+500,Ms()))}break;case 13:gc(function(){var y=ls(s,1);if(y!==null){var A=Pi();eo(y,s,1,A)}}),R0(s,1)}},Jd=function(s){if(s.tag===13){var a=ls(s,134217728);if(a!==null){var p=Pi();eo(a,s,134217728,p)}R0(s,134217728)}},np=function(s){if(s.tag===13){var a=cl(s),p=ls(s,a);if(p!==null){var y=Pi();eo(p,s,a,y)}R0(s,a)}},eu=function(){return wn},tu=function(s,a){var p=wn;try{return wn=s,a()}finally{wn=p}},et=function(s,a,p){switch(a){case"input":if(be(s,p),a=p.name,p.type==="radio"&&a!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<p.length;a++){var y=p[a];if(y!==s&&y.form===s.form){var A=Lu(y);if(!A)throw Error(t(90));Q(y),be(y,A)}}}break;case"textarea":Te(s,p);break;case"select":a=p.value,a!=null&&ce(s,!!p.multiple,a,!1)}},hn=w0,pn=gc;var Ob={usingClientEntryPoint:!1,Events:[zs,sr,Lu,Dt,Rt,w0]},Wf={findFiberByHostInstance:Mo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ub={bundleType:Wf.bundleType,version:Wf.version,rendererPackageName:Wf.rendererPackageName,rendererConfig:Wf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ve(s),s===null?null:s.stateNode},findFiberByHostInstance:Wf.findFiberByHostInstance||Db,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yp.isDisabled&&Yp.supportsFiber)try{$t=Yp.inject(Ub),ft=Yp}catch{}}return Ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ob,Ki.createPortal=function(s,a){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N0(a))throw Error(t(200));return Ib(s,a,null,p)},Ki.createRoot=function(s,a){if(!N0(s))throw Error(t(299));var p=!1,y="",A=d_;return a!=null&&(a.unstable_strictMode===!0&&(p=!0),a.identifierPrefix!==void 0&&(y=a.identifierPrefix),a.onRecoverableError!==void 0&&(A=a.onRecoverableError)),a=C0(s,1,!1,null,null,p,!1,y,A),s[Ei]=a.current,Ka(s.nodeType===8?s.parentNode:s),new P0(a)},Ki.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=ve(a),s=s===null?null:s.stateNode,s},Ki.flushSync=function(s){return gc(s)},Ki.hydrate=function(s,a,p){if(!Wp(a))throw Error(t(200));return Xp(null,s,a,!0,p)},Ki.hydrateRoot=function(s,a,p){if(!N0(s))throw Error(t(405));var y=p!=null&&p.hydratedSources||null,A=!1,N="",z=d_;if(p!=null&&(p.unstable_strictMode===!0&&(A=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onRecoverableError!==void 0&&(z=p.onRecoverableError)),a=c_(a,null,s,1,p??null,A,!1,N,z),s[Ei]=a.current,Ka(s),y)for(s=0;s<y.length;s++)p=y[s],A=p._getVersion,A=A(p._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[p,A]:a.mutableSourceEagerHydrationData.push(p,A);return new Gp(a)},Ki.render=function(s,a,p){if(!Wp(a))throw Error(t(200));return Xp(null,s,a,!1,p)},Ki.unmountComponentAtNode=function(s){if(!Wp(s))throw Error(t(40));return s._reactRootContainer?(gc(function(){Xp(null,null,s,!1,function(){s._reactRootContainer=null,s[Ei]=null})}),!0):!1},Ki.unstable_batchedUpdates=w0,Ki.unstable_renderSubtreeIntoContainer=function(s,a,p,y){if(!Wp(p))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Xp(s,a,p,!1,y)},Ki.version="18.3.1-next-f1338f8080-20240426",Ki}var __;function JS(){if(__)return D0.exports;__=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),D0.exports=Gb(),D0.exports}var S_;function Wb(){if(S_)return qp;S_=1;var i=JS();return qp.createRoot=i.createRoot,qp.hydrateRoot=i.hydrateRoot,qp}var Xb=Wb(),dh=JS();function $S(i,e){return function(){return i.apply(e,arguments)}}const{toString:Yb}=Object.prototype,{getPrototypeOf:Hx}=Object,{iterator:wg,toStringTag:QS}=Symbol,Mg=(i=>e=>{const t=Yb.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),uo=i=>(i=i.toLowerCase(),e=>Mg(e)===i),Eg=i=>e=>typeof e===i,{isArray:Gd}=Array,Ud=Eg("undefined");function Bh(i){return i!==null&&!Ud(i)&&i.constructor!==null&&!Ud(i.constructor)&&es(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const ew=uo("ArrayBuffer");function qb(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&ew(i.buffer),e}const Kb=Eg("string"),es=Eg("function"),tw=Eg("number"),zh=i=>i!==null&&typeof i=="object",Zb=i=>i===!0||i===!1,eg=i=>{if(Mg(i)!=="object")return!1;const e=Hx(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(QS in i)&&!(wg in i)},Jb=i=>{if(!zh(i)||Bh(i))return!1;try{return Object.keys(i).length===0&&Object.getPrototypeOf(i)===Object.prototype}catch{return!1}},$b=uo("Date"),Qb=uo("File"),eT=uo("Blob"),tT=uo("FileList"),nT=i=>zh(i)&&es(i.pipe),rT=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||es(i.append)&&((e=Mg(i))==="formdata"||e==="object"&&es(i.toString)&&i.toString()==="[object FormData]"))},iT=uo("URLSearchParams"),[sT,oT,aT,lT]=["ReadableStream","Request","Response","Headers"].map(uo),cT=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Hh(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let n,r;if(typeof i!="object"&&(i=[i]),Gd(i))for(n=0,r=i.length;n<r;n++)e.call(null,i[n],n,i);else{if(Bh(i))return;const o=t?Object.getOwnPropertyNames(i):Object.keys(i),l=o.length;let u;for(n=0;n<l;n++)u=o[n],e.call(null,i[u],u,i)}}function nw(i,e){if(Bh(i))return null;e=e.toLowerCase();const t=Object.keys(i);let n=t.length,r;for(;n-- >0;)if(r=t[n],e===r.toLowerCase())return r;return null}const Dc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rw=i=>!Ud(i)&&i!==Dc;function Vv(){const{caseless:i,skipUndefined:e}=rw(this)&&this||{},t={},n=(r,o)=>{const l=i&&nw(t,o)||o;eg(t[l])&&eg(r)?t[l]=Vv(t[l],r):eg(r)?t[l]=Vv({},r):Gd(r)?t[l]=r.slice():(!e||!Ud(r))&&(t[l]=r)};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Hh(arguments[r],n);return t}const uT=(i,e,t,{allOwnKeys:n}={})=>(Hh(e,(r,o)=>{t&&es(r)?Object.defineProperty(i,o,{value:$S(r,t),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(i,o,{value:r,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),i),dT=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),fT=(i,e,t,n)=>{i.prototype=Object.create(e.prototype,n),Object.defineProperty(i.prototype,"constructor",{value:i,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},hT=(i,e,t,n)=>{let r,o,l;const u={};if(e=e||{},i==null)return e;do{for(r=Object.getOwnPropertyNames(i),o=r.length;o-- >0;)l=r[o],(!n||n(l,i,e))&&!u[l]&&(e[l]=i[l],u[l]=!0);i=t!==!1&&Hx(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},pT=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;const n=i.indexOf(e,t);return n!==-1&&n===t},mT=i=>{if(!i)return null;if(Gd(i))return i;let e=i.length;if(!tw(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},gT=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&Hx(Uint8Array)),vT=(i,e)=>{const n=(i&&i[wg]).call(i);let r;for(;(r=n.next())&&!r.done;){const o=r.value;e.call(i,o[0],o[1])}},xT=(i,e)=>{let t;const n=[];for(;(t=i.exec(e))!==null;)n.push(t);return n},yT=uo("HTMLFormElement"),_T=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,r){return n.toUpperCase()+r}),w_=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),ST=uo("RegExp"),iw=(i,e)=>{const t=Object.getOwnPropertyDescriptors(i),n={};Hh(t,(r,o)=>{let l;(l=e(r,o,i))!==!1&&(n[o]=l||r)}),Object.defineProperties(i,n)},wT=i=>{iw(i,(e,t)=>{if(es(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=i[t];if(es(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},MT=(i,e)=>{const t={},n=r=>{r.forEach(o=>{t[o]=!0})};return Gd(i)?n(i):n(String(i).split(e)),t},ET=()=>{},bT=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e;function TT(i){return!!(i&&es(i.append)&&i[QS]==="FormData"&&i[wg])}const AT=i=>{const e=new Array(10),t=(n,r)=>{if(zh(n)){if(e.indexOf(n)>=0)return;if(Bh(n))return n;if(!("toJSON"in n)){e[r]=n;const o=Gd(n)?[]:{};return Hh(n,(l,u)=>{const f=t(l,r+1);!Ud(f)&&(o[u]=f)}),e[r]=void 0,o}}return n};return t(i,0)},CT=uo("AsyncFunction"),RT=i=>i&&(zh(i)||es(i))&&es(i.then)&&es(i.catch),sw=((i,e)=>i?setImmediate:e?((t,n)=>(Dc.addEventListener("message",({source:r,data:o})=>{r===Dc&&o===t&&n.length&&n.shift()()},!1),r=>{n.push(r),Dc.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",es(Dc.postMessage)),PT=typeof queueMicrotask<"u"?queueMicrotask.bind(Dc):typeof process<"u"&&process.nextTick||sw,NT=i=>i!=null&&es(i[wg]),Le={isArray:Gd,isArrayBuffer:ew,isBuffer:Bh,isFormData:rT,isArrayBufferView:qb,isString:Kb,isNumber:tw,isBoolean:Zb,isObject:zh,isPlainObject:eg,isEmptyObject:Jb,isReadableStream:sT,isRequest:oT,isResponse:aT,isHeaders:lT,isUndefined:Ud,isDate:$b,isFile:Qb,isBlob:eT,isRegExp:ST,isFunction:es,isStream:nT,isURLSearchParams:iT,isTypedArray:gT,isFileList:tT,forEach:Hh,merge:Vv,extend:uT,trim:cT,stripBOM:dT,inherits:fT,toFlatObject:hT,kindOf:Mg,kindOfTest:uo,endsWith:pT,toArray:mT,forEachEntry:vT,matchAll:xT,isHTMLForm:yT,hasOwnProperty:w_,hasOwnProp:w_,reduceDescriptors:iw,freezeMethods:wT,toObjectSet:MT,toCamelCase:_T,noop:ET,toFiniteNumber:bT,findKey:nw,global:Dc,isContextDefined:rw,isSpecCompliantForm:TT,toJSONObject:AT,isAsyncFn:CT,isThenable:RT,setImmediate:sw,asap:PT,isIterable:NT};let Zt=class ow extends Error{static from(e,t,n,r,o,l){const u=new ow(e.message,t||e.code,n,r,o);return u.cause=e,u.name=e.name,l&&Object.assign(u,l),u}constructor(e,t,n,r,o){super(e),this.name="AxiosError",this.isAxiosError=!0,t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Le.toJSONObject(this.config),code:this.code,status:this.status}}};Zt.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";Zt.ERR_BAD_OPTION="ERR_BAD_OPTION";Zt.ECONNABORTED="ECONNABORTED";Zt.ETIMEDOUT="ETIMEDOUT";Zt.ERR_NETWORK="ERR_NETWORK";Zt.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";Zt.ERR_DEPRECATED="ERR_DEPRECATED";Zt.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";Zt.ERR_BAD_REQUEST="ERR_BAD_REQUEST";Zt.ERR_CANCELED="ERR_CANCELED";Zt.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";Zt.ERR_INVALID_URL="ERR_INVALID_URL";const LT=null;function Gv(i){return Le.isPlainObject(i)||Le.isArray(i)}function aw(i){return Le.endsWith(i,"[]")?i.slice(0,-2):i}function M_(i,e,t){return i?i.concat(e).map(function(r,o){return r=aw(r),!t&&o?"["+r+"]":r}).join(t?".":""):e}function IT(i){return Le.isArray(i)&&!i.some(Gv)}const DT=Le.toFlatObject(Le,{},null,function(e){return/^is[A-Z]/.test(e)});function bg(i,e,t){if(!Le.isObject(i))throw new TypeError("target must be an object");e=e||new FormData,t=Le.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,E){return!Le.isUndefined(E[T])});const n=t.metaTokens,r=t.visitor||m,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&Le.isSpecCompliantForm(e);if(!Le.isFunction(r))throw new TypeError("visitor must be a function");function h(_){if(_===null)return"";if(Le.isDate(_))return _.toISOString();if(Le.isBoolean(_))return _.toString();if(!f&&Le.isBlob(_))throw new Zt("Blob is not supported. Use a Buffer instead.");return Le.isArrayBuffer(_)||Le.isTypedArray(_)?f&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function m(_,T,E){let w=_;if(_&&!E&&typeof _=="object"){if(Le.endsWith(T,"{}"))T=n?T:T.slice(0,-2),_=JSON.stringify(_);else if(Le.isArray(_)&&IT(_)||(Le.isFileList(_)||Le.endsWith(T,"[]"))&&(w=Le.toArray(_)))return T=aw(T),w.forEach(function(R,L){!(Le.isUndefined(R)||R===null)&&e.append(l===!0?M_([T],L,o):l===null?T:T+"[]",h(R))}),!1}return Gv(_)?!0:(e.append(M_(E,T,o),h(_)),!1)}const g=[],v=Object.assign(DT,{defaultVisitor:m,convertValue:h,isVisitable:Gv});function S(_,T){if(!Le.isUndefined(_)){if(g.indexOf(_)!==-1)throw Error("Circular reference detected in "+T.join("."));g.push(_),Le.forEach(_,function(w,C){(!(Le.isUndefined(w)||w===null)&&r.call(e,w,Le.isString(C)?C.trim():C,T,v))===!0&&S(w,T?T.concat(C):[C])}),g.pop()}}if(!Le.isObject(i))throw new TypeError("data must be an object");return S(i),e}function E_(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function jx(i,e){this._pairs=[],i&&bg(i,this,e)}const lw=jx.prototype;lw.append=function(e,t){this._pairs.push([e,t])};lw.toString=function(e){const t=e?function(n){return e.call(this,n,E_)}:E_;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function kT(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cw(i,e,t){if(!e)return i;const n=t&&t.encode||kT,r=Le.isFunction(t)?{serialize:t}:t,o=r&&r.serialize;let l;if(o?l=o(e,r):l=Le.isURLSearchParams(e)?e.toString():new jx(e,r).toString(n),l){const u=i.indexOf("#");u!==-1&&(i=i.slice(0,u)),i+=(i.indexOf("?")===-1?"?":"&")+l}return i}class b_{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Le.forEach(this.handlers,function(n){n!==null&&e(n)})}}const uw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},OT=typeof URLSearchParams<"u"?URLSearchParams:jx,UT=typeof FormData<"u"?FormData:null,FT=typeof Blob<"u"?Blob:null,BT={isBrowser:!0,classes:{URLSearchParams:OT,FormData:UT,Blob:FT},protocols:["http","https","file","blob","url","data"]},Vx=typeof window<"u"&&typeof document<"u",Wv=typeof navigator=="object"&&navigator||void 0,zT=Vx&&(!Wv||["ReactNative","NativeScript","NS"].indexOf(Wv.product)<0),HT=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",jT=Vx&&window.location.href||"http://localhost",VT=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vx,hasStandardBrowserEnv:zT,hasStandardBrowserWebWorkerEnv:HT,navigator:Wv,origin:jT},Symbol.toStringTag,{value:"Module"})),vi={...VT,...BT};function GT(i,e){return bg(i,new vi.classes.URLSearchParams,{visitor:function(t,n,r,o){return vi.isNode&&Le.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function WT(i){return Le.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function XT(i){const e={},t=Object.keys(i);let n;const r=t.length;let o;for(n=0;n<r;n++)o=t[n],e[o]=i[o];return e}function dw(i){function e(t,n,r,o){let l=t[o++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),f=o>=t.length;return l=!l&&Le.isArray(r)?r.length:l,f?(Le.hasOwnProp(r,l)?r[l]=[r[l],n]:r[l]=n,!u):((!r[l]||!Le.isObject(r[l]))&&(r[l]=[]),e(t,n,r[l],o)&&Le.isArray(r[l])&&(r[l]=XT(r[l])),!u)}if(Le.isFormData(i)&&Le.isFunction(i.entries)){const t={};return Le.forEachEntry(i,(n,r)=>{e(WT(n),r,t,0)}),t}return null}function YT(i,e,t){if(Le.isString(i))try{return(e||JSON.parse)(i),Le.trim(i)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(i)}const jh={transitional:uw,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=Le.isObject(e);if(o&&Le.isHTMLForm(e)&&(e=new FormData(e)),Le.isFormData(e))return r?JSON.stringify(dw(e)):e;if(Le.isArrayBuffer(e)||Le.isBuffer(e)||Le.isStream(e)||Le.isFile(e)||Le.isBlob(e)||Le.isReadableStream(e))return e;if(Le.isArrayBufferView(e))return e.buffer;if(Le.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return GT(e,this.formSerializer).toString();if((u=Le.isFileList(e))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return bg(u?{"files[]":e}:e,f&&new f,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),YT(e)):e}],transformResponse:[function(e){const t=this.transitional||jh.transitional,n=t&&t.forcedJSONParsing,r=this.responseType==="json";if(Le.isResponse(e)||Le.isReadableStream(e))return e;if(e&&Le.isString(e)&&(n&&!this.responseType||r)){const l=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?Zt.from(u,Zt.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vi.classes.FormData,Blob:vi.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Le.forEach(["delete","get","head","post","put","patch"],i=>{jh.headers[i]={}});const qT=Le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),KT=i=>{const e={};let t,n,r;return i&&i.split(`
C:\puh\puh\manager\GestureOSManager\front\dist\assets\index-BOxduUqw.js:18:`,result:"c"}),M.jsxs("feMerge",{children:[M.jsx("feMergeNode",{in:"c"}),M.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),M.jsx("path",{d:"M9 50 C20 43, 34 40, 56 39",fill:"none",stroke:"url(#gaGrad)",strokeWidth:"3.3",strokeLinecap:"round",opacity:"0.75"}),M.jsx("g",{filter:"url(#gaGlow)",children:M.jsx("text",{x:"7",y:"44",fontSize:"38",fontFamily:"ui-sans-serif, system-ui, Inter, Arial",fontWeight:"900",letterSpacing:"-2",fill:"url(#gaGrad)",children:"GA"})}),M.jsx("rect",{x:"49.5",y:"10",width:"4.2",height:"4.2",rx:"1.1",fill:"#22d3ee",opacity:"0.98"}),M.jsx("rect",{x:"55.2",y:"14",width:"3.2",height:"3.2",rx:"1",fill:"#60a5fa",opacity:"0.9"}),M.jsx("rect",{x:"47.6",y:"16.2",width:"2.6",height:"2.6",rx:"0.9",fill:"#93c5fd",opacity:"0.78"})]})}function bA(){return M.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",className:"opacity-70",children:M.jsx("path",{d:"m6 9 6 6 6-6",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}function TA(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M4 4h7v7H4V4Z",stroke:"currentColor",strokeWidth:"1.6"}),M.jsx("path",{d:"M13 4h7v7h-7V4Z",stroke:"currentColor",strokeWidth:"1.6"}),M.jsx("path",{d:"M4 13h7v7H4v-7Z",stroke:"currentColor",strokeWidth:"1.6"}),M.jsx("path",{d:"M13 13h7v7h-7v-7Z",stroke:"currentColor",strokeWidth:"1.6"})]})}function AA(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M4 19V5m0 14h16",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),M.jsx("path",{d:"M8 15l3-3 2 2 5-6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]})}function CA(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:M.jsx("path",{d:"M13 2 3 14h8l-1 8 10-12h-8l1-8Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"})})}function RA(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M8 3h8a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.6"}),M.jsx("path",{d:"M11 18h2",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}function z_({active:i,children:e,onClick:t}){return M.jsx("button",{type:"button",onClick:t,className:ms("w-full rounded-lg px-3 py-2 text-xs font-semibold ring-1 transition",i?"bg-base-100/35 ring-base-300/70":"bg-base-100/15 ring-base-300/45 opacity-90 hover:opacity-100 hover:bg-base-100/25"),children:M.jsx("span",{className:"whitespace-nowrap",children:e})})}function H_({title:i,desc:e,checked:t,onToggle:n}){return M.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl ring-1 ring-base-300/45 bg-base-100/12 px-4 py-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:i}),M.jsx("div",{className:"text-[11px] opacity-70 truncate",children:e})]}),M.jsx("input",{type:"checkbox",className:"toggle toggle-sm",checked:!!t,onChange:n})]})}function $p({active:i,icon:e,title:t,sub:n,onClick:r}){return M.jsxs("button",{type:"button",onClick:r,className:ms("w-full text-left rounded-lg px-3 py-2 ring-1 transition","flex items-center gap-3",i?"bg-base-100/30 ring-base-300/70":"bg-base-100/10 ring-base-300/45 hover:bg-base-100/20"),children:[M.jsx("div",{className:ms("h-9 w-9 rounded-lg ring-1 grid place-items-center shrink-0",i?"bg-primary/10 ring-primary/25":"bg-base-100/10 ring-base-300/45"),children:e}),M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:t}),n?M.jsx("div",{className:"text-[11px] opacity-70 truncate",children:n}):null]}),i?M.jsx("span",{className:"ml-auto text-[11px] font-semibold opacity-70 whitespace-nowrap",children:"현재"}):M.jsx("span",{className:"ml-auto opacity-40",children:"›"})]})}function PA({hudOn:i,onToggleHud:e,osHudOn:t,onToggleOsHud:n,screen:r,onChangeScreen:o,theme:l,setTheme:u,onOpenPairing:f,agentStatus:h}){const m=()=>window.managerWin&&window.managerWin.minimize&&window.managerWin.minimize(),g=()=>window.managerWin&&window.managerWin.toggleMaximize&&window.managerWin.toggleMaximize(),v=()=>window.managerWin&&window.managerWin.close&&window.managerWin.close(),S=X.useMemo(()=>[{id:"dark",label:"다크"},{id:"light",label:"라이트"},{id:"neon",label:"네온"},{id:"rose",label:"로즈"},{id:"devil",label:"데빌"}],[]),_=X.useMemo(()=>({MOUSE:"마우스",PRESENTATION:"프레젠테이션",DRAW:"그리기",RUSH:"러쉬",VKEY:"가상키보드",KEYBOARD:"키보드",DEFAULT:"기본"}),[]),T=X.useMemo(()=>({dashboard:"Dashboard",train:"Training",rush:"Rush",settings:"Settings"}),[]),E=(S.find(Q=>Q.id===l)||{}).label||l||"dark",w=!!(h&&h.connected),C=!!(h&&h.locked),R=h?h.cameraPresent:void 0,L=h&&h.modeText||_[h&&h.mode||"DEFAULT"]||h&&h.mode||"-",[G,U]=X.useState(!1),k=X.useRef(null),Z=X.useRef(null),[D,H]=X.useState({top:48,left:0,width:220}),[W,ne]=X.useState(!1),[ge,$]=X.useState("motion"),ie=X.useRef(null),oe=X.useRef(null),[fe,q]=X.useState({top:48,left:0,width:860}),[K,V]=X.useState(!1),B=X.useRef(null),Y=X.useRef(null),[ee,he]=X.useState({top:48,left:0,width:320}),Re=()=>{const Q=k.current;if(!Q)return;const De=Q.getBoundingClientRect(),Ee=8,ke=Math.max(200,De.width+40),Se=De.right-ke,be=Math.max(Ee,Math.min(Se,window.innerWidth-ke-Ee)),se=Math.min(De.bottom+Ee,window.innerHeight-Ee);H({top:se,left:be,width:ke})},Ue=()=>{const Q=ie.current;if(!Q)return;const De=Q.getBoundingClientRect(),Ee=10,ke=Math.min(980,Math.max(760,Math.round(window.innerWidth*.78))),Se=Math.max(640,Math.min(ke,window.innerWidth-Ee*2)),be=De.right-Se,se=Math.max(Ee,Math.min(be,window.innerWidth-Se-Ee)),F=Math.min(De.bottom+Ee,window.innerHeight-Ee);q({top:F,left:se,width:Se})},Fe=()=>{const Q=B.current;if(!Q)return;const De=Q.getBoundingClientRect(),Ee=8,ke=320,Se=De.left,be=Math.max(Ee,Math.min(Se,window.innerWidth-ke-Ee)),se=Math.min(De.bottom+Ee,window.innerHeight-Ee);he({top:se,left:be,width:ke})};X.useEffect(()=>{if(!G)return;Re();const Q=Se=>{const be=Se.target;$u(k.current,be)||$u(Z.current,be)||U(!1)},De=Se=>Se.key==="Escape"&&U(!1),Ee=()=>Re(),ke=()=>Re();return window.addEventListener("mousedown",Q),window.addEventListener("keydown",De),window.addEventListener("resize",Ee),window.addEventListener("scroll",ke,!0),()=>{window.removeEventListener("mousedown",Q),window.removeEventListener("keydown",De),window.removeEventListener("resize",Ee),window.removeEventListener("scroll",ke,!0)}},[G]),X.useEffect(()=>{if(!W)return;Ue();const Q=Se=>{const be=Se.target;$u(ie.current,be)||$u(oe.current,be)||ne(!1)},De=Se=>Se.key==="Escape"&&ne(!1),Ee=()=>Ue(),ke=()=>Ue();return window.addEventListener("mousedown",Q),window.addEventListener("keydown",De),window.addEventListener("resize",Ee),window.addEventListener("scroll",ke,!0),()=>{window.removeEventListener("mousedown",Q),window.removeEventListener("keydown",De),window.removeEventListener("resize",Ee),window.removeEventListener("scroll",ke,!0)}},[W]),X.useEffect(()=>{if(!K)return;Fe();const Q=Se=>{const be=Se.target;$u(B.current,be)||$u(Y.current,be)||V(!1)},De=Se=>Se.key==="Escape"&&V(!1),Ee=()=>Fe(),ke=()=>Fe();return window.addEventListener("mousedown",Q),window.addEventListener("keydown",De),window.addEventListener("resize",Ee),window.addEventListener("scroll",ke,!0),()=>{window.removeEventListener("mousedown",Q),window.removeEventListener("keydown",De),window.removeEventListener("resize",Ee),window.removeEventListener("scroll",ke,!0)}},[K]);const Ge=G?dh.createPortal(M.jsxs("div",{ref:Z,style:{position:"fixed",top:D.top,left:D.left,width:D.width,zIndex:99999,WebkitAppRegion:"no-drag"},className:ms("rounded-xl shadow-2xl ring-1","bg-base-200/95 text-base-content border border-base-300/60","backdrop-blur-md","p-2"),children:[M.jsx("div",{className:"text-[11px] px-2 py-1 opacity-70",children:"Theme"}),M.jsx("ul",{className:"menu menu-sm w-full",children:S.map(Q=>{const De=Q.id===l;return M.jsx("li",{children:M.jsxs("button",{type:"button",onClick:()=>{u&&u(Q.id),U(!1)},className:ms("flex items-center justify-between rounded-lg",De?"active font-semibold":""),children:[M.jsx("span",{className:"whitespace-nowrap",children:Q.label}),De?M.jsx("span",{className:"opacity-70",children:"✓"}):null]})},Q.id)})})]}),document.body):null,qe=K?dh.createPortal(M.jsxs("div",{ref:Y,style:{position:"fixed",top:ee.top,left:ee.left,width:ee.width,zIndex:99999,WebkitAppRegion:"no-drag"},className:ms("rounded-xl shadow-2xl ring-1","bg-base-200/92 text-base-content border border-base-300/60","backdrop-blur-md","p-3"),children:[M.jsx("div",{className:"text-[11px] px-1 py-1 opacity-70",children:"메뉴"}),M.jsxs("div",{className:"mt-2 space-y-2",children:[M.jsx($p,{active:r==="dashboard",icon:M.jsx(TA,{}),title:"Dashboard",sub:"상태/모드/컨트롤",onClick:()=>{o&&o("dashboard"),V(!1)}}),M.jsx($p,{active:r==="train",icon:M.jsx(AA,{}),title:"Training",sub:"랜드마크/학습/프로필",onClick:()=>{o&&o("train"),V(!1)}}),M.jsx($p,{active:r==="rush",icon:M.jsx(CA,{}),title:"Rush",sub:"러쉬 UI",onClick:()=>{o&&o("rush"),V(!1)}})]}),M.jsx("div",{className:"my-3 h-px bg-base-300/55"}),M.jsx($p,{active:!1,icon:M.jsx(RA,{}),title:"휴대폰 연결",sub:"QR 페어링",onClick:()=>{f&&f(),V(!1)}})]}),document.body):null,We=W?dh.createPortal(M.jsxs("div",{ref:oe,style:{position:"fixed",top:fe.top,left:fe.left,width:fe.width,height:"min(90vh, 860px)",zIndex:99999,WebkitAppRegion:"no-drag"},className:ms("rounded-xl shadow-2xl ring-1","bg-base-200/92 text-base-content border border-base-300/60","backdrop-blur-md","overflow-hidden","flex flex-col"),children:[M.jsxs("div",{className:"p-4 border-b border-base-300/45 bg-base-100/8",children:[M.jsxs("div",{className:"flex items-start justify-between gap-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-base font-semibold whitespace-nowrap",children:"설정"}),M.jsx("div",{className:"text-[12px] opacity-70 mt-0.5 truncate",children:"표시 옵션 / 모션(제스처) 세팅"})]}),M.jsx("button",{type:"button",className:ms("h-9 w-9 grid place-items-center rounded-lg ring-1","bg-base-100/18 ring-base-300/55","hover:bg-base-100/30 transition"),onClick:()=>ne(!1),title:"닫기",children:"×"})]}),M.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[M.jsx(z_,{active:ge==="display",onClick:()=>$("display"),children:"표시 설정"}),M.jsx(z_,{active:ge==="motion",onClick:()=>$("motion"),children:"모션 세팅"})]})]}),ge==="display"?M.jsxs("div",{className:"flex-1 min-h-0 overflow-auto p-4",children:[M.jsxs("div",{className:"rounded-xl ring-1 ring-base-300/45 bg-base-100/10 p-4",children:[M.jsx("div",{className:"text-sm font-semibold",children:"HUD 표시 옵션 (WEB/OS)"}),M.jsx("div",{className:"text-[12px] opacity-70 mt-1",children:"자주 쓰는 토글은 여기서만 관리"}),M.jsxs("div",{className:"mt-4 space-y-3",children:[M.jsx(H_,{title:"WEB HUD",desc:"웹 오버레이 HUD 표시",checked:i,onToggle:()=>e&&e()}),M.jsx(H_,{title:"OS HUD",desc:"OS 커서/오버레이 HUD 표시",checked:t,onToggle:()=>n&&n()})]})]}),M.jsx("div",{className:"mt-4 text-[11px] opacity-60",children:"팁: HUD는 CPU/GPU 부하가 생길 수 있으니 필요할 때만 켜는 것을 권장합니다."})]}):M.jsx("div",{className:"flex-1 min-h-0",children:M.jsx(ww,{theme:l,embedded:!0,onRequestClose:()=>ne(!1)})})]}),document.body):null,st=T[r]||"Dashboard";return M.jsxs("div",{className:ms("navbar h-14 px-4 select-none titlebar-drag","border-b border-base-300/45","bg-base-200/78 backdrop-blur-md","text-base-content"),onDoubleClick:g,children:[M.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[M.jsx("div",{className:"w-14 h-14 flex items-center justify-center shrink-0 overflow-hidden",children:M.jsx(EA,{className:"w-12 h-12 pointer-events-none"})}),M.jsx("span",{className:"font-semibold text-[15px] whitespace-nowrap",children:"Gesture Agent Manager"}),M.jsx("button",{ref:B,type:"button",onClick:()=>{U(!1),ne(!1),V(Q=>!Q)},className:ms("btn btn-sm rounded-lg","bg-base-100/18 border border-base-300/55","hover:bg-base-100/28","text-base-content"),"aria-expanded":K,title:"메뉴",style:{WebkitAppRegion:"no-drag"},children:M.jsxs("span",{className:"inline-flex items-center gap-2 whitespace-nowrap",children:[M.jsx("span",{className:"text-[11px] opacity-70",children:"PAGE"}),M.jsx("span",{className:"text-xs font-semibold",children:st}),M.jsx(bA,{})]})}),qe,M.jsxs("div",{className:"ml-1 flex items-center gap-1.5 min-w-0",children:[M.jsx(Jp,{tone:w?"ok":"bad",title:"에이전트 연결 상태",children:w?"연결됨":"끊김"}),M.jsx(Jp,{tone:C?"bad":"ok",title:"제스처 잠금 상태",children:C?"잠금":"해제"}),R===!1?M.jsx(Jp,{tone:"warn",title:"카메라 연결 상태",children:"카메라 미연결"}):null,M.jsxs(Jp,{tone:"neutral",title:"현재 모드",children:["모드: ",L]})]})]}),M.jsxs("div",{className:"ml-auto flex items-center gap-2",style:{WebkitAppRegion:"no-drag"},children:[M.jsx("button",{ref:ie,type:"button",onClick:()=>{U(!1),V(!1),$("motion"),ne(Q=>!Q)},className:ms("btn btn-sm rounded-lg","bg-base-100/18 border border-base-300/55","hover:bg-base-100/28","text-base-content"),"aria-expanded":W,title:"설정",children:M.jsx("span",{className:"text-xs font-semibold whitespace-nowrap",children:"설정"})}),We,M.jsxs("button",{ref:k,type:"button",onClick:()=>{V(!1),U(Q=>!Q)},className:ms("btn btn-sm rounded-lg","bg-base-100/18 border border-base-300/55","hover:bg-base-100/28","text-base-content"),"aria-expanded":G,title:"테마",children:[M.jsx("span",{className:"text-[11px] opacity-70 mr-2 whitespace-nowrap",children:"Theme"}),M.jsx("span",{className:"text-xs font-semibold whitespace-nowrap",children:E}),M.jsx("span",{className:"ml-2 opacity-60",children:"▾"})]}),Ge,M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsx("button",{className:"w-10 h-8 rounded-md hover:bg-base-300/30",onClick:m,title:"Minimize",children:"—"}),M.jsx("button",{className:"w-10 h-8 rounded-md hover:bg-base-300/30",onClick:g,title:"Maximize",children:"□"}),M.jsx("button",{className:"w-10 h-8 rounded-md hover:bg-error/20",onClick:v,title:"Close",children:"×"})]})]})]})}const Mw=window.location.protocol==="file:"?"http://127.0.0.1:8082/api":"/api",zc=Xn.create({baseURL:Mw,withCredentials:!0,timeout:8e3,headers:{Accept:"application/json"}}),Ew=Xn.create({baseURL:Mw,withCredentials:!0,timeout:8e3,headers:{Accept:"application/json"}});let Qp=null;function NA({getAccessToken:i,setAccessToken:e,onLogout:t}){zc.interceptors.request.use(n=>{const r=i?.();return r&&(n.headers.Authorization=`Bearer ${r}`),n}),zc.interceptors.response.use(n=>n,async n=>{const r=n?.response?.status,o=n?.config;if(!o||r!==401||o._retry)return Promise.reject(n);o._retry=!0;try{Qp||(Qp=Ew.post("/auth/token",null).then(u=>u?.data?.accessToken||null).finally(()=>{Qp=null}));const l=await Qp;if(!l)throw new Error("NO_REFRESH_TOKEN");return e?.(l),o.headers={...o.headers||{},Authorization:`Bearer ${l}`},zc(o)}catch{return await t?.(),Promise.reject(n)}})}async function LA(){try{return(await Ew.post("/auth/token",null))?.data?.accessToken||null}catch(i){if(i?.response?.status===401)return null;throw i}}async function IA(i){const e={};return i&&(e.Authorization=`Bearer ${i}`),(await zc.post("/auth/bridge/start",null,{headers:e}))?.data}function DA({code:i,webOrigin:e="http://localhost:5174"}={}){const t=`${e}/bridge?code=${encodeURIComponent(i)}`;window.open(t,"_blank","noreferrer")}const bw=X.createContext(null),Wx=()=>X.useContext(bw),j0="gos.accountAccessToken";function kA({children:i}){const[e,t]=X.useState(null),[n,r]=X.useState(!0),[o,l]=X.useState(0),u=()=>localStorage.getItem(j0),f=_=>{_?localStorage.setItem(j0,_):localStorage.removeItem(j0)},h=X.useRef(null),m=X.useCallback(async()=>{try{await zc.post("/auth/logout",null)}catch{}f(null),t(null),l(_=>_+1)},[]),g=X.useCallback(async()=>{if(h.current)return h.current;const _=(async()=>{try{const E=(await zc.get("/members/me"))?.data?.user||null;return t(E),l(w=>w+1),E}catch(T){const E=T?.response?.status;if(E===401||E===403)return await m(),null;throw T}finally{h.current=null}})();return h.current=_,_},[m]),v=X.useCallback(async(_,T)=>{const w=(await zc.post("/members/login",{loginId:_,loginPw:T}))?.data?.accessToken;if(!w)throw new Error("NO_TOKEN");return f(w),await g()},[g]);X.useEffect(()=>{NA({getAccessToken:u,setAccessToken:f,onLogout:m})},[]),X.useEffect(()=>{(async()=>{try{if(u())await g();else{const T=await LA().catch(()=>null);T&&(f(T),await g())}}catch{await m()}finally{r(!1)}})()},[]),X.useEffect(()=>{if(n||!e)return;const _=()=>g().catch(()=>{}),T=()=>{document.hidden||g().catch(()=>{})};return window.addEventListener("focus",_),document.addEventListener("visibilitychange",T),()=>{window.removeEventListener("focus",_),document.removeEventListener("visibilitychange",T)}},[n,e,g]),X.useEffect(()=>{},[n,e,g]);const S=X.useMemo(()=>({user:e,isAuthed:!!e,booting:n,loginWithCredentials:v,refreshMe:g,logout:m,profileBump:o}),[e,n,v,g,m,o]);return M.jsx(bw.Provider,{value:S,children:i})}function _n(...i){return i.filter(Boolean).join(" ")}function j_({open:i,onClose:e,children:t}){return i?M.jsxs("div",{className:"fixed inset-0 z-[999] flex items-center justify-center p-6",children:[M.jsx("div",{className:"absolute inset-0 bg-black/55 backdrop-blur-[2px]",onMouseDown:e}),M.jsx("div",{className:"relative w-full max-w-md",children:t})]}):null}function OA({spinning:i}){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:_n("opacity-90",i&&"animate-spin"),children:M.jsx("path",{d:"M20 12a8 8 0 1 1-2.34-5.66M20 4v6h-6",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})})}const em=Xn.create({baseURL:window.location.protocol==="file:"?"http://127.0.0.1:8082/api":"/api",timeout:5e3,headers:{Accept:"application/json"}});function UA({t:i,theme:e,onOpenTraining:t}){const{user:n,isAuthed:r,booting:o,loginWithCredentials:l,logout:u,refreshMe:f,profileBump:h}=Wx(),[m,g]=X.useState(!1),[v,S]=X.useState(!1),[_,T]=X.useState(""),[E,w]=X.useState(""),[C,R]=X.useState(!1),[L,G]=X.useState(""),[U,k]=X.useState(null),Z=X.useCallback(we=>{k(we),window.setTimeout(()=>k(null),1400)},[]),D=X.useMemo(()=>{const we=n?.id??n?.memberId??n?.member_id??null;if(we==null)return null;const Te=String(we).trim();return/^\d+$/.test(Te)?Te:null},[n]),H=X.useMemo(()=>(D?String(D):"guest").replace(/[^a-zA-Z0-9_-]/g,"_").toLowerCase(),[D]),W=!r||!D,ne=X.useMemo(()=>W?{}:{"X-User-Id":D},[W,D]),ge=X.useMemo(()=>W?"":`u${H}__`,[W,H]),$=X.useCallback(we=>{const Te=String(we||"");return Te==="default"?"기본":ge&&Te.startsWith(ge)?Te.slice(ge.length):Te},[ge]),[ie,oe]=X.useState("default"),[fe,q]=X.useState([]),[K,V]=X.useState([]),[B,Y]=X.useState(!1),[ee,he]=X.useState(""),[Re,Ue]=X.useState("default"),Fe=X.useCallback(async()=>{he(""),Y(!0);try{const{data:we}=await em.get("/train/stats",{headers:ne}),Te=we?.learnProfile||"default",rt=Array.isArray(we?.learnProfiles)?we.learnProfiles:[];if(oe(Te),q(rt),Ue(He=>B?He:Te),W)V([]);else try{const He=await em.get("/train/profile/db/list",{headers:ne});V(Array.isArray(He?.data?.profiles)?He.data.profiles:[])}catch{V([])}}catch(we){const Te=we?.response?`프로필 조회 실패 (HTTP ${we.response.status})`:we?.message||"프로필 조회 실패";he(Te)}finally{Y(!1)}},[W,ne,B]);X.useEffect(()=>{if(!r){oe("default"),q([]),V([]),Ue("default"),he(""),Y(!1);return}Fe()},[r,Fe]);const Ge=X.useMemo(()=>{if(W)return[{value:"default",label:"default(기본)"}];const we=new Set(["default",ie,...fe||[],...K||[]]),Te=Array.from(we).filter(Boolean),rt=Te.filter(Oe=>Oe==="default"||String(Oe).startsWith(ge)),He=Te.filter(Oe=>Oe!=="default"&&!String(Oe).startsWith(ge)),ot=rt.map(Oe=>({value:Oe,label:$(Oe)})).sort((Oe,Ot)=>Oe.value==="default"?-1:Ot.value==="default"?1:Oe.label.localeCompare(Ot.label)),_t=He.map(Oe=>({value:Oe,label:`공용 · ${Oe}`})).sort((Oe,Ot)=>Oe.label.localeCompare(Ot.label)),Et=_t.length>0?[{value:"__sep_shared__",label:"──────── 공용 프로필 ────────",disabled:!0}]:[];return[...ot,...Et,..._t]},[ge,K,$,W,ie,fe]),qe=X.useCallback(async we=>{const Te=W?"default":we;if(W&&Te!=="default"){Z("게스트: default만 가능"),Ue("default"),oe("default");return}oe(Te),Ue(Te),Y(!0),he("");try{const{data:rt}=await em.post("/train/profile/set",null,{params:{name:Te},headers:ne});if(!rt?.ok){Z("프로필 적용 실패"),await Fe();return}Z(`프로필 적용: ${$(Te)}`);const He=Date.now()+1500;for(;Date.now()<He;){try{const _t=(await em.get("/train/stats",{headers:ne}))?.data?.learnProfile||"default";if(oe(_t),_t===Te)break}catch{}await new Promise(ot=>setTimeout(ot,120))}await Fe()}catch(rt){const He=rt?.response?`프로필 적용 실패 (HTTP ${rt.response.status})`:rt?.message||"프로필 적용 실패";he(He),Z("프로필 적용 실패"),await Fe()}finally{Y(!1)}},[$,Fe,W,ne,Z]),We=e==="light"||e==="rose",st=X.useMemo(()=>"http://localhost:5174",[]),Q=we=>{if(window.managerWin?.openExternal)return window.managerWin.openExternal(we);window.open(we,"_blank","noopener,noreferrer")};X.useEffect(()=>{if(!r||typeof f!="function")return;const we=()=>f().catch(()=>{}),Te=()=>{document.hidden||f().catch(()=>{})};return window.addEventListener("focus",we),document.addEventListener("visibilitychange",Te),()=>{window.removeEventListener("focus",we),document.removeEventListener("visibilitychange",Te)}},[r,f]);const De=async we=>{we.preventDefault(),G("");const Te=_.trim(),rt=E.trim();if(!Te||!rt)return G("아이디/비밀번호를 입력하세요.");try{R(!0),await l(Te,rt),g(!1),w(""),Z("로그인 완료")}catch(He){G(He?.response?.status===401?"로그인 실패(아이디/비밀번호 확인)":"로그인 실패(서버 확인)")}finally{R(!1)}},Ee=async()=>{try{R(!0),await u(),S(!1),Z("로그아웃 완료")}finally{R(!1)}},ke=n?.nickname||n?.name||"User",Se=n?.email||"-",be=n?.role||"-",se=X.useMemo(()=>{const we=n?.profileImageUrl||n?.profile_image_url||n?.profileImage||n?.profile_image||n?.image||n?.avatar;if(!we)return null;if(/^https?:\/\//i.test(we))return we;const Te=we.startsWith("/")?we:`/${we}`;return`${st}${Te}`},[n,st]),F=_n("rounded-lg ring-1 overflow-hidden",i.panel),O=_n("px-4 py-3 border-b flex items-center justify-between",We?"border-slate-200":"border-white/10"),ce="px-4 py-3",Pe=_n("text-xs font-semibold underline underline-offset-4 opacity-90 hover:opacity-100 transition",i.text2);return M.jsxs(M.Fragment,{children:[M.jsxs("div",{className:F,children:[M.jsxs("div",{className:O,children:[M.jsx("div",{className:_n("text-sm font-semibold tracking-tight",i.text),children:"프로필"}),M.jsxs("div",{className:"flex items-center gap-3",children:[M.jsx("button",{type:"button",className:Pe,onClick:()=>Q(`${st}/mypage`),children:"웹페이지"}),r?M.jsx("button",{type:"button",className:Pe,onClick:()=>S(!0),children:"로그아웃"}):null]})]}),M.jsx("div",{className:ce,children:o?M.jsx("div",{className:_n("text-sm",i.muted),children:"불러오는 중..."}):r?M.jsxs("div",{className:"space-y-3",children:[M.jsxs("div",{className:"flex items-center justify-between gap-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[M.jsx("div",{className:_n("text-[15px] font-semibold truncate",i.text),children:ke}),M.jsx("span",{className:_n("inline-flex items-center px-2 py-0.5 text-[11px] ring-1 rounded-sm",We?"bg-slate-100 ring-slate-200 text-slate-900":"bg-white/10 ring-white/12 text-white/90"),children:be})]}),M.jsx("div",{className:_n("text-xs mt-1 truncate",i.muted),children:Se})]}),M.jsx("div",{className:_n("h-8 w-8 rounded-md ring-1 grid place-items-center text-[12px] font-bold overflow-hidden shrink-0",We?"bg-white ring-slate-200":"bg-white/5 ring-white/12",i.text),title:"계정",children:se?M.jsx("img",{src:se,alt:"",className:"h-full w-full object-cover",onError:we=>{we.target.style.display="none",we.target.parentElement.innerText=/[^\x00-\x7F]/.test(ke)?ke.slice(0,1):ke.slice(0,2).toUpperCase()}}):/[^\x00-\x7F]/.test(ke)?ke.slice(0,1):ke.slice(0,2).toUpperCase()})]}),M.jsxs("div",{className:_n("rounded-md ring-1 p-3",i.panelSoft,We?"ring-slate-200":"ring-white/12"),children:[M.jsxs("div",{className:"flex items-center justify-between gap-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:_n("text-xs font-semibold",i.text),children:"나의 제스처 설정"}),M.jsxs("div",{className:_n("mt-1 text-[11px] truncate",i.muted),children:["현재: ",M.jsx("span",{className:_n("font-semibold",i.text2),children:$(ie)})]})]}),M.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[M.jsx("button",{type:"button",className:_n("h-8 w-8 grid place-items-center rounded-md ring-1 transition",i.btn),onClick:()=>!B&&Fe(),disabled:B,title:"새로고침",children:M.jsx(OA,{spinning:B})}),typeof t=="function"?M.jsx("button",{type:"button",className:_n("h-8 px-3 text-xs font-semibold rounded-md ring-1 transition",i.btn),onClick:t,disabled:B,children:"트레이닝"}):null]})]}),M.jsx("select",{value:Re,onChange:we=>{const Te=we.target.value;Te!=="__sep_shared__"&&(Ue(Te),qe(Te))},disabled:B,className:_n("mt-2 w-full rounded-md ring-1 px-3 py-2 text-sm outline-none focus:ring-2 disabled:opacity-50",i.input,We?"focus:ring-sky-400/40":"focus:ring-sky-500/45"),children:Ge.map(we=>M.jsx("option",{value:we.value,disabled:!!we.disabled,children:we.label},we.value))}),ee?M.jsx("div",{className:_n("mt-2 text-[11px]",We?"text-rose-600":"text-rose-200"),children:ee}):null]})]}):M.jsxs("div",{className:"space-y-3",children:[M.jsx("div",{className:_n("text-sm",i.muted),children:"계정 로그인 후 프로필과 동기화됩니다."}),M.jsx("button",{type:"button",className:_n("w-full rounded-md py-3 text-sm font-semibold ring-1 transition active:scale-[0.99]",i.btn),onClick:()=>g(!0),children:"로그인"})]})}),M.jsx(j_,{open:m,onClose:()=>!C&&g(!1),children:M.jsxs("div",{className:_n("rounded-md ring-1 overflow-hidden",i.panel),children:[M.jsxs("div",{className:_n("px-4 py-3 border-b flex items-center justify-between",We?"border-slate-200":"border-white/10"),children:[M.jsx("div",{className:_n("text-sm font-semibold",i.text),children:"로그인"}),M.jsx("button",{type:"button",className:_n("px-2.5 py-1.5 text-xs rounded-md ring-1 transition",i.btn),onClick:()=>!C&&g(!1),children:"닫기"})]}),M.jsxs("form",{className:"px-4 py-4 space-y-3",onSubmit:De,children:[M.jsx("input",{className:_n("w-full rounded-md ring-1 px-3 py-2 text-sm outline-none focus:ring-2 disabled:opacity-50",i.input),placeholder:"아이디",value:_,onChange:we=>T(we.target.value),disabled:C,autoFocus:!0}),M.jsx("input",{className:_n("w-full rounded-md ring-1 px-3 py-2 text-sm outline-none focus:ring-2 disabled:opacity-50",i.input),placeholder:"비밀번호",type:"password",value:E,onChange:we=>w(we.target.value),disabled:C}),L?M.jsx("div",{className:_n("text-xs",We?"text-rose-600":"text-rose-200"),children:L}):null,M.jsx("button",{type:"submit",disabled:C,className:_n("w-full rounded-md py-3 text-sm font-semibold ring-1 transition disabled:opacity-50",i.btn),children:C?"로그인 중...":"로그인"})]})]})}),M.jsx(j_,{open:v,onClose:()=>!C&&S(!1),children:M.jsxs("div",{className:_n("rounded-md ring-1 overflow-hidden",i.panel),children:[M.jsxs("div",{className:_n("px-4 py-3 border-b flex items-center justify-between",We?"border-slate-200":"border-white/10"),children:[M.jsx("div",{className:_n("text-sm font-semibold",i.text),children:"로그아웃"}),M.jsx("button",{type:"button",className:_n("px-2.5 py-1.5 text-xs rounded-md ring-1 transition",i.btn),onClick:()=>!C&&S(!1),children:"닫기"})]}),M.jsxs("div",{className:"px-4 py-4 space-y-3",children:[M.jsx("div",{className:_n("text-sm",i.text),children:"정말 로그아웃할까요?"}),M.jsxs("div",{className:"flex gap-2",children:[M.jsx("button",{type:"button",className:_n("flex-1 rounded-md py-3 text-sm font-semibold ring-1 transition",i.btn),onClick:()=>!C&&S(!1),disabled:C,children:"취소"}),M.jsx("button",{type:"button",className:_n("flex-1 rounded-md py-3 text-sm font-semibold ring-1 transition",i.btn),onClick:Ee,disabled:C,children:C?"처리 중...":"로그아웃"})]})]})]})})]}),U?M.jsx("div",{className:"fixed bottom-6 left-6 z-[1000]",children:M.jsx("div",{className:_n("px-4 py-2 rounded-md ring-1 text-sm",i.panel,i.text),children:U})}):null]})}function Xr(...i){return i.filter(Boolean).join(" ")}function Tw(){const i=new Date,e=String(i.getHours()).padStart(2,"0"),t=String(i.getMinutes()).padStart(2,"0");return`${e}:${t}`}function Aw(){try{return crypto.randomUUID()}catch{return`${Date.now()}_${Math.random().toString(16).slice(2)}`}}function fg(i){return String(i||"").replace(/[\u200B-\u200D\uFEFF]/g,"").trim().replace(/\s+/g," ")}function V_(i){const e=fg(i),t=e.toLowerCase();return/(켜|켜줘|on|enable|enabled|true)/.test(e)||/(^|\s)on(\s|$)/.test(t)?!0:/(꺼|꺼줘|off|disable|disabled|false)/.test(e)||/(^|\s)off(\s|$)/.test(t)?!1:null}function FA(i){const e=fg(i),t=e.toLowerCase(),n=r=>r.test(e)||r.test(t);return n(/(마우스|mouse)/)?"MOUSE":n(/(키보드|keyboard)/)?"KEYBOARD":n(/(프레젠테이션|ppt|presentation)/)?"PRESENTATION":n(/(그리기|draw)/)?"DRAW":n(/(가상\s*키보드|vkey|virtual)/)?"VKEY":null}function BA(i){const e=String(i).match(/-?\d+(\.\d+)?/);if(!e)return null;const t=Number(e[0]);return Number.isFinite(t)?t:null}const zA=["사용 가능한 명령 예시","- 시작해줘 / 정지해줘","- 프리뷰 켜줘 / 프리뷰 꺼줘","- 잠금 걸어줘 / 잠금 풀어줘","- 모드 마우스 / 모드 키보드 / 모드 PPT / 모드 그리기 / 모드 가상키보드","- 감도 1.6 (0.2 ~ 4.0)","- 상태 보여줘","- (그 외 질문은 AI가 자연스럽게 대화함. 예: '모션 기능 뭐있어', '우 클릭은?', '안녕')"].join(`
C:\puh\puh\manager\GestureOSManager\front\dist\assets\index-BOxduUqw.js:19:`);async function HA(i){const e=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({message:i})}),t=await e.json().catch(()=>({}));if(!e.ok||t.ok===!1)throw new Error(t.error||"AI 호출 실패");return{text:String(t.text||"").trim(),cards:Array.isArray(t.cards)?t.cards:[],meta:t.meta||{}}}function jA(i){const e=new Map;for(const t of i||[]){const n=String(t.mode||"etc");e.has(n)||e.set(n,[]),e.get(n).push(t)}return Array.from(e.entries())}function G_(){return[{id:Aw(),role:"assistant",ts:Tw(),text:`명령 채팅창 준비됨.
C:\puh\puh\manager\GestureOSManager\front\dist\assets\index-BOxduUqw.js:22:'도움' 입력하면 목록을 보여줄게.`}]}function VA({resetKey:i,t:e,busy:t,preview:n,derived:r,view:o,actions:l}){const{start:u,stop:f,applyMode:h,togglePreview:m,setLock:g,fetchStatus:v,setGain:S}=l||{},[_,T]=X.useState(()=>G_()),[E,w]=X.useState(""),[C,R]=X.useState(!1),[L,G]=X.useState({}),U=X.useRef(null),k=X.useRef(null),Z=X.useRef(null),D=X.useCallback((K,V,B)=>{const Y={id:Aw(),role:K,ts:Tw(),text:String(V??""),...B||{}};T(ee=>[...ee,Y])},[]);X.useEffect(()=>{T(G_()),G({}),w(""),R(!1),requestAnimationFrame(()=>{try{Z.current?.focus()}catch{}try{k.current?.scrollIntoView({block:"end"})}catch{const K=U.current;K&&(K.scrollTop=K.scrollHeight)}})},[i]),X.useEffect(()=>(window.__GOS_CHAT_LOG__=(...K)=>{if(K.length===1){D("agent",K[0]);return}const[V,B]=K,Y=String(V||"agent").toLowerCase();D(Y==="user"?"user":Y==="assistant"||Y==="system"?"assistant":"agent",B)},()=>{try{delete window.__GOS_CHAT_LOG__}catch{}}),[D]),X.useEffect(()=>{const K=k.current;K&&requestAnimationFrame(()=>{try{K.scrollIntoView({block:"end"})}catch{const V=U.current;V&&(V.scrollTop=V.scrollHeight)}})},[_.length,C]);const H=X.useMemo(()=>{const K=r?.connected?"연결됨":"끊김",V=r?.enabled?"실행 중":"정지",B=r?.locked?"잠금":"해제",Y=n?"ON":"OFF",ee=o?.modeText||r?.mode||"-";return`연결: ${K} / 실행: ${V} / 잠금: ${B} / Preview: ${Y} / 모드: ${ee}`},[r?.connected,r?.enabled,r?.locked,r?.mode,n,o?.modeText]),W=async K=>{const V=fg(K),B=V.toLowerCase();if(!V)return"입력이 비었어. 예: '시작해줘'";if(/^(\?|help|도움)$/.test(B)||V.includes("도움"))return zA;if(V.includes("상태")||B.includes("status"))return H;if(/(시작|start|실행)/.test(V)){if(typeof u!="function")return"start 액션이 연결되지 않았어.";const Y=await u({source:"chat"});return Y?.ok===!1&&Y?.reason==="camera"?Y?.message||"카메라 연결 후 사용 가능.":"실행 요청 완료."}if(/(정지|중지|stop)/.test(V))return typeof f!="function"?"stop 액션이 연결되지 않았어.":(await f(),"정지 요청 완료.");if(V.includes("프리뷰")||B.includes("preview")){if(typeof m!="function")return"preview 액션이 연결되지 않았어.";const Y=V_(V),ee=await m(Y,{source:"chat"});return ee?.ok===!1&&ee?.reason==="camera"?ee?.message||"카메라 연결 후 Preview 사용 가능.":Y===null?"Preview 토글 완료.":Y?"Preview ON 완료.":"Preview OFF 완료."}if(V.includes("잠금")||V.includes("락")||B.includes("lock")){if(typeof g!="function")return"lock 액션이 연결되지 않았어.";const Y=(()=>{if(/(풀|해제)/.test(V))return!1;const ee=V_(V);return ee!==null?ee:!r?.locked})();return await g(!!Y),Y?"잠금 ON 완료.":"잠금 해제 완료."}if(V.includes("모드")||B.includes("mode")){if(typeof h!="function")return"mode 액션이 연결되지 않았어.";const Y=FA(V);if(!Y)return"모드를 못 찾겠어. 예: '모드 마우스', '모드 키보드', '모드 PPT'";const ee=await h(Y,{source:"chat"});return ee?.ok===!1&&ee?.reason==="camera"?ee?.message||"카메라 연결 후 모드 변경 가능.":`모드 변경 완료: ${Y}`}if(V.includes("감도")||V.includes("민감")||B.includes("sensitivity")||B.includes("gain")){if(typeof S!="function")return"setGain 액션이 연결되지 않았어.";const Y=BA(V);if(Y===null)return"감도 값(0.2~4.0)을 같이 적어줘. 예: 감도 1.6";const ee=await S(Y);return ee?.ok?`감도 적용 완료: ${Number(ee.gain).toFixed(2)} (허용 범위 0.2~4.0)`:ee?.message||"감도 변경 실패"}return await HA(V)},ne=async()=>{const K=fg(E);if(K){D("user",K),w(""),R(!0);try{const V=await W(K);if(typeof V=="object"&&V&&"text"in V?D("assistant",V.text,{cards:V.cards||[],meta:V.meta||{}}):D("assistant",V),typeof v=="function")try{await v()}catch{}}catch(V){D("assistant",`오류: ${V?.message||String(V)}`)}finally{R(!1),requestAnimationFrame(()=>{try{Z.current?.focus()}catch{}})}}},ge=!!t||!!C,$=e?.panelSoft||e?.panel2||e?.panel,ie=Xr("ring-1",e?.panel2||e?.panelSoft||e?.panel),oe="bg-sky-500/10 ring-sky-400/25",fe=(K,V)=>{const B=`${K}:${V}`;G(Y=>({...Y,[B]:!Y[B]}))},q=K=>{const V=String(K||"").toLowerCase();return V==="mouse"?"마우스":V==="keyboard"?"키보드":V==="draw"?"그리기":V==="presentation"?"PPT":V==="vkey"?"가상키보드":K||"기타"};return M.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-3",children:[M.jsx("div",{ref:U,className:Xr("flex-1 min-h-0 overflow-auto rounded-xl ring-1 p-3",$,"overscroll-contain"),children:M.jsxs("div",{className:"space-y-2",children:[_.map(K=>{const V=K.role==="user",B=!V&&Array.isArray(K.cards)&&K.cards.length>0;return M.jsx("div",{className:Xr("w-full flex",V?"justify-end":"justify-start"),children:M.jsxs("div",{className:Xr("max-w-[92%] md:max-w-[78%] px-3 py-2 rounded-xl ring-1",V?oe:ie),children:[M.jsx("div",{className:Xr("whitespace-pre-wrap text-xs leading-relaxed",e?.text),children:K.text}),B?M.jsx("div",{className:"mt-2 space-y-3",children:jA(K.cards).map(([Y,ee])=>{const he=q(Y),Re=`${K.id}:${Y}`,Fe=!!L[Re]?ee:ee.slice(0,3),Ge=Math.max(0,ee.length-Fe.length);return M.jsxs("div",{className:Xr("rounded-xl ring-1 p-2",e?.panel2||e?.panelSoft||e?.panel),children:[M.jsxs("div",{className:Xr("text-[11px] font-semibold",e?.text),children:[he," (",ee.length,")"]}),M.jsx("div",{className:"mt-2 space-y-2",children:Fe.map((qe,We)=>M.jsxs("div",{className:Xr("rounded-xl ring-1 p-2",e?.panel2||e?.panelSoft||e?.panel),children:[M.jsx("div",{className:Xr("text-xs font-semibold",e?.text),children:qe.title}),M.jsxs("div",{className:Xr("mt-1 text-[11px] opacity-80",e?.muted),children:[qe.trigger?`trigger: ${qe.trigger}`:"",qe.action?` · action: ${qe.action}`:""]}),qe.image?M.jsx("img",{src:qe.image,alt:qe.title,className:"mt-2 w-full max-w-[320px] rounded-lg ring-1 block object-contain",loading:"lazy"}):null,Array.isArray(qe.howTo)&&qe.howTo.length?M.jsx("ul",{className:Xr("mt-2 text-[11px] list-disc pl-5",e?.text),children:qe.howTo.map((st,Q)=>M.jsx("li",{children:st},Q))}):null]},We))}),Ge>0?M.jsxs("button",{type:"button",className:Xr("mt-2 text-[11px] underline opacity-80",e?.text),onClick:()=>fe(K.id,Y),children:["더보기 (+",Ge,")"]}):ee.length>3?M.jsx("button",{type:"button",className:Xr("mt-2 text-[11px] underline opacity-80",e?.text),onClick:()=>fe(K.id,Y),children:"접기"}):null]},Re)})}):null,M.jsxs("div",{className:Xr("mt-2 text-[10px] opacity-60",e?.muted),children:[V?"You":"Agent"," · ",K.ts]})]})},K.id)}),C?M.jsx("div",{className:"w-full flex justify-start",children:M.jsx("div",{className:Xr("max-w-[78%] px-3 py-2 rounded-xl ring-1",ie),children:M.jsx("div",{className:Xr("text-xs opacity-70",e?.muted),children:"처리 중…"})})}):null,M.jsx("div",{ref:k})]})}),M.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2",children:[M.jsx("input",{ref:Z,className:Xr("h-10 px-3 text-sm outline-none ring-1 rounded-xl transition disabled:opacity-50",e?.input),placeholder:"명령 입력… (예: 시작해줘 / 감도 1.6)",value:E,onChange:K=>w(K.target.value),onKeyDown:K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),ge||ne())},disabled:ge}),M.jsx("button",{type:"button",onClick:ne,disabled:ge,className:Xr("h-10 px-4 text-sm font-semibold ring-1 rounded-xl transition disabled:opacity-50",e?.btn),children:"보내기"})]})]})}let Ps;const Yv=new Set;function GA(i="ws://127.0.0.1:8080/ws/agent"){return Ps&&(Ps.readyState===WebSocket.OPEN||Ps.readyState===WebSocket.CONNECTING)||(Ps=new WebSocket(i),Ps.onopen=()=>console.log("[WS] connected"),Ps.onclose=()=>console.log("[WS] closed"),Ps.onerror=e=>console.log("[WS] error",e),Ps.onmessage=e=>{try{const t=JSON.parse(e.data);Yv.forEach(n=>{try{n(t)}catch{}})}catch{}}),Ps}function WA(i){return typeof i!="function"?()=>{}:(Yv.add(i),()=>Yv.delete(i))}function XA(){try{Ps?.close?.()}catch{}Ps=void 0}const YA=500,W_=["MOUSE","KEYBOARD","PRESENTATION","DRAW","VKEY"],X_={MOUSE:"마우스",KEYBOARD:"키보드",PRESENTATION:"프레젠테이션",DRAW:"그리기",VKEY:"가상키보드"},qA=window.location.protocol==="file:"?"http://127.0.0.1:8080/api":"/api",xa=Xn.create({baseURL:qA,timeout:5e3,headers:{Accept:"application/json"}});function Bt(...i){return i.filter(Boolean).join(" ")}function Y_(i){return typeof i!="number"||Number.isNaN(i)?null:Math.max(0,Math.min(1,i))}function V0(i,e=1){return i==null||Number.isNaN(Number(i))?"-":Number(i).toFixed(e)}async function tm(){try{return navigator.mediaDevices?.enumerateDevices?(await navigator.mediaDevices.enumerateDevices()).some(e=>e.kind==="videoinput"):null}catch{return null}}function KA(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-90",children:M.jsx("path",{d:"M8 5v14l12-7-12-7Z",stroke:"currentColor",strokeWidth:"1.7",strokeLinejoin:"round"})})}function ZA(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-90",children:M.jsx("path",{d:"M7 7h10v10H7V7Z",stroke:"currentColor",strokeWidth:"1.7",strokeLinejoin:"round"})})}function JA({spinning:i}){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:Bt("opacity-90",i&&"animate-spin"),children:M.jsx("path",{d:"M20 12a8 8 0 1 1-2.34-5.66M20 4v6h-6",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})})}function $A(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-90",children:[M.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7-10-7-10-7Z",stroke:"currentColor",strokeWidth:"1.7",strokeLinejoin:"round"}),M.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"1.7"})]})}function QA(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-90",children:[M.jsx("path",{d:"M8 11V8a4 4 0 0 1 8 0v3",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round"}),M.jsx("path",{d:"M7 11h10v10H7V11Z",stroke:"currentColor",strokeWidth:"1.7",strokeLinejoin:"round"})]})}function e2(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:M.jsx("path",{d:"m9 6 6 6-6 6",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"})})}function _c({t:i,children:e,tone:t="slate"}){const n={slate:Bt(i.chip,i.text2,"ring-1"),blue:Bt("bg-sky-500/12 ring-sky-400/25",i.text2,"ring-1"),green:Bt("bg-emerald-500/12 ring-emerald-400/25",i.text2,"ring-1"),yellow:Bt("bg-amber-500/14 ring-amber-400/25",i.text2,"ring-1"),red:Bt("bg-rose-500/12 ring-rose-400/25",i.text2,"ring-1")};return M.jsx("span",{className:Bt("inline-flex items-center rounded-full px-2 py-0.5 text-[11px]",n[t]||n.slate),children:e})}function nm({t:i,title:e,right:t,children:n,accent:r="slate",className:o,bodyClassName:l}){const u={slate:"from-slate-400/18 via-transparent to-transparent",blue:"from-sky-400/20 via-transparent to-transparent",green:"from-emerald-400/20 via-transparent to-transparent",red:"from-rose-400/20 via-transparent to-transparent",yellow:"from-amber-400/20 via-transparent to-transparent"},f=i._isBright??!1,h=f?"shadow-[0_10px_26px_rgba(15,23,42,0.08)]":"shadow-[0_10px_34px_rgba(0,0,0,0.25)]";return M.jsxs("div",{className:Bt("rounded-lg ring-1 overflow-hidden flex flex-col",i.panel,h,"transition-transform duration-200 hover:-translate-y-[1px]",o),children:[M.jsx("div",{className:Bt("h-px w-full bg-gradient-to-r",u[r]||u.slate)}),M.jsxs("div",{className:Bt("flex items-center justify-between px-3 py-2 border-b",f?"border-slate-200":"border-white/10"),children:[M.jsx("div",{className:Bt("text-[13px] font-semibold",i.text),children:e}),t]}),M.jsx("div",{className:Bt("px-3 py-2.5",l),children:n})]})}function t2({t:i,className:e,...t}){return M.jsx("button",{className:Bt("w-full rounded-lg py-2 text-[13px] font-semibold ring-1 transition disabled:opacity-50 disabled:cursor-not-allowed",i.btn,e),...t})}function q_({t:i,tone:e="slate",icon:t,title:n,desc:r,className:o,...l}){const u=i._isBright??!1,f={slate:Bt(u?"bg-white":"bg-white/5",u?"ring-slate-200":"ring-white/12"),green:Bt("bg-emerald-500/8",u?"ring-emerald-300/70":"ring-emerald-400/25"),red:Bt("bg-rose-500/8",u?"ring-rose-300/70":"ring-rose-400/25"),blue:Bt("bg-sky-500/8",u?"ring-sky-300/70":"ring-sky-400/25")},h={slate:Bt(i.chip),green:Bt("bg-emerald-500/10",u?"ring-emerald-300/70":"ring-emerald-400/25"),red:Bt("bg-rose-500/10",u?"ring-rose-300/70":"ring-rose-400/25"),blue:Bt("bg-sky-500/10",u?"ring-sky-300/70":"ring-sky-400/25")};return M.jsx("button",{className:Bt("w-full rounded-lg p-2 ring-1 transition text-left disabled:opacity-50 disabled:cursor-not-allowed",u?"shadow-[0_10px_26px_rgba(15,23,42,0.08)]":"shadow-[0_10px_30px_rgba(0,0,0,0.25)]",f[e]||f.slate,o),...l,children:M.jsxs("div",{className:"flex items-center gap-2.5",children:[M.jsx("div",{className:Bt("h-9 w-9 rounded-lg ring-1 grid place-items-center",h[e]||h.slate),children:M.jsx("div",{className:Bt(i.text),children:t})}),M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:Bt("text-[13px] font-semibold leading-5",i.text),children:n}),M.jsx("div",{className:Bt("text-[11px] mt-0.5 truncate",i.muted),children:r})]}),M.jsx("div",{className:Bt("ml-auto",i.muted2),children:M.jsx(e2,{})})]})})}function K_({t:i,checked:e,onChange:t,disabled:n}){const r=i._isBright??!1;return M.jsx("button",{type:"button",disabled:n,onClick:()=>t?.(!e),className:Bt("relative inline-flex h-5 w-9 items-center rounded-full ring-1 transition disabled:opacity-50 disabled:cursor-not-allowed",e?"bg-sky-500/25 ring-sky-300/70":r?"bg-slate-200 ring-slate-300":"bg-slate-800/70 ring-white/12"),"aria-checked":e,role:"switch",children:M.jsx("span",{className:Bt("inline-block h-4 w-4 transform rounded-full bg-white transition",e?"translate-x-4":"translate-x-1")})})}function to({t:i,label:e,value:t,tone:n="slate"}){const r=i._isBright??!1,o=n==="green"?r?"ring-emerald-300/70":"ring-emerald-400/25":n==="blue"?r?"ring-sky-300/70":"ring-sky-400/25":n==="yellow"?r?"ring-amber-300/70":"ring-amber-400/25":n==="red"?r?"ring-rose-300/70":"ring-rose-400/25":r?"ring-slate-200":"ring-white/12";return M.jsxs("div",{className:Bt("rounded-md ring-1 px-2.5 py-1.5 overflow-hidden",i.panelSoft,o),children:[M.jsx("div",{className:Bt("text-[10px] leading-4",i.muted),children:e}),M.jsx("div",{className:Bt("mt-0.5 font-semibold text-[12px] leading-4",i.text),children:t})]})}function n2({t:i,theme:e,x:t,y:n}){const r=Y_(t),o=Y_(n),l=r===null?50:r*100,u=o===null?50:o*100,f=i._isBright??!1,h=e==="rose"||e==="kuromi";return M.jsxs("div",{className:Bt("rounded-lg ring-1 p-2.5 overflow-hidden",i.panelSoft,f?"ring-slate-200":"ring-white/12"),children:[M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("div",{className:Bt("text-[11px]",i.muted),children:"포인터"}),M.jsxs("div",{className:Bt("text-[11px] tabular-nums",i.muted),children:[r===null?"-":r.toFixed(3)," / ",o===null?"-":o.toFixed(3)]})]}),M.jsxs("div",{className:Bt("mt-2.5 relative h-16 rounded-md ring-1 overflow-hidden",h?"bg-white ring-violet-200":f?"bg-white ring-slate-200":"bg-slate-900/35 ring-white/12"),children:[M.jsx("div",{className:"absolute inset-0 opacity-[0.18]",children:M.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,rgba(15,23,42,.08)_1px,transparent_1px),linear-gradient(to_bottom,rgba(15,23,42,.08)_1px,transparent_1px)] bg-[size:16px_16px]"})}),M.jsx("div",{className:Bt("absolute h-2 w-2 rounded-full",i.dot),style:{left:`${l}%`,top:`${u}%`,transform:"translate(-50%,-50%)"}})]})]})}function r2({onHudState:i,onHudActions:e,theme:t="dark",onChangeScreen:n}={}){const{user:r,isAuthed:o}=Wx(),l=X.useCallback(async()=>{try{const se=localStorage.getItem("accessToken")||localStorage.getItem("gos_accessToken")||localStorage.getItem("token")||null,O=(await IA(se))?.code;if(!O){window.open("http://localhost:5174","_blank","noreferrer");return}DA({code:O,webOrigin:"http://localhost:5174"})}catch{window.open("http://localhost:5174","_blank","noreferrer")}},[]),u=X.useMemo(()=>{const se=r?.id??r?.memberId??r?.member_id??r?.email??"anon";return`${o?"A":"G"}:${String(se)}`},[o,r?.id,r?.memberId,r?.member_id,r?.email]),[f,h]=X.useState(null),[m,g]=X.useState("MOUSE"),[v,S]=X.useState(!0),[_,T]=X.useState(!1),[E,w]=X.useState(""),C=Al[t]||Al.dark,[R,L]=X.useState(!1),G=X.useRef(!1),U=X.useRef(!1),k=X.useRef(null),Z=X.useRef(null),D=X.useRef(!1),[H,W]=X.useState(!1),[ne,ge]=X.useState(null),[$,ie]=X.useState({open:!1,title:"",message:""}),oe=X.useCallback(()=>{ie(se=>({...se,open:!1}))},[]),fe=X.useCallback((se,F)=>{ie({open:!0,title:se,message:F})},[]);X.useEffect(()=>{if(!$.open)return;const se=F=>{F.key==="Escape"&&oe()};return window.addEventListener("keydown",se),()=>window.removeEventListener("keydown",se)},[$.open,oe]),X.useEffect(()=>{let se=!0;return(async()=>{const F=await tm();se&&ge(F)})(),()=>{se=!1}},[]);const q=X.useMemo(()=>{const se=r?.id??r?.memberId??r?.member_id??null;if(se==null)return null;const F=String(se).trim();return/^\d+$/.test(F)?F:null},[r]),K=X.useRef(!1);X.useEffect(()=>{if(!!!f?.connected||!o||!q||K.current)return;const F=String(f?.learnProfile||"default").toLowerCase();if(!new Set(["default","mouse","keyboard","ppt","draw","vkey","rush"]).has(F)){K.current=!0;return}const ce=`u${String(q)}__main`;(async()=>{try{await xa.post(`/train/profile/set?name=${encodeURIComponent(ce)}`,null,{headers:{"X-User-Id":String(q)}})}catch{}finally{K.current=!0}})()},[f?.connected,f?.learnProfile,o,q,f]),X.useEffect(()=>{G.current=R},[R]);const V=X.useMemo(()=>{const se=f||{};return{connected:!!se.connected,enabled:!!se.enabled,locked:!!se.locked,gesture:se.gesture??se.lastGesture??"NONE",fps:se.fps??se.agentFps??null,scrollActive:!!se.scrollActive,canMove:typeof se.canMove=="boolean"?se.canMove:null,canClick:typeof se.canClick=="boolean"?se.canClick:null,mode:se.mode??m,type:se.type??"STATUS",serverPreview:typeof se.preview=="boolean"?se.preview:void 0,pointerX:typeof se.pointerX=="number"?se.pointerX:null,pointerY:typeof se.pointerY=="number"?se.pointerY:null,tracking:typeof se.tracking=="boolean"?se.tracking:typeof se.isTracking=="boolean"?se.isTracking:null,controlGain:typeof se.controlGain=="number"?se.controlGain:null,learnProfile:se.learnProfile??"default"}},[f,m]),B=X.useMemo(()=>({connText:V.connected?"연결됨":"끊김",enabledText:V.enabled?"실행 중":"정지",lockText:V.locked?"잠금":"해제",moveText:V.canMove===null?"-":V.canMove?"가능":"불가",clickText:V.canClick===null?"-":V.canClick?"가능":"불가",scrollText:V.scrollActive?"활성":"비활성",trackingText:V.tracking===null?"-":V.tracking?"ON":"OFF",modeText:X_[V.mode]??V.mode}),[V]),Y=X.useCallback(async()=>{k.current&&k.current.abort();const se=new AbortController;k.current=se;try{const{data:F}=await xa.get("/control/status",{signal:se.signal});h(F),g(O=>F?.mode??O),typeof F?.preview=="boolean"&&(L(F.preview),G.current=F.preview,U.current&&(U.current=!1)),w("")}catch(F){if(F?.name==="CanceledError"||F?.name==="AbortError")return;const O=F?.response?`상태 조회 실패 (HTTP ${F.response.status})${F.response.data?`: ${String(F.response.data)}`:""}`:F?.message||"상태 조회 실패";w(O)}finally{S(!1)}},[]),ee=X.useCallback(()=>{D.current||(Z.current&&clearTimeout(Z.current),Z.current=setTimeout(async()=>{await Y(),ee()},YA))},[Y]);X.useEffect(()=>(D.current=!1,(async()=>(await Y(),ee()))(),()=>{D.current=!0,Z.current&&clearTimeout(Z.current),k.current&&k.current.abort()}),[Y,ee]);const he=X.useCallback(async(se,F)=>{T(!0),w("");try{await xa.post(se,F??{}),await Y()}catch(O){const ce=O?.response?`요청 실패: ${se} (HTTP ${O.response.status})${O.response.data?`: ${String(O.response.data)}`:""}`:O?.message||"요청 실패";w(ce)}finally{T(!1)}},[Y]),Re=X.useCallback(async(se={source:"ui"})=>{const F=await tm();if(ge(F),F===!1)return fe("카메라 미연결","카메라를 연결하세요."),se?.source!=="chat"&&window.__GOS_CHAT_LOG__?.("system","카메라 연결 후 사용 가능"),{ok:!1,reason:"camera",message:"카메라 연결 후 사용 가능."};T(!0),w("");try{return await xa.post("/control/start",{}),await Y(),{ok:!0}}catch(O){const ce=O?.response?`요청 실패: /control/start (HTTP ${O.response.status})${O.response.data?`: ${String(O.response.data)}`:""}`:O?.message||"요청 실패";return w(ce),{ok:!1,reason:"http",message:ce}}finally{T(!1)}},[Y,fe]),Ue=X.useCallback(()=>he("/control/stop"),[he]),Fe=X.useCallback(async(se,F={source:"ui"})=>{if(U.current)return{ok:!1,reason:"busy"};const O=!!G.current,ce=typeof se=="boolean"?se:!O;if(typeof se=="boolean"&&ce===O)return{ok:!0,message:ce?"Preview는 이미 ON이야.":"Preview는 이미 OFF야."};if(ce){const Pe=await tm();if(ge(Pe),Pe===!1)return fe("카메라 미연결","카메라를 연결하세요."),F?.source!=="chat"&&window.__GOS_CHAT_LOG__?.("system","카메라 연결 후 Preview 사용 가능"),{ok:!1,reason:"camera",message:"카메라 연결 후 Preview 사용 가능."}}U.current=!0,G.current=ce,L(ce),T(!0),w("");try{return await xa.post("/control/preview",null,{params:{enabled:ce}}),await Y(),U.current=!1,{ok:!0}}catch(Pe){U.current=!1,G.current=!ce,L(!ce);const we=Pe?.response?`프리뷰 변경 실패 (HTTP ${Pe.response.status})${Pe.response.data?`: ${String(Pe.response.data)}`:""}`:Pe?.message||"프리뷰 변경 실패";return w(we),{ok:!1,reason:"http",message:we}}finally{T(!1)}},[Y,fe]),Ge=X.useCallback(async(se,F={source:"ui"})=>{g(se),T(!0),w("");try{if(!V.enabled){const O=await tm();if(ge(O),O===!1)return fe("카메라 미연결","카메라를 연결하세요."),F?.source!=="chat"&&window.__GOS_CHAT_LOG__?.("system","카메라 연결 후 모드 변경 가능"),{ok:!1,reason:"camera",message:"카메라 연결 후 모드 변경 가능."};await xa.post("/control/start")}return await xa.post("/control/mode",null,{params:{mode:se}}),await Y(),{ok:!0}}catch(O){const ce=O?.response?`모드 변경 실패 (HTTP ${O.response.status})${O.response.data?`: ${String(O.response.data)}`:""}`:O?.message||"모드 변경 실패";return w(ce),{ok:!1,reason:"http",message:ce}}finally{T(!1)}},[Y,V.enabled,fe]),qe=X.useCallback(async se=>{T(!0),w("");try{await xa.post("/control/lock",null,{params:{enabled:!!se}}),await Y()}catch(F){const O=F?.response?`잠금 변경 실패 (HTTP ${F.response.status})${F.response.data?`: ${String(F.response.data)}`:""}`:F?.message||"잠금 변경 실패";w(O)}finally{T(!1)}},[Y]),We=X.useCallback(async se=>{const F=Math.max(.2,Math.min(4,Number(se)));T(!0),w("");try{return await xa.post("/control/gain",null,{params:{gain:F}}),localStorage.setItem("gos_control_gain",String(F)),await Y(),{ok:!0,gain:F}}catch(O){const ce=O?.response?`감도 변경 실패 (HTTP ${O.response.status})${O.response.data?`: ${String(O.response.data)}`:""}`:O?.message||"감도 변경 실패";return w(ce),{ok:!1,reason:"http",message:ce}}finally{T(!1)}},[Y]);X.useEffect(()=>{e?.({start:Re,stop:Ue,applyMode:Ge,togglePreview:Fe,fetchStatus:Y,setLock:qe,setGain:We})},[e,Re,Ue,Ge,Fe,Y,qe,We]),X.useEffect(()=>{i?.({status:f,connected:V.connected,locked:V.locked,mode:V.mode,modeText:B.modeText,modeOptions:W_,cameraPresent:ne})},[i,f,V.connected,V.locked,V.mode,B.modeText,ne]);const st=X.useRef(!1),Q=X.useRef(!1),De=X.useRef(Re),Ee=X.useRef(Ue);X.useEffect(()=>{st.current=!!V.enabled},[V.enabled]),X.useEffect(()=>{Q.current=!!_},[_]),X.useEffect(()=>{De.current=Re},[Re]),X.useEffect(()=>{Ee.current=Ue},[Ue]),X.useEffect(()=>{const se=GA(),F=WA(O=>{if(!(!O||typeof O!="object")&&O.type==="EVENT"){const ce=String(O.name||"");ce==="APP_START"?!st.current&&!Q.current&&De.current?.({source:"gesture"}):ce==="APP_STOP"&&st.current&&!Q.current&&Ee.current?.()}});return()=>{F?.();try{se?.close?.()}catch{}try{XA?.()}catch{}}},[]);const ke=!_&&!V.enabled,Se=!_&&!!V.enabled,be=t==="light"||t==="rose";return M.jsxs("div",{className:Bt("w-full min-w-0 relative",C.page),children:[M.jsxs("div",{className:"relative w-full min-w-0 px-3 pt-0 pb-7 md:px-4 md:pt-3 md:pb-7 flex flex-col gap-3",children:[E?M.jsx("div",{className:Bt("rounded-lg ring-1 px-4 py-3 text-[13px]",be?"bg-rose-50 ring-rose-200 text-slate-900":"bg-rose-950/30 ring-rose-900/60 text-rose-100"),children:E}):null,M.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-3 items-start",children:[M.jsxs("div",{className:"lg:col-span-5 flex flex-col gap-3",children:[M.jsx(UA,{t:C,theme:t,currentProfile:V.learnProfile,onOpenTraining:()=>n&&n("train"),onOpenWeb:l}),M.jsx(nm,{t:C,title:"모드",accent:"blue",children:M.jsx("div",{className:"space-y-2.5",children:M.jsx("select",{value:m,onChange:se=>Ge(se.target.value),disabled:_,className:Bt("w-full rounded-lg ring-1 px-3 py-1.5 text-[13px] outline-none focus:ring-2 disabled:opacity-50",C.input,be?"focus:ring-sky-400/40":"focus:ring-sky-500/45"),children:W_.map(se=>M.jsx("option",{value:se,children:X_[se]??se},se))})})}),M.jsxs(nm,{t:C,title:"빠른 동작",accent:"green",right:_?M.jsx(_c,{t:C,tone:"blue",children:"처리 중"}):M.jsx(_c,{t:C,tone:"slate",children:"대기"}),children:[M.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[M.jsx(q_,{t:C,tone:"green",icon:M.jsx(KA,{}),title:"시작",desc:"Start",onClick:()=>Re({source:"ui"}),disabled:!ke}),M.jsx(q_,{t:C,tone:"red",icon:M.jsx(ZA,{}),title:"정지",desc:"Stop",onClick:Ue,disabled:!Se})]}),M.jsxs("div",{className:Bt("mt-2.5 rounded-lg ring-1 p-2.5 space-y-2.5",C.panelSoft),children:[M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsxs("div",{className:"flex items-center gap-2.5",children:[M.jsx("span",{className:Bt(C.text2),children:M.jsx($A,{})}),M.jsxs("div",{children:[M.jsx("div",{className:Bt("text-[13px] font-semibold leading-5",C.text),children:"프리뷰"}),M.jsx("div",{className:Bt("text-[11px]",C.muted),children:"카메라/랜드마크 미리보기"})]})]}),M.jsx("div",{className:"flex items-center gap-2",children:M.jsx(K_,{t:C,checked:R,onChange:()=>Fe(),disabled:_})})]}),M.jsx("div",{className:Bt("h-px",C.divider)}),M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsxs("div",{className:"flex items-center gap-2.5",children:[M.jsx("span",{className:Bt(C.text2),children:M.jsx(QA,{})}),M.jsxs("div",{children:[M.jsx("div",{className:Bt("text-[13px] font-semibold leading-5",C.text),children:"잠금"}),M.jsx("div",{className:Bt("text-[11px]",C.muted),children:"제스처 입력 잠금/해제"})]})]}),M.jsx(K_,{t:C,checked:V.locked,onChange:se=>qe(!!se),disabled:_})]})]}),M.jsxs(t2,{t:C,onClick:Y,disabled:_,className:"mt-2.5 flex items-center justify-center gap-2",children:[M.jsx(JA,{spinning:_}),"새로고침"]}),M.jsxs("div",{className:"mt-2.5 grid grid-cols-2 gap-2",children:[M.jsx(to,{t:C,label:"FPS",value:V0(V.fps,1),tone:"blue"}),M.jsx(to,{t:C,label:"현재 제스처",value:V.gesture,tone:"slate"})]})]})]}),M.jsxs("div",{className:"lg:col-span-7 grid gap-3 grid-rows-[auto_auto]",children:[M.jsxs(nm,{t:C,title:"상태",accent:"blue",right:v?M.jsx(_c,{t:C,tone:"yellow",children:"불러오는 중"}):M.jsx(_c,{t:C,tone:"slate",children:"라이브"}),children:[M.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2.5",children:[M.jsx(to,{t:C,label:"연결",value:B.connText,tone:V.connected?"blue":"red"}),M.jsx(to,{t:C,label:"실행",value:B.enabledText,tone:V.enabled?"green":"slate"}),M.jsx(to,{t:C,label:"잠금",value:B.lockText,tone:V.locked?"yellow":"slate"}),M.jsx(to,{t:C,label:"이동",value:B.moveText,tone:V.canMove?"green":"slate"}),M.jsx(to,{t:C,label:"클릭",value:B.clickText,tone:V.canClick?"green":"slate"}),M.jsx(to,{t:C,label:"스크롤",value:B.scrollText,tone:V.scrollActive?"blue":"slate"}),M.jsx(to,{t:C,label:"트래킹",value:B.trackingText,tone:V.tracking?"green":"slate"}),M.jsx(to,{t:C,label:"포인터 X",value:V.pointerX===null?"-":V0(V.pointerX,3),tone:"slate"}),M.jsx(to,{t:C,label:"포인터 Y",value:V.pointerY===null?"-":V0(V.pointerY,3),tone:"slate"})]}),M.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[M.jsx(n2,{t:C,theme:t,x:V.pointerX,y:V.pointerY}),M.jsxs("div",{className:Bt("rounded-lg ring-1 p-2.5",C.panelSoft),children:[M.jsx("div",{className:Bt("text-[11px]",C.muted),children:"요약"}),M.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[M.jsxs(_c,{t:C,tone:"slate",children:["제스처: ",V.gesture]}),M.jsx(_c,{t:C,tone:R?"blue":"slate",children:R?"Preview ON":"Preview OFF"}),M.jsxs(_c,{t:C,tone:"slate",children:["Mode: ",B.modeText]})]})]})]})]}),M.jsx(nm,{t:C,title:"명령 채팅창",accent:"slate",children:M.jsx("div",{className:"h-[min(38vh,280px)] flex flex-col",children:H?M.jsx("pre",{className:Bt("text-[11px] leading-relaxed overflow-auto flex-1 rounded-lg ring-1 p-3",C.panelSolid||C.panel2||C.panel,C.input),children:f?JSON.stringify(f,null,2):v?"Loading...":"No data"}):M.jsx(VA,{resetKey:u,t:C,busy:_,preview:R,derived:V,view:B,cameraPresent:ne,actions:{start:se=>Re(se??{source:"ui"}),stop:Ue,applyMode:Ge,togglePreview:Fe,fetchStatus:Y,setLock:qe,setGain:We}},u)})})]})]})]}),$.open?dh.createPortal(M.jsxs("div",{className:"fixed inset-0 z-[100000] flex items-center justify-center",style:{WebkitAppRegion:"no-drag"},onMouseDown:se=>{se.target===se.currentTarget&&oe()},children:[M.jsx("div",{className:"absolute inset-0 bg-black/45 backdrop-blur-[2px]"}),M.jsxs("div",{className:Bt("relative w-[min(500px,92vw)] rounded-lg ring-1 p-4 shadow-2xl",C.panel),children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:Bt("text-[15px] font-semibold",C.text),children:$.title}),M.jsx("div",{className:Bt("mt-2 text-[13px]",C.muted),children:$.message})]}),M.jsx("div",{className:"mt-4 flex justify-end gap-2",children:M.jsx("button",{type:"button",onClick:oe,className:Bt("px-4 py-2 rounded-lg text-[13px] font-semibold ring-1 transition",C.btn),children:"확인"})})]})]}),document.body):null]})}function i2({theme:i}){return M.jsx(ww,{theme:i,embedded:!1})}function Ml(...i){return i.filter(Boolean).join(" ")}function s2({children:i,tone:e="neutral"}){const t=e==="ok"?"bg-emerald-500/10 ring-emerald-400/25":e==="bad"?"bg-rose-500/10 ring-rose-400/25":e==="warn"?"bg-amber-500/10 ring-amber-400/25":"bg-base-100/10 ring-base-300/45";return M.jsx("span",{className:Ml("inline-flex items-center whitespace-nowrap rounded-full px-2 py-0.5 text-[11px] font-semibold ring-1","text-base-content",t),children:i})}function Qu({k:i,v:e,tone:t="neutral"}){const n=t==="ok"?"text-emerald-200":t==="bad"?"text-rose-200":t==="warn"?"text-amber-200":"text-base-content";return M.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg bg-base-100/8 ring-1 ring-base-300/40 px-3 py-2",children:[M.jsx("div",{className:"text-[11px] opacity-70 whitespace-nowrap",children:i}),M.jsx("div",{className:Ml("text-xs font-semibold whitespace-nowrap",n),children:String(e??"-")})]})}function Cw(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-80",children:M.jsx("path",{d:"M18 6 6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})}function o2(){return M.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:M.jsx("path",{d:"M13 2 3 14h8l-1 8 10-12h-8l1-8Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"})})}function a2(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),M.jsx("path",{d:"M6 11h12v10H6V11Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"})]})}function l2(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"}),M.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"1.6"})]})}function c2(){return M.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"opacity-85",children:[M.jsx("path",{d:"M12 3 2 9l10 6 10-6-10-6Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"}),M.jsx("path",{d:"M2 15l10 6 10-6",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"})]})}function rm({icon:i,label:e,tone:t="neutral",onClick:n,disabled:r}){const o="w-full rounded-lg px-3 py-2 text-sm font-semibold ring-1 transition inline-flex items-center justify-center gap-2",l=t==="primary"?"bg-primary/15 ring-primary/25 hover:bg-primary/22":t==="danger"?"bg-rose-500/12 ring-rose-400/25 hover:bg-rose-500/18":"bg-base-100/10 ring-base-300/45 hover:bg-base-100/16";return M.jsxs("button",{type:"button",onClick:n,disabled:r,className:Ml(o,l,r&&"opacity-50 pointer-events-none"),children:[i,M.jsx("span",{className:"whitespace-nowrap",children:e})]})}function u2({open:i,modes:e,currentMode:t,onPick:n,onClose:r}){return X.useEffect(()=>{if(!i)return;const o=l=>{l.key==="Escape"&&r?.()};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[i,r]),i?M.jsxs("div",{className:"fixed inset-0 z-[100000] flex items-center justify-center p-4",children:[M.jsx("div",{className:"absolute inset-0 bg-black/45 backdrop-blur-sm",onMouseDown:r}),M.jsxs("div",{className:Ml("relative w-full max-w-2xl","rounded-xl ring-1 border border-base-300/60","bg-base-200/92 text-base-content shadow-2xl","backdrop-blur-md"),onMouseDown:o=>o.stopPropagation(),children:[M.jsxs("div",{className:"px-5 py-4 border-b border-base-300/45 flex items-start justify-between gap-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:"모드 선택"}),M.jsxs("div",{className:"text-[12px] opacity-70 truncate",children:["현재 모드: ",M.jsx("span",{className:"font-semibold opacity-100",children:t})]})]}),M.jsx("button",{type:"button",onClick:r,className:"h-9 w-9 grid place-items-center rounded-lg ring-1 bg-base-100/10 ring-base-300/45 hover:bg-base-100/16",title:"닫기",children:M.jsx(Cw,{})})]}),M.jsx("div",{className:"p-5 grid grid-cols-2 gap-3",children:e.map(o=>{const l=String(t).toUpperCase()===String(o).toUpperCase();return M.jsxs("button",{type:"button",onClick:()=>n?.(o),className:Ml("rounded-lg ring-1 px-4 py-3 text-left transition",l?"bg-primary/12 ring-primary/25":"bg-base-100/8 ring-base-300/45 hover:bg-base-100/14"),children:[M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:o}),M.jsxs("div",{className:"mt-1 text-[12px] opacity-70 line-clamp-2",children:[o==="MOUSE"&&"커서/클릭/드래그/스크롤",o==="KEYBOARD"&&"키보드 입력/단축키",o==="PRESENTATION"&&"발표 제어(다음/이전 등)",o==="DRAW"&&"그리기/펜 입력",o==="DEFAULT"&&"기본(비활성/대기)",!["MOUSE","KEYBOARD","PRESENTATION","DRAW","DEFAULT"].includes(o)&&"사용자 정의 모드"]})]},o)})}),M.jsx("div",{className:"px-5 pb-5 text-[11px] opacity-60",children:"ESC로 닫기. 모드는 즉시 적용됩니다."})]})]}):null}function d2({status:i,connected:e=!0,modeOptions:t=["MOUSE","KEYBOARD","PRESENTATION","DRAW","DEFAULT"],onSetMode:n,onEnableToggle:r,onLockToggle:o,onPreviewToggle:l,onRequestHide:u}){const[f,h]=X.useState(!1),m=i??{},g=!!m.enabled,v=!!m.locked,S=(m.mode??"UNKNOWN").toString().toUpperCase(),_=(m.gesture??"NONE").toString().toUpperCase(),T=X.useMemo(()=>{const L=Number(m.fps);return Number.isFinite(L)?L.toFixed(1):"-"},[m.fps]),E=!!m.canMove,w=!!m.canClick,C=!!m.scrollActive,R=e?"ok":"bad";return M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"fixed right-4 top-14 z-[9998] pointer-events-none",children:M.jsxs("div",{className:Ml("pointer-events-auto w-[340px]","rounded-xl ring-1 border border-base-300/55","bg-base-200/78 text-base-content shadow-2xl","backdrop-blur-md"),children:[M.jsxs("div",{className:"px-4 py-3 border-b border-base-300/45 flex items-start justify-between gap-3",children:[M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:"HUD"}),M.jsx("div",{className:"text-[12px] opacity-70 truncate",children:"에이전트 상태 요약"})]}),M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsxs(s2,{tone:R,children:["HTTP ",e?"OK":"OFF"]}),M.jsx("button",{type:"button",className:"h-8 w-8 grid place-items-center rounded-lg hover:bg-base-100/12",onClick:()=>u?.(),title:"Hide HUD",children:M.jsx(Cw,{})})]})]}),M.jsx("div",{className:"px-4 pt-3",children:M.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[M.jsxs("div",{className:"rounded-lg bg-base-100/8 ring-1 ring-base-300/40 px-3 py-2",children:[M.jsx("div",{className:"text-[11px] opacity-70 whitespace-nowrap",children:"Enabled"}),M.jsx("div",{className:Ml("text-sm font-semibold whitespace-nowrap",g?"text-emerald-200":"text-rose-200"),children:g?"ON":"OFF"})]}),M.jsxs("div",{className:"rounded-lg bg-base-100/8 ring-1 ring-base-300/40 px-3 py-2",children:[M.jsx("div",{className:"text-[11px] opacity-70 whitespace-nowrap",children:"Locked"}),M.jsx("div",{className:Ml("text-sm font-semibold whitespace-nowrap",v?"text-amber-200":"text-emerald-200"),children:v?"ON":"OFF"})]}),M.jsxs("div",{className:"rounded-lg bg-base-100/8 ring-1 ring-base-300/40 px-3 py-2",children:[M.jsx("div",{className:"text-[11px] opacity-70 whitespace-nowrap",children:"FPS"}),M.jsx("div",{className:"text-sm font-semibold whitespace-nowrap",children:T})]})]})}),M.jsx("div",{className:"px-4 pt-3",children:M.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[M.jsx(Qu,{k:"Mode",v:S,tone:"neutral"}),M.jsx(Qu,{k:"Gesture",v:_,tone:"neutral"}),M.jsx(Qu,{k:"Move",v:E?"YES":"NO",tone:E?"ok":"neutral"}),M.jsx(Qu,{k:"Click",v:w?"YES":"NO",tone:w?"ok":"neutral"}),M.jsx(Qu,{k:"Scroll",v:C?"ON":"OFF",tone:C?"ok":"neutral"}),M.jsx(Qu,{k:"HTTP",v:e?"OK":"OFF",tone:R})]})}),M.jsxs("div",{className:"px-4 py-4",children:[M.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[M.jsx(rm,{icon:M.jsx(o2,{}),label:g?"Disable":"Enable",tone:g?"danger":"primary",onClick:()=>r?.(!g)}),M.jsx(rm,{icon:M.jsx(a2,{}),label:"Lock 토글",onClick:()=>o?.(!v)}),M.jsx(rm,{icon:M.jsx(c2,{}),label:"Mode 변경",tone:"primary",onClick:()=>h(!0)}),M.jsx(rm,{icon:M.jsx(l2,{}),label:"Preview 토글",onClick:()=>l?.()})]}),M.jsxs("div",{className:"mt-3 text-[11px] opacity-60 leading-relaxed",children:["문제 발생 시: ",M.jsx("span",{className:"font-semibold opacity-100",children:"HTTP / Enabled / Mode"}),"부터 확인."]})]})]})}),M.jsx(u2,{open:f,modes:t,currentMode:S,onClose:()=>h(!1),onPick:L=>{n?.(L),h(!1)}})]})}const Ag="160",f2={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h2={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Rw=0,qv=1,Pw=2,p2=3,Nw=0,Cg=1,fh=2,so=3,Pa=0,Di=1,Io=2,m2=2,Ra=0,Hc=1,Kv=2,Zv=3,Jv=4,Lw=5,wl=100,Iw=101,Dw=102,$v=103,Qv=104,kw=200,Ow=201,Uw=202,Fw=203,hg=204,pg=205,Bw=206,zw=207,Hw=208,jw=209,Vw=210,Gw=211,Ww=212,Xw=213,Yw=214,qw=0,Kw=1,Zw=2,xh=3,Jw=4,$w=5,Qw=6,eM=7,Gh=0,tM=1,nM=2,Do=0,rM=1,iM=2,sM=3,Rg=4,oM=5,aM=6,ex="attached",lM="detached",Pg=300,Na=301,Cl=302,yh=303,_h=304,Wd=306,Sh=1e3,xi=1001,wh=1002,xr=1003,mg=1004,g2=1004,hh=1005,v2=1005,yr=1006,Xx=1007,x2=1007,Rl=1008,y2=1008,ko=1009,cM=1010,uM=1011,Ng=1012,Yx=1013,Aa=1014,ao=1015,Fd=1016,qx=1017,Kx=1018,El=1020,dM=1021,Ii=1023,fM=1024,hM=1025,bl=1026,Yc=1027,pM=1028,Zx=1029,mM=1030,Jx=1031,$x=1033,rg=33776,ig=33777,sg=33778,og=33779,tx=35840,nx=35841,rx=35842,ix=35843,Qx=36196,sx=37492,ox=37496,ax=37808,lx=37809,cx=37810,ux=37811,dx=37812,fx=37813,hx=37814,px=37815,mx=37816,gx=37817,vx=37818,xx=37819,yx=37820,_x=37821,ag=36492,Sx=36494,wx=36495,gM=36283,Mx=36284,Ex=36285,bx=36286,vM=2200,xM=2201,yM=2202,Mh=2300,Eh=2301,lg=2302,kc=2400,Oc=2401,bh=2402,Lg=2500,ey=2501,_2=0,S2=1,w2=2,ty=3e3,Tl=3001,_M=3200,SM=3201,Nl=0,wM=1,gs="",Ur="srgb",Uo="srgb-linear",Ig="display-p3",Wh="display-p3-linear",Th="linear",Wn="srgb",Ah="rec709",Ch="p3",M2=0,Nc=7680,E2=7681,b2=7682,T2=7683,A2=34055,C2=34056,R2=5386,P2=512,N2=513,L2=514,I2=515,D2=516,k2=517,O2=518,Tx=519,MM=512,EM=513,bM=514,ny=515,TM=516,AM=517,CM=518,RM=519,Rh=35044,U2=35048,F2=35040,B2=35045,z2=35049,H2=35041,j2=35046,V2=35050,G2=35042,W2="100",Ax="300 es",gg=1035,lo=2e3,Bd=2001;class Ia{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let o=0,l=r.length;o<l;o++)r[o].call(this,e);e.target=null}}}const hi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Z_=1234567;const jc=Math.PI/180,zd=180/Math.PI;function vs(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(hi[i&255]+hi[i>>8&255]+hi[i>>16&255]+hi[i>>24&255]+"-"+hi[e&255]+hi[e>>8&255]+"-"+hi[e>>16&15|64]+hi[e>>24&255]+"-"+hi[t&63|128]+hi[t>>8&255]+"-"+hi[t>>16&255]+hi[t>>24&255]+hi[n&255]+hi[n>>8&255]+hi[n>>16&255]+hi[n>>24&255]).toLowerCase()}function hr(i,e,t){return Math.max(e,Math.min(t,i))}function ry(i,e){return(i%e+e)%e}function X2(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function Y2(i,e,t){return i!==e?(t-i)/(e-i):0}function ph(i,e,t){return(1-t)*i+t*e}function q2(i,e,t,n){return ph(i,e,1-Math.exp(-t*n))}function K2(i,e=1){return e-Math.abs(ry(i,e*2)-e)}function Z2(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function J2(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function $2(i,e){return i+Math.floor(Math.random()*(e-i+1))}function Q2(i,e){return i+Math.random()*(e-i)}function eC(i){return i*(.5-Math.random())}function tC(i){i!==void 0&&(Z_=i);let e=Z_+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function nC(i){return i*jc}function rC(i){return i*zd}function Cx(i){return(i&i-1)===0&&i!==0}function iC(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function vg(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function sC(i,e,t,n,r){const o=Math.cos,l=Math.sin,u=o(t/2),f=l(t/2),h=o((e+n)/2),m=l((e+n)/2),g=o((e-n)/2),v=l((e-n)/2),S=o((n-e)/2),_=l((n-e)/2);switch(r){case"XYX":i.set(u*m,f*g,f*v,u*h);break;case"YZY":i.set(f*v,u*m,f*g,u*h);break;case"ZXZ":i.set(f*g,f*v,u*m,u*h);break;case"XZX":i.set(u*m,f*_,f*S,u*h);break;case"YXY":i.set(f*S,u*m,f*_,u*h);break;case"ZYZ":i.set(f*_,f*S,u*m,u*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Qi(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function un(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Ad={DEG2RAD:jc,RAD2DEG:zd,generateUUID:vs,clamp:hr,euclideanModulo:ry,mapLinear:X2,inverseLerp:Y2,lerp:ph,damp:q2,pingpong:K2,smoothstep:Z2,smootherstep:J2,randInt:$2,randFloat:Q2,randFloatSpread:eC,seededRandom:tC,degToRad:nC,radToDeg:rC,isPowerOfTwo:Cx,ceilPowerOfTwo:iC,floorPowerOfTwo:vg,setQuaternionFromProperEuler:sC,normalize:un,denormalize:Qi};class Ve{constructor(e=0,t=0){Ve.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(hr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),o=this.x-e.x,l=this.y-e.y;return this.x=o*n-l*r+e.x,this.y=o*r+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cn{constructor(e,t,n,r,o,l,u,f,h){cn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,l,u,f,h)}set(e,t,n,r,o,l,u,f,h){const m=this.elements;return m[0]=e,m[1]=r,m[2]=u,m[3]=t,m[4]=o,m[5]=f,m[6]=n,m[7]=l,m[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,l=n[0],u=n[3],f=n[6],h=n[1],m=n[4],g=n[7],v=n[2],S=n[5],_=n[8],T=r[0],E=r[3],w=r[6],C=r[1],R=r[4],L=r[7],G=r[2],U=r[5],k=r[8];return o[0]=l*T+u*C+f*G,o[3]=l*E+u*R+f*U,o[6]=l*w+u*L+f*k,o[1]=h*T+m*C+g*G,o[4]=h*E+m*R+g*U,o[7]=h*w+m*L+g*k,o[2]=v*T+S*C+_*G,o[5]=v*E+S*R+_*U,o[8]=v*w+S*L+_*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],u=e[5],f=e[6],h=e[7],m=e[8];return t*l*m-t*u*h-n*o*m+n*u*f+r*o*h-r*l*f}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],u=e[5],f=e[6],h=e[7],m=e[8],g=m*l-u*h,v=u*f-m*o,S=h*o-l*f,_=t*g+n*v+r*S;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/_;return e[0]=g*T,e[1]=(r*h-m*n)*T,e[2]=(u*n-r*l)*T,e[3]=v*T,e[4]=(m*t-r*f)*T,e[5]=(r*o-u*t)*T,e[6]=S*T,e[7]=(n*f-h*t)*T,e[8]=(l*t-n*o)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,o,l,u){const f=Math.cos(o),h=Math.sin(o);return this.set(n*f,n*h,-n*(f*l+h*u)+l+e,-r*h,r*f,-r*(-h*l+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(G0.makeScale(e,t)),this}rotate(e){return this.premultiply(G0.makeRotation(-e)),this}translate(e,t){return this.premultiply(G0.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const G0=new cn;function PM(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const oC={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Cd(i,e){return new oC[i](e)}function Ph(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function NM(){const i=Ph("canvas");return i.style.display="block",i}const J_={};function mh(i){i in J_||(J_[i]=!0,console.warn(i))}const $_=new cn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Q_=new cn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),im={[Uo]:{transfer:Th,primaries:Ah,toReference:i=>i,fromReference:i=>i},[Ur]:{transfer:Wn,primaries:Ah,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[Wh]:{transfer:Th,primaries:Ch,toReference:i=>i.applyMatrix3(Q_),fromReference:i=>i.applyMatrix3($_)},[Ig]:{transfer:Wn,primaries:Ch,toReference:i=>i.convertSRGBToLinear().applyMatrix3(Q_),fromReference:i=>i.applyMatrix3($_).convertLinearToSRGB()}},aC=new Set([Uo,Wh]),kn={enabled:!0,_workingColorSpace:Uo,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!aC.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;const n=im[e].toReference,r=im[t].fromReference;return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return im[i].primaries},getTransfer:function(i){return i===gs?Th:im[i].transfer}};function kd(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function W0(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let ed;class iy{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ed===void 0&&(ed=Ph("canvas")),ed.width=e.width,ed.height=e.height;const n=ed.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ed}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ph("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),o=r.data;for(let l=0;l<o.length;l++)o[l]=kd(o[l]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(kd(t[n]/255)*255):t[n]=kd(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let lC=0;class Uc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:lC++}),this.uuid=vs(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let l=0,u=r.length;l<u;l++)r[l].isDataTexture?o.push(X0(r[l].image)):o.push(X0(r[l]))}else o=X0(r);n.url=o}return t||(e.images[this.uuid]=n),n}}function X0(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?iy.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let cC=0;class _r extends Ia{constructor(e=_r.DEFAULT_IMAGE,t=_r.DEFAULT_MAPPING,n=xi,r=xi,o=yr,l=Rl,u=Ii,f=ko,h=_r.DEFAULT_ANISOTROPY,m=gs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cC++}),this.uuid=vs(),this.name="",this.source=new Uc(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=l,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=f,this.offset=new Ve(0,0),this.repeat=new Ve(1,1),this.center=new Ve(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof m=="string"?this.colorSpace=m:(mh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=m===Tl?Ur:gs),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Pg)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Sh:e.x=e.x-Math.floor(e.x);break;case xi:e.x=e.x<0?0:1;break;case wh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Sh:e.y=e.y-Math.floor(e.y);break;case xi:e.y=e.y<0?0:1;break;case wh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return mh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ur?Tl:ty}set encoding(e){mh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Tl?Ur:gs}}_r.DEFAULT_IMAGE=null;_r.DEFAULT_MAPPING=Pg;_r.DEFAULT_ANISOTROPY=1;class On{constructor(e=0,t=0,n=0,r=1){On.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*r+l[12]*o,this.y=l[1]*t+l[5]*n+l[9]*r+l[13]*o,this.z=l[2]*t+l[6]*n+l[10]*r+l[14]*o,this.w=l[3]*t+l[7]*n+l[11]*r+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,o;const f=e.elements,h=f[0],m=f[4],g=f[8],v=f[1],S=f[5],_=f[9],T=f[2],E=f[6],w=f[10];if(Math.abs(m-v)<.01&&Math.abs(g-T)<.01&&Math.abs(_-E)<.01){if(Math.abs(m+v)<.1&&Math.abs(g+T)<.1&&Math.abs(_+E)<.1&&Math.abs(h+S+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(h+1)/2,L=(S+1)/2,G=(w+1)/2,U=(m+v)/4,k=(g+T)/4,Z=(_+E)/4;return R>L&&R>G?R<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(R),r=U/n,o=k/n):L>G?L<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(L),n=U/r,o=Z/r):G<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(G),n=k/o,r=Z/o),this.set(n,r,o,t),this}let C=Math.sqrt((E-_)*(E-_)+(g-T)*(g-T)+(v-m)*(v-m));return Math.abs(C)<.001&&(C=1),this.x=(E-_)/C,this.y=(g-T)/C,this.z=(v-m)/C,this.w=Math.acos((h+S+w-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class LM extends Ia{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new On(0,0,e,t),this.scissorTest=!1,this.viewport=new On(0,0,e,t);const r={width:e,height:t,depth:1};n.encoding!==void 0&&(mh("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Tl?Ur:gs),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:yr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},n),this.texture=new _r(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps,this.texture.internalFormat=n.internalFormat,this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Uc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class co extends LM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Dg extends _r{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=xr,this.minFilter=xr,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class uC extends co{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Dg(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class sy extends _r{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=xr,this.minFilter=xr,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class dC extends co{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new sy(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class fC extends co{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const o=this.texture;this.texture=[];for(let l=0;l<n;l++)this.texture[l]=o.clone(),this.texture[l].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,o=this.texture.length;r<o;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class ki{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,o,l,u){let f=n[r+0],h=n[r+1],m=n[r+2],g=n[r+3];const v=o[l+0],S=o[l+1],_=o[l+2],T=o[l+3];if(u===0){e[t+0]=f,e[t+1]=h,e[t+2]=m,e[t+3]=g;return}if(u===1){e[t+0]=v,e[t+1]=S,e[t+2]=_,e[t+3]=T;return}if(g!==T||f!==v||h!==S||m!==_){let E=1-u;const w=f*v+h*S+m*_+g*T,C=w>=0?1:-1,R=1-w*w;if(R>Number.EPSILON){const G=Math.sqrt(R),U=Math.atan2(G,w*C);E=Math.sin(E*U)/G,u=Math.sin(u*U)/G}const L=u*C;if(f=f*E+v*L,h=h*E+S*L,m=m*E+_*L,g=g*E+T*L,E===1-u){const G=1/Math.sqrt(f*f+h*h+m*m+g*g);f*=G,h*=G,m*=G,g*=G}}e[t]=f,e[t+1]=h,e[t+2]=m,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,r,o,l){const u=n[r],f=n[r+1],h=n[r+2],m=n[r+3],g=o[l],v=o[l+1],S=o[l+2],_=o[l+3];return e[t]=u*_+m*g+f*S-h*v,e[t+1]=f*_+m*v+h*g-u*S,e[t+2]=h*_+m*S+u*v-f*g,e[t+3]=m*_-u*g-f*v-h*S,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,o=e._z,l=e._order,u=Math.cos,f=Math.sin,h=u(n/2),m=u(r/2),g=u(o/2),v=f(n/2),S=f(r/2),_=f(o/2);switch(l){case"XYZ":this._x=v*m*g+h*S*_,this._y=h*S*g-v*m*_,this._z=h*m*_+v*S*g,this._w=h*m*g-v*S*_;break;case"YXZ":this._x=v*m*g+h*S*_,this._y=h*S*g-v*m*_,this._z=h*m*_-v*S*g,this._w=h*m*g+v*S*_;break;case"ZXY":this._x=v*m*g-h*S*_,this._y=h*S*g+v*m*_,this._z=h*m*_+v*S*g,this._w=h*m*g-v*S*_;break;case"ZYX":this._x=v*m*g-h*S*_,this._y=h*S*g+v*m*_,this._z=h*m*_-v*S*g,this._w=h*m*g+v*S*_;break;case"YZX":this._x=v*m*g+h*S*_,this._y=h*S*g+v*m*_,this._z=h*m*_-v*S*g,this._w=h*m*g-v*S*_;break;case"XZY":this._x=v*m*g-h*S*_,this._y=h*S*g-v*m*_,this._z=h*m*_+v*S*g,this._w=h*m*g+v*S*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],o=t[8],l=t[1],u=t[5],f=t[9],h=t[2],m=t[6],g=t[10],v=n+u+g;if(v>0){const S=.5/Math.sqrt(v+1);this._w=.25/S,this._x=(m-f)*S,this._y=(o-h)*S,this._z=(l-r)*S}else if(n>u&&n>g){const S=2*Math.sqrt(1+n-u-g);this._w=(m-f)/S,this._x=.25*S,this._y=(r+l)/S,this._z=(o+h)/S}else if(u>g){const S=2*Math.sqrt(1+u-n-g);this._w=(o-h)/S,this._x=(r+l)/S,this._y=.25*S,this._z=(f+m)/S}else{const S=2*Math.sqrt(1+g-n-u);this._w=(l-r)/S,this._x=(o+h)/S,this._y=(f+m)/S,this._z=.25*S}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(hr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,o=e._z,l=e._w,u=t._x,f=t._y,h=t._z,m=t._w;return this._x=n*m+l*u+r*h-o*f,this._y=r*m+l*f+o*u-n*h,this._z=o*m+l*h+n*f-r*u,this._w=l*m-n*u-r*f-o*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,o=this._z,l=this._w;let u=l*e._w+n*e._x+r*e._y+o*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=l,this._x=n,this._y=r,this._z=o,this;const f=1-u*u;if(f<=Number.EPSILON){const S=1-t;return this._w=S*l+t*this._w,this._x=S*n+t*this._x,this._y=S*r+t*this._y,this._z=S*o+t*this._z,this.normalize(),this}const h=Math.sqrt(f),m=Math.atan2(h,u),g=Math.sin((1-t)*m)/h,v=Math.sin(t*m)/h;return this._w=l*g+this._w*v,this._x=n*g+this._x*v,this._y=r*g+this._y*v,this._z=o*g+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(o),n*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,n=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(e1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(e1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=e.elements,l=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*l,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*l,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*l,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,o=e.x,l=e.y,u=e.z,f=e.w,h=2*(l*r-u*n),m=2*(u*t-o*r),g=2*(o*n-l*t);return this.x=t+f*h+l*g-u*m,this.y=n+f*m+u*h-o*g,this.z=r+f*g+o*m-l*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,o=e.z,l=t.x,u=t.y,f=t.z;return this.x=r*f-o*u,this.y=o*l-n*f,this.z=n*u-r*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Y0.copy(this).projectOnVector(e),this.sub(Y0)}reflect(e){return this.sub(Y0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(hr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Y0=new J,e1=new ki;class Oi{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(no.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(no.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=no.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const o=n.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let l=0,u=o.count;l<u;l++)e.isMesh===!0?e.getVertexPosition(l,no):no.fromBufferAttribute(o,l),no.applyMatrix4(e.matrixWorld),this.expandByPoint(no);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),sm.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),sm.copy(n.boundingBox)),sm.applyMatrix4(e.matrixWorld),this.union(sm)}const r=e.children;for(let o=0,l=r.length;o<l;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,no),no.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qf),om.subVectors(this.max,qf),td.subVectors(e.a,qf),nd.subVectors(e.b,qf),rd.subVectors(e.c,qf),hl.subVectors(nd,td),pl.subVectors(rd,nd),Sc.subVectors(td,rd);let t=[0,-hl.z,hl.y,0,-pl.z,pl.y,0,-Sc.z,Sc.y,hl.z,0,-hl.x,pl.z,0,-pl.x,Sc.z,0,-Sc.x,-hl.y,hl.x,0,-pl.y,pl.x,0,-Sc.y,Sc.x,0];return!q0(t,td,nd,rd,om)||(t=[1,0,0,0,1,0,0,0,1],!q0(t,td,nd,rd,om))?!1:(am.crossVectors(hl,pl),t=[am.x,am.y,am.z],q0(t,td,nd,rd,om))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,no).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(no).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ya[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ya[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ya[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ya[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ya[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ya[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ya[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ya[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ya),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ya=[new J,new J,new J,new J,new J,new J,new J,new J],no=new J,sm=new Oi,td=new J,nd=new J,rd=new J,hl=new J,pl=new J,Sc=new J,qf=new J,om=new J,am=new J,wc=new J;function q0(i,e,t,n,r){for(let o=0,l=i.length-3;o<=l;o+=3){wc.fromArray(i,o);const u=r.x*Math.abs(wc.x)+r.y*Math.abs(wc.y)+r.z*Math.abs(wc.z),f=e.dot(wc),h=t.dot(wc),m=n.dot(wc);if(Math.max(-Math.max(f,h,m),Math.min(f,h,m))>u)return!1}return!0}const hC=new Oi,Kf=new J,K0=new J;class yi{constructor(e=new J,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):hC.setFromPoints(e).getCenter(n);let r=0;for(let o=0,l=e.length;o<l;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Kf.subVectors(e,this.center);const t=Kf.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Kf,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(K0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Kf.copy(e.center).add(K0)),this.expandByPoint(Kf.copy(e.center).sub(K0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _a=new J,Z0=new J,lm=new J,ml=new J,J0=new J,cm=new J,$0=new J;class Xd{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_a)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=_a.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(_a.copy(this.origin).addScaledVector(this.direction,t),_a.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Z0.copy(e).add(t).multiplyScalar(.5),lm.copy(t).sub(e).normalize(),ml.copy(this.origin).sub(Z0);const o=e.distanceTo(t)*.5,l=-this.direction.dot(lm),u=ml.dot(this.direction),f=-ml.dot(lm),h=ml.lengthSq(),m=Math.abs(1-l*l);let g,v,S,_;if(m>0)if(g=l*f-u,v=l*u-f,_=o*m,g>=0)if(v>=-_)if(v<=_){const T=1/m;g*=T,v*=T,S=g*(g+l*v+2*u)+v*(l*g+v+2*f)+h}else v=o,g=Math.max(0,-(l*v+u)),S=-g*g+v*(v+2*f)+h;else v=-o,g=Math.max(0,-(l*v+u)),S=-g*g+v*(v+2*f)+h;else v<=-_?(g=Math.max(0,-(-l*o+u)),v=g>0?-o:Math.min(Math.max(-o,-f),o),S=-g*g+v*(v+2*f)+h):v<=_?(g=0,v=Math.min(Math.max(-o,-f),o),S=v*(v+2*f)+h):(g=Math.max(0,-(l*o+u)),v=g>0?o:Math.min(Math.max(-o,-f),o),S=-g*g+v*(v+2*f)+h);else v=l>0?-o:o,g=Math.max(0,-(l*v+u)),S=-g*g+v*(v+2*f)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,g),r&&r.copy(Z0).addScaledVector(lm,v),S}intersectSphere(e,t){_a.subVectors(e.center,this.origin);const n=_a.dot(this.direction),r=_a.dot(_a)-n*n,o=e.radius*e.radius;if(r>o)return null;const l=Math.sqrt(o-r),u=n-l,f=n+l;return f<0?null:u<0?this.at(f,t):this.at(u,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,o,l,u,f;const h=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,v=this.origin;return h>=0?(n=(e.min.x-v.x)*h,r=(e.max.x-v.x)*h):(n=(e.max.x-v.x)*h,r=(e.min.x-v.x)*h),m>=0?(o=(e.min.y-v.y)*m,l=(e.max.y-v.y)*m):(o=(e.max.y-v.y)*m,l=(e.min.y-v.y)*m),n>l||o>r||((o>n||isNaN(n))&&(n=o),(l<r||isNaN(r))&&(r=l),g>=0?(u=(e.min.z-v.z)*g,f=(e.max.z-v.z)*g):(u=(e.max.z-v.z)*g,f=(e.min.z-v.z)*g),n>f||u>r)||((u>n||n!==n)&&(n=u),(f<r||r!==r)&&(r=f),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,_a)!==null}intersectTriangle(e,t,n,r,o){J0.subVectors(t,e),cm.subVectors(n,e),$0.crossVectors(J0,cm);let l=this.direction.dot($0),u;if(l>0){if(r)return null;u=1}else if(l<0)u=-1,l=-l;else return null;ml.subVectors(this.origin,e);const f=u*this.direction.dot(cm.crossVectors(ml,cm));if(f<0)return null;const h=u*this.direction.dot(J0.cross(ml));if(h<0||f+h>l)return null;const m=-u*ml.dot($0);return m<0?null:this.at(m/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Kt{constructor(e,t,n,r,o,l,u,f,h,m,g,v,S,_,T,E){Kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,l,u,f,h,m,g,v,S,_,T,E)}set(e,t,n,r,o,l,u,f,h,m,g,v,S,_,T,E){const w=this.elements;return w[0]=e,w[4]=t,w[8]=n,w[12]=r,w[1]=o,w[5]=l,w[9]=u,w[13]=f,w[2]=h,w[6]=m,w[10]=g,w[14]=v,w[3]=S,w[7]=_,w[11]=T,w[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Kt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/id.setFromMatrixColumn(e,0).length(),o=1/id.setFromMatrixColumn(e,1).length(),l=1/id.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,o=e.z,l=Math.cos(n),u=Math.sin(n),f=Math.cos(r),h=Math.sin(r),m=Math.cos(o),g=Math.sin(o);if(e.order==="XYZ"){const v=l*m,S=l*g,_=u*m,T=u*g;t[0]=f*m,t[4]=-f*g,t[8]=h,t[1]=S+_*h,t[5]=v-T*h,t[9]=-u*f,t[2]=T-v*h,t[6]=_+S*h,t[10]=l*f}else if(e.order==="YXZ"){const v=f*m,S=f*g,_=h*m,T=h*g;t[0]=v+T*u,t[4]=_*u-S,t[8]=l*h,t[1]=l*g,t[5]=l*m,t[9]=-u,t[2]=S*u-_,t[6]=T+v*u,t[10]=l*f}else if(e.order==="ZXY"){const v=f*m,S=f*g,_=h*m,T=h*g;t[0]=v-T*u,t[4]=-l*g,t[8]=_+S*u,t[1]=S+_*u,t[5]=l*m,t[9]=T-v*u,t[2]=-l*h,t[6]=u,t[10]=l*f}else if(e.order==="ZYX"){const v=l*m,S=l*g,_=u*m,T=u*g;t[0]=f*m,t[4]=_*h-S,t[8]=v*h+T,t[1]=f*g,t[5]=T*h+v,t[9]=S*h-_,t[2]=-h,t[6]=u*f,t[10]=l*f}else if(e.order==="YZX"){const v=l*f,S=l*h,_=u*f,T=u*h;t[0]=f*m,t[4]=T-v*g,t[8]=_*g+S,t[1]=g,t[5]=l*m,t[9]=-u*m,t[2]=-h*m,t[6]=S*g+_,t[10]=v-T*g}else if(e.order==="XZY"){const v=l*f,S=l*h,_=u*f,T=u*h;t[0]=f*m,t[4]=-g,t[8]=h*m,t[1]=v*g+T,t[5]=l*m,t[9]=S*g-_,t[2]=_*g-S,t[6]=u*m,t[10]=T*g+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pC,e,mC)}lookAt(e,t,n){const r=this.elements;return hs.subVectors(e,t),hs.lengthSq()===0&&(hs.z=1),hs.normalize(),gl.crossVectors(n,hs),gl.lengthSq()===0&&(Math.abs(n.z)===1?hs.x+=1e-4:hs.z+=1e-4,hs.normalize(),gl.crossVectors(n,hs)),gl.normalize(),um.crossVectors(hs,gl),r[0]=gl.x,r[4]=um.x,r[8]=hs.x,r[1]=gl.y,r[5]=um.y,r[9]=hs.y,r[2]=gl.z,r[6]=um.z,r[10]=hs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,l=n[0],u=n[4],f=n[8],h=n[12],m=n[1],g=n[5],v=n[9],S=n[13],_=n[2],T=n[6],E=n[10],w=n[14],C=n[3],R=n[7],L=n[11],G=n[15],U=r[0],k=r[4],Z=r[8],D=r[12],H=r[1],W=r[5],ne=r[9],ge=r[13],$=r[2],ie=r[6],oe=r[10],fe=r[14],q=r[3],K=r[7],V=r[11],B=r[15];return o[0]=l*U+u*H+f*$+h*q,o[4]=l*k+u*W+f*ie+h*K,o[8]=l*Z+u*ne+f*oe+h*V,o[12]=l*D+u*ge+f*fe+h*B,o[1]=m*U+g*H+v*$+S*q,o[5]=m*k+g*W+v*ie+S*K,o[9]=m*Z+g*ne+v*oe+S*V,o[13]=m*D+g*ge+v*fe+S*B,o[2]=_*U+T*H+E*$+w*q,o[6]=_*k+T*W+E*ie+w*K,o[10]=_*Z+T*ne+E*oe+w*V,o[14]=_*D+T*ge+E*fe+w*B,o[3]=C*U+R*H+L*$+G*q,o[7]=C*k+R*W+L*ie+G*K,o[11]=C*Z+R*ne+L*oe+G*V,o[15]=C*D+R*ge+L*fe+G*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],o=e[12],l=e[1],u=e[5],f=e[9],h=e[13],m=e[2],g=e[6],v=e[10],S=e[14],_=e[3],T=e[7],E=e[11],w=e[15];return _*(+o*f*g-r*h*g-o*u*v+n*h*v+r*u*S-n*f*S)+T*(+t*f*S-t*h*v+o*l*v-r*l*S+r*h*m-o*f*m)+E*(+t*h*g-t*u*S-o*l*g+n*l*S+o*u*m-n*h*m)+w*(-r*u*m-t*f*g+t*u*v+r*l*g-n*l*v+n*f*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],u=e[5],f=e[6],h=e[7],m=e[8],g=e[9],v=e[10],S=e[11],_=e[12],T=e[13],E=e[14],w=e[15],C=g*E*h-T*v*h+T*f*S-u*E*S-g*f*w+u*v*w,R=_*v*h-m*E*h-_*f*S+l*E*S+m*f*w-l*v*w,L=m*T*h-_*g*h+_*u*S-l*T*S-m*u*w+l*g*w,G=_*g*f-m*T*f-_*u*v+l*T*v+m*u*E-l*g*E,U=t*C+n*R+r*L+o*G;if(U===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/U;return e[0]=C*k,e[1]=(T*v*o-g*E*o-T*r*S+n*E*S+g*r*w-n*v*w)*k,e[2]=(u*E*o-T*f*o+T*r*h-n*E*h-u*r*w+n*f*w)*k,e[3]=(g*f*o-u*v*o-g*r*h+n*v*h+u*r*S-n*f*S)*k,e[4]=R*k,e[5]=(m*E*o-_*v*o+_*r*S-t*E*S-m*r*w+t*v*w)*k,e[6]=(_*f*o-l*E*o-_*r*h+t*E*h+l*r*w-t*f*w)*k,e[7]=(l*v*o-m*f*o+m*r*h-t*v*h-l*r*S+t*f*S)*k,e[8]=L*k,e[9]=(_*g*o-m*T*o-_*n*S+t*T*S+m*n*w-t*g*w)*k,e[10]=(l*T*o-_*u*o+_*n*h-t*T*h-l*n*w+t*u*w)*k,e[11]=(m*u*o-l*g*o-m*n*h+t*g*h+l*n*S-t*u*S)*k,e[12]=G*k,e[13]=(m*T*r-_*g*r+_*n*v-t*T*v-m*n*E+t*g*E)*k,e[14]=(_*u*r-l*T*r-_*n*f+t*T*f+l*n*E-t*u*E)*k,e[15]=(l*g*r-m*u*r+m*n*f-t*g*f-l*n*v+t*u*v)*k,this}scale(e){const t=this.elements,n=e.x,r=e.y,o=e.z;return t[0]*=n,t[4]*=r,t[8]*=o,t[1]*=n,t[5]*=r,t[9]*=o,t[2]*=n,t[6]*=r,t[10]*=o,t[3]*=n,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),o=1-n,l=e.x,u=e.y,f=e.z,h=o*l,m=o*u;return this.set(h*l+n,h*u-r*f,h*f+r*u,0,h*u+r*f,m*u+n,m*f-r*l,0,h*f-r*u,m*f+r*l,o*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,o,l){return this.set(1,n,o,0,e,1,l,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,o=t._x,l=t._y,u=t._z,f=t._w,h=o+o,m=l+l,g=u+u,v=o*h,S=o*m,_=o*g,T=l*m,E=l*g,w=u*g,C=f*h,R=f*m,L=f*g,G=n.x,U=n.y,k=n.z;return r[0]=(1-(T+w))*G,r[1]=(S+L)*G,r[2]=(_-R)*G,r[3]=0,r[4]=(S-L)*U,r[5]=(1-(v+w))*U,r[6]=(E+C)*U,r[7]=0,r[8]=(_+R)*k,r[9]=(E-C)*k,r[10]=(1-(v+T))*k,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let o=id.set(r[0],r[1],r[2]).length();const l=id.set(r[4],r[5],r[6]).length(),u=id.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],ro.copy(this);const h=1/o,m=1/l,g=1/u;return ro.elements[0]*=h,ro.elements[1]*=h,ro.elements[2]*=h,ro.elements[4]*=m,ro.elements[5]*=m,ro.elements[6]*=m,ro.elements[8]*=g,ro.elements[9]*=g,ro.elements[10]*=g,t.setFromRotationMatrix(ro),n.x=o,n.y=l,n.z=u,this}makePerspective(e,t,n,r,o,l,u=lo){const f=this.elements,h=2*o/(t-e),m=2*o/(n-r),g=(t+e)/(t-e),v=(n+r)/(n-r);let S,_;if(u===lo)S=-(l+o)/(l-o),_=-2*l*o/(l-o);else if(u===Bd)S=-l/(l-o),_=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return f[0]=h,f[4]=0,f[8]=g,f[12]=0,f[1]=0,f[5]=m,f[9]=v,f[13]=0,f[2]=0,f[6]=0,f[10]=S,f[14]=_,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,t,n,r,o,l,u=lo){const f=this.elements,h=1/(t-e),m=1/(n-r),g=1/(l-o),v=(t+e)*h,S=(n+r)*m;let _,T;if(u===lo)_=(l+o)*g,T=-2*g;else if(u===Bd)_=o*g,T=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return f[0]=2*h,f[4]=0,f[8]=0,f[12]=-v,f[1]=0,f[5]=2*m,f[9]=0,f[13]=-S,f[2]=0,f[6]=0,f[10]=T,f[14]=-_,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const id=new J,ro=new Kt,pC=new J(0,0,0),mC=new J(1,1,1),gl=new J,um=new J,hs=new J,t1=new Kt,n1=new ki;class Yd{constructor(e=0,t=0,n=0,r=Yd.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,o=r[0],l=r[4],u=r[8],f=r[1],h=r[5],m=r[9],g=r[2],v=r[6],S=r[10];switch(t){case"XYZ":this._y=Math.asin(hr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,S),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(v,h),this._z=0);break;case"YXZ":this._x=Math.asin(-hr(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(u,S),this._z=Math.atan2(f,h)):(this._y=Math.atan2(-g,o),this._z=0);break;case"ZXY":this._x=Math.asin(hr(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-g,S),this._z=Math.atan2(-l,h)):(this._y=0,this._z=Math.atan2(f,o));break;case"ZYX":this._y=Math.asin(-hr(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(v,S),this._z=Math.atan2(f,o)):(this._x=0,this._z=Math.atan2(-l,h));break;case"YZX":this._z=Math.asin(hr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,h),this._y=Math.atan2(-g,o)):(this._x=0,this._y=Math.atan2(u,S));break;case"XZY":this._z=Math.asin(-hr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(v,h),this._y=Math.atan2(u,o)):(this._x=Math.atan2(-m,S),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return t1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t1,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return n1.setFromEuler(this),this.setFromQuaternion(n1,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Yd.DEFAULT_ORDER="XYZ";class Vc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let gC=0;const r1=new J,sd=new ki,Sa=new Kt,dm=new J,Zf=new J,vC=new J,xC=new ki,i1=new J(1,0,0),s1=new J(0,1,0),o1=new J(0,0,1),yC={type:"added"},_C={type:"removed"};class Cn extends Ia{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gC++}),this.uuid=vs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Cn.DEFAULT_UP.clone();const e=new J,t=new Yd,n=new ki,r=new J(1,1,1);function o(){n.setFromEuler(t,!1)}function l(){t.setFromQuaternion(n,void 0,!1)}t._onChange(o),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Kt},normalMatrix:{value:new cn}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=Cn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Cn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Vc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.multiply(sd),this}rotateOnWorldAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.premultiply(sd),this}rotateX(e){return this.rotateOnAxis(i1,e)}rotateY(e){return this.rotateOnAxis(s1,e)}rotateZ(e){return this.rotateOnAxis(o1,e)}translateOnAxis(e,t){return r1.copy(e).applyQuaternion(this.quaternion),this.position.add(r1.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(i1,e)}translateY(e){return this.translateOnAxis(s1,e)}translateZ(e){return this.translateOnAxis(o1,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Sa.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?dm.copy(e):dm.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Zf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Sa.lookAt(Zf,dm,this.up):Sa.lookAt(dm,Zf,this.up),this.quaternion.setFromRotationMatrix(Sa),r&&(Sa.extractRotation(r.matrixWorld),sd.setFromRotationMatrix(Sa),this.quaternion.premultiply(sd.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(yC)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(_C)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Sa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Sa.multiply(e.parent.matrixWorld)),e.applyMatrix4(Sa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const l=this.children[n].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let o=0,l=r.length;o<l;o++)r[o].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zf,e,vC),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zf,xC,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const o=t[n];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let o=0,l=r.length;o<l;o++){const u=r[o];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function o(u,f){return u[f.uuid]===void 0&&(u[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const f=u.shapes;if(Array.isArray(f))for(let h=0,m=f.length;h<m;h++){const g=f[h];o(e.shapes,g)}else o(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let f=0,h=this.material.length;f<h;f++)u.push(o(e.materials,this.material[f]));r.material=u}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let u=0;u<this.animations.length;u++){const f=this.animations[u];r.animations.push(o(e.animations,f))}}if(t){const u=l(e.geometries),f=l(e.materials),h=l(e.textures),m=l(e.images),g=l(e.shapes),v=l(e.skeletons),S=l(e.animations),_=l(e.nodes);u.length>0&&(n.geometries=u),f.length>0&&(n.materials=f),h.length>0&&(n.textures=h),m.length>0&&(n.images=m),g.length>0&&(n.shapes=g),v.length>0&&(n.skeletons=v),S.length>0&&(n.animations=S),_.length>0&&(n.nodes=_)}return n.object=r,n;function l(u){const f=[];for(const h in u){const m=u[h];delete m.metadata,f.push(m)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Cn.DEFAULT_UP=new J(0,1,0);Cn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Cn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const io=new J,wa=new J,Q0=new J,Ma=new J,od=new J,ad=new J,a1=new J,ev=new J,tv=new J,nv=new J;let fm=!1;class $i{constructor(e=new J,t=new J,n=new J){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),io.subVectors(e,t),r.cross(io);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,n,r,o){io.subVectors(r,t),wa.subVectors(n,t),Q0.subVectors(e,t);const l=io.dot(io),u=io.dot(wa),f=io.dot(Q0),h=wa.dot(wa),m=wa.dot(Q0),g=l*h-u*u;if(g===0)return o.set(0,0,0),null;const v=1/g,S=(h*f-u*m)*v,_=(l*m-u*f)*v;return o.set(1-S-_,_,S)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ma)===null?!1:Ma.x>=0&&Ma.y>=0&&Ma.x+Ma.y<=1}static getUV(e,t,n,r,o,l,u,f){return fm===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),fm=!0),this.getInterpolation(e,t,n,r,o,l,u,f)}static getInterpolation(e,t,n,r,o,l,u,f){return this.getBarycoord(e,t,n,r,Ma)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(o,Ma.x),f.addScaledVector(l,Ma.y),f.addScaledVector(u,Ma.z),f)}static isFrontFacing(e,t,n,r){return io.subVectors(n,t),wa.subVectors(e,t),io.cross(wa).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return io.subVectors(this.c,this.b),wa.subVectors(this.a,this.b),io.cross(wa).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return $i.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,o){return fm===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),fm=!0),$i.getInterpolation(e,this.a,this.b,this.c,t,n,r,o)}getInterpolation(e,t,n,r,o){return $i.getInterpolation(e,this.a,this.b,this.c,t,n,r,o)}containsPoint(e){return $i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,o=this.c;let l,u;od.subVectors(r,n),ad.subVectors(o,n),ev.subVectors(e,n);const f=od.dot(ev),h=ad.dot(ev);if(f<=0&&h<=0)return t.copy(n);tv.subVectors(e,r);const m=od.dot(tv),g=ad.dot(tv);if(m>=0&&g<=m)return t.copy(r);const v=f*g-m*h;if(v<=0&&f>=0&&m<=0)return l=f/(f-m),t.copy(n).addScaledVector(od,l);nv.subVectors(e,o);const S=od.dot(nv),_=ad.dot(nv);if(_>=0&&S<=_)return t.copy(o);const T=S*h-f*_;if(T<=0&&h>=0&&_<=0)return u=h/(h-_),t.copy(n).addScaledVector(ad,u);const E=m*_-S*g;if(E<=0&&g-m>=0&&S-_>=0)return a1.subVectors(o,r),u=(g-m)/(g-m+(S-_)),t.copy(r).addScaledVector(a1,u);const w=1/(E+T+v);return l=T*w,u=v*w,t.copy(n).addScaledVector(od,l).addScaledVector(ad,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const IM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vl={h:0,s:0,l:0},hm={h:0,s:0,l:0};function rv(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class ht{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ur){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,kn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=kn.workingColorSpace){return this.r=e,this.g=t,this.b=n,kn.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=kn.workingColorSpace){if(e=ry(e,1),t=hr(t,0,1),n=hr(n,0,1),t===0)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+t):n+t-n*t,l=2*n-o;this.r=rv(l,o,e+1/3),this.g=rv(l,o,e),this.b=rv(l,o,e-1/3)}return kn.toWorkingColorSpace(this,r),this}setStyle(e,t=Ur){function n(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const l=r[1],u=r[2];switch(l){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],l=o.length;if(l===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(l===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ur){const n=IM[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=kd(e.r),this.g=kd(e.g),this.b=kd(e.b),this}copyLinearToSRGB(e){return this.r=W0(e.r),this.g=W0(e.g),this.b=W0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ur){return kn.fromWorkingColorSpace(pi.copy(this),e),Math.round(hr(pi.r*255,0,255))*65536+Math.round(hr(pi.g*255,0,255))*256+Math.round(hr(pi.b*255,0,255))}getHexString(e=Ur){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=kn.workingColorSpace){kn.fromWorkingColorSpace(pi.copy(this),t);const n=pi.r,r=pi.g,o=pi.b,l=Math.max(n,r,o),u=Math.min(n,r,o);let f,h;const m=(u+l)/2;if(u===l)f=0,h=0;else{const g=l-u;switch(h=m<=.5?g/(l+u):g/(2-l-u),l){case n:f=(r-o)/g+(r<o?6:0);break;case r:f=(o-n)/g+2;break;case o:f=(n-r)/g+4;break}f/=6}return e.h=f,e.s=h,e.l=m,e}getRGB(e,t=kn.workingColorSpace){return kn.fromWorkingColorSpace(pi.copy(this),t),e.r=pi.r,e.g=pi.g,e.b=pi.b,e}getStyle(e=Ur){kn.fromWorkingColorSpace(pi.copy(this),e);const t=pi.r,n=pi.g,r=pi.b;return e!==Ur?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(vl),this.setHSL(vl.h+e,vl.s+t,vl.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(vl),e.getHSL(hm);const n=ph(vl.h,hm.h,t),r=ph(vl.s,hm.s,t),o=ph(vl.l,hm.l,t);return this.setHSL(n,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*n+o[6]*r,this.g=o[1]*t+o[4]*n+o[7]*r,this.b=o[2]*t+o[5]*n+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const pi=new ht;ht.NAMES=IM;let SC=0;class _i extends Ia{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:SC++}),this.uuid=vs(),this.name="",this.type="Material",this.blending=Hc,this.side=Pa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=hg,this.blendDst=pg,this.blendEquation=wl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ht(0,0,0),this.blendAlpha=0,this.depthFunc=xh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Tx,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nc,this.stencilZFail=Nc,this.stencilZPass=Nc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Hc&&(n.blending=this.blending),this.side!==Pa&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==hg&&(n.blendSrc=this.blendSrc),this.blendDst!==pg&&(n.blendDst=this.blendDst),this.blendEquation!==wl&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==xh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Tx&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Nc&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Nc&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Nc&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(o){const l=[];for(const u in o){const f=o[u];delete f.metadata,l.push(f)}return l}if(t){const o=r(e.textures),l=r(e.images);o.length>0&&(n.textures=o),l.length>0&&(n.images=l)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ns extends _i{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ta=wC();function wC(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let f=0;f<256;++f){const h=f-127;h<-27?(n[f]=0,n[f|256]=32768,r[f]=24,r[f|256]=24):h<-14?(n[f]=1024>>-h-14,n[f|256]=1024>>-h-14|32768,r[f]=-h-1,r[f|256]=-h-1):h<=15?(n[f]=h+15<<10,n[f|256]=h+15<<10|32768,r[f]=13,r[f|256]=13):h<128?(n[f]=31744,n[f|256]=64512,r[f]=24,r[f|256]=24):(n[f]=31744,n[f|256]=64512,r[f]=13,r[f|256]=13)}const o=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64);for(let f=1;f<1024;++f){let h=f<<13,m=0;for(;(h&8388608)===0;)h<<=1,m-=8388608;h&=-8388609,m+=947912704,o[f]=h|m}for(let f=1024;f<2048;++f)o[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)l[f]=f<<23;l[31]=1199570944,l[32]=2147483648;for(let f=33;f<63;++f)l[f]=2147483648+(f-32<<23);l[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(u[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:o,exponentTable:l,offsetTable:u}}function Zi(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=hr(i,-65504,65504),Ta.floatView[0]=i;const e=Ta.uint32View[0],t=e>>23&511;return Ta.baseTable[t]+((e&8388607)>>Ta.shiftTable[t])}function uh(i){const e=i>>10;return Ta.uint32View[0]=Ta.mantissaTable[Ta.offsetTable[e]+(i&1023)]+Ta.exponentTable[e],Ta.floatView[0]}const MC={toHalfFloat:Zi,fromHalfFloat:uh},Ar=new J,pm=new Ve;class Un{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Rh,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ao,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)pm.fromBufferAttribute(this,t),pm.applyMatrix3(e),this.setXY(t,pm.x,pm.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Ar.fromBufferAttribute(this,t),Ar.applyMatrix3(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Ar.fromBufferAttribute(this,t),Ar.applyMatrix4(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ar.fromBufferAttribute(this,t),Ar.applyNormalMatrix(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ar.fromBufferAttribute(this,t),Ar.transformDirection(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Qi(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=un(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qi(t,this.array)),t}setX(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qi(t,this.array)),t}setY(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qi(t,this.array)),t}setW(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array),r=un(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array),r=un(r,this.array),o=un(o,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Rh&&(e.usage=this.usage),e}}class EC extends Un{constructor(e,t,n){super(new Int8Array(e),t,n)}}class bC extends Un{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class TC extends Un{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class AC extends Un{constructor(e,t,n){super(new Int16Array(e),t,n)}}class oy extends Un{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class CC extends Un{constructor(e,t,n){super(new Int32Array(e),t,n)}}class ay extends Un{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class RC extends Un{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=uh(this.array[e*this.itemSize]);return this.normalized&&(t=Qi(t,this.array)),t}setX(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize]=Zi(t),this}getY(e){let t=uh(this.array[e*this.itemSize+1]);return this.normalized&&(t=Qi(t,this.array)),t}setY(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+1]=Zi(t),this}getZ(e){let t=uh(this.array[e*this.itemSize+2]);return this.normalized&&(t=Qi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+2]=Zi(t),this}getW(e){let t=uh(this.array[e*this.itemSize+3]);return this.normalized&&(t=Qi(t,this.array)),t}setW(e,t){return this.normalized&&(t=un(t,this.array)),this.array[e*this.itemSize+3]=Zi(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array)),this.array[e+0]=Zi(t),this.array[e+1]=Zi(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array),r=un(r,this.array)),this.array[e+0]=Zi(t),this.array[e+1]=Zi(n),this.array[e+2]=Zi(r),this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=un(t,this.array),n=un(n,this.array),r=un(r,this.array),o=un(o,this.array)),this.array[e+0]=Zi(t),this.array[e+1]=Zi(n),this.array[e+2]=Zi(r),this.array[e+3]=Zi(o),this}}class Nt extends Un{constructor(e,t,n){super(new Float32Array(e),t,n)}}class PC extends Un{constructor(e,t,n){super(new Float64Array(e),t,n)}}let NC=0;const Rs=new Kt,iv=new Cn,ld=new J,ps=new Oi,Jf=new Oi,Yr=new J;class fn extends Ia{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:NC++}),this.uuid=vs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(PM(e)?ay:oy)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new cn().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rs.makeRotationFromQuaternion(e),this.applyMatrix4(Rs),this}rotateX(e){return Rs.makeRotationX(e),this.applyMatrix4(Rs),this}rotateY(e){return Rs.makeRotationY(e),this.applyMatrix4(Rs),this}rotateZ(e){return Rs.makeRotationZ(e),this.applyMatrix4(Rs),this}translate(e,t,n){return Rs.makeTranslation(e,t,n),this.applyMatrix4(Rs),this}scale(e,t,n){return Rs.makeScale(e,t,n),this.applyMatrix4(Rs),this}lookAt(e){return iv.lookAt(e),iv.updateMatrix(),this.applyMatrix4(iv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ld).negate(),this.translate(ld.x,ld.y,ld.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Nt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Oi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const o=t[n];ps.setFromBufferAttribute(o),this.morphTargetsRelative?(Yr.addVectors(this.boundingBox.min,ps.min),this.boundingBox.expandByPoint(Yr),Yr.addVectors(this.boundingBox.max,ps.max),this.boundingBox.expandByPoint(Yr)):(this.boundingBox.expandByPoint(ps.min),this.boundingBox.expandByPoint(ps.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new yi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new J,1/0);return}if(e){const n=this.boundingSphere.center;if(ps.setFromBufferAttribute(e),t)for(let o=0,l=t.length;o<l;o++){const u=t[o];Jf.setFromBufferAttribute(u),this.morphTargetsRelative?(Yr.addVectors(ps.min,Jf.min),ps.expandByPoint(Yr),Yr.addVectors(ps.max,Jf.max),ps.expandByPoint(Yr)):(ps.expandByPoint(Jf.min),ps.expandByPoint(Jf.max))}ps.getCenter(n);let r=0;for(let o=0,l=e.count;o<l;o++)Yr.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(Yr));if(t)for(let o=0,l=t.length;o<l;o++){const u=t[o],f=this.morphTargetsRelative;for(let h=0,m=u.count;h<m;h++)Yr.fromBufferAttribute(u,h),f&&(ld.fromBufferAttribute(e,h),Yr.add(ld)),r=Math.max(r,n.distanceToSquared(Yr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=t.position.array,o=t.normal.array,l=t.uv.array,u=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Un(new Float32Array(4*u),4));const f=this.getAttribute("tangent").array,h=[],m=[];for(let H=0;H<u;H++)h[H]=new J,m[H]=new J;const g=new J,v=new J,S=new J,_=new Ve,T=new Ve,E=new Ve,w=new J,C=new J;function R(H,W,ne){g.fromArray(r,H*3),v.fromArray(r,W*3),S.fromArray(r,ne*3),_.fromArray(l,H*2),T.fromArray(l,W*2),E.fromArray(l,ne*2),v.sub(g),S.sub(g),T.sub(_),E.sub(_);const ge=1/(T.x*E.y-E.x*T.y);isFinite(ge)&&(w.copy(v).multiplyScalar(E.y).addScaledVector(S,-T.y).multiplyScalar(ge),C.copy(S).multiplyScalar(T.x).addScaledVector(v,-E.x).multiplyScalar(ge),h[H].add(w),h[W].add(w),h[ne].add(w),m[H].add(C),m[W].add(C),m[ne].add(C))}let L=this.groups;L.length===0&&(L=[{start:0,count:n.length}]);for(let H=0,W=L.length;H<W;++H){const ne=L[H],ge=ne.start,$=ne.count;for(let ie=ge,oe=ge+$;ie<oe;ie+=3)R(n[ie+0],n[ie+1],n[ie+2])}const G=new J,U=new J,k=new J,Z=new J;function D(H){k.fromArray(o,H*3),Z.copy(k);const W=h[H];G.copy(W),G.sub(k.multiplyScalar(k.dot(W))).normalize(),U.crossVectors(Z,W);const ge=U.dot(m[H])<0?-1:1;f[H*4]=G.x,f[H*4+1]=G.y,f[H*4+2]=G.z,f[H*4+3]=ge}for(let H=0,W=L.length;H<W;++H){const ne=L[H],ge=ne.start,$=ne.count;for(let ie=ge,oe=ge+$;ie<oe;ie+=3)D(n[ie+0]),D(n[ie+1]),D(n[ie+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Un(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let v=0,S=n.count;v<S;v++)n.setXYZ(v,0,0,0);const r=new J,o=new J,l=new J,u=new J,f=new J,h=new J,m=new J,g=new J;if(e)for(let v=0,S=e.count;v<S;v+=3){const _=e.getX(v+0),T=e.getX(v+1),E=e.getX(v+2);r.fromBufferAttribute(t,_),o.fromBufferAttribute(t,T),l.fromBufferAttribute(t,E),m.subVectors(l,o),g.subVectors(r,o),m.cross(g),u.fromBufferAttribute(n,_),f.fromBufferAttribute(n,T),h.fromBufferAttribute(n,E),u.add(m),f.add(m),h.add(m),n.setXYZ(_,u.x,u.y,u.z),n.setXYZ(T,f.x,f.y,f.z),n.setXYZ(E,h.x,h.y,h.z)}else for(let v=0,S=t.count;v<S;v+=3)r.fromBufferAttribute(t,v+0),o.fromBufferAttribute(t,v+1),l.fromBufferAttribute(t,v+2),m.subVectors(l,o),g.subVectors(r,o),m.cross(g),n.setXYZ(v+0,m.x,m.y,m.z),n.setXYZ(v+1,m.x,m.y,m.z),n.setXYZ(v+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Yr.fromBufferAttribute(e,t),Yr.normalize(),e.setXYZ(t,Yr.x,Yr.y,Yr.z)}toNonIndexed(){function e(u,f){const h=u.array,m=u.itemSize,g=u.normalized,v=new h.constructor(f.length*m);let S=0,_=0;for(let T=0,E=f.length;T<E;T++){u.isInterleavedBufferAttribute?S=f[T]*u.data.stride+u.offset:S=f[T]*m;for(let w=0;w<m;w++)v[_++]=h[S++]}return new Un(v,m,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new fn,n=this.index.array,r=this.attributes;for(const u in r){const f=r[u],h=e(f,n);t.setAttribute(u,h)}const o=this.morphAttributes;for(const u in o){const f=[],h=o[u];for(let m=0,g=h.length;m<g;m++){const v=h[m],S=e(v,n);f.push(S)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,f=l.length;u<f;u++){const h=l[u];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const h in f)f[h]!==void 0&&(e[h]=f[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const h=n[f];e.data.attributes[f]=h.toJSON(e.data)}const r={};let o=!1;for(const f in this.morphAttributes){const h=this.morphAttributes[f],m=[];for(let g=0,v=h.length;g<v;g++){const S=h[g];m.push(S.toJSON(e.data))}m.length>0&&(r[f]=m,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const h in r){const m=r[h];this.setAttribute(h,m.clone(t))}const o=e.morphAttributes;for(const h in o){const m=[],g=o[h];for(let v=0,S=g.length;v<S;v++)m.push(g[v].clone(t));this.morphAttributes[h]=m}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let h=0,m=l.length;h<m;h++){const g=l[h];this.addGroup(g.start,g.count,g.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const l1=new Kt,Mc=new Xd,mm=new yi,c1=new J,cd=new J,ud=new J,dd=new J,sv=new J,gm=new J,vm=new Ve,xm=new Ve,ym=new Ve,u1=new J,d1=new J,f1=new J,_m=new J,Sm=new J;class Fr extends Cn{constructor(e=new fn,t=new Ns){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const u=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=o}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,o=n.morphAttributes.position,l=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const u=this.morphTargetInfluences;if(o&&u){gm.set(0,0,0);for(let f=0,h=o.length;f<h;f++){const m=u[f],g=o[f];m!==0&&(sv.fromBufferAttribute(g,e),l?gm.addScaledVector(sv,m):gm.addScaledVector(sv.sub(t),m))}t.add(gm)}return t}raycast(e,t){const n=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),mm.copy(n.boundingSphere),mm.applyMatrix4(o),Mc.copy(e.ray).recast(e.near),!(mm.containsPoint(Mc.origin)===!1&&(Mc.intersectSphere(mm,c1)===null||Mc.origin.distanceToSquared(c1)>(e.far-e.near)**2))&&(l1.copy(o).invert(),Mc.copy(e.ray).applyMatrix4(l1),!(n.boundingBox!==null&&Mc.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Mc)))}_computeIntersections(e,t,n){let r;const o=this.geometry,l=this.material,u=o.index,f=o.attributes.position,h=o.attributes.uv,m=o.attributes.uv1,g=o.attributes.normal,v=o.groups,S=o.drawRange;if(u!==null)if(Array.isArray(l))for(let _=0,T=v.length;_<T;_++){const E=v[_],w=l[E.materialIndex],C=Math.max(E.start,S.start),R=Math.min(u.count,Math.min(E.start+E.count,S.start+S.count));for(let L=C,G=R;L<G;L+=3){const U=u.getX(L),k=u.getX(L+1),Z=u.getX(L+2);r=wm(this,w,e,n,h,m,g,U,k,Z),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=E.materialIndex,t.push(r))}}else{const _=Math.max(0,S.start),T=Math.min(u.count,S.start+S.count);for(let E=_,w=T;E<w;E+=3){const C=u.getX(E),R=u.getX(E+1),L=u.getX(E+2);r=wm(this,l,e,n,h,m,g,C,R,L),r&&(r.faceIndex=Math.floor(E/3),t.push(r))}}else if(f!==void 0)if(Array.isArray(l))for(let _=0,T=v.length;_<T;_++){const E=v[_],w=l[E.materialIndex],C=Math.max(E.start,S.start),R=Math.min(f.count,Math.min(E.start+E.count,S.start+S.count));for(let L=C,G=R;L<G;L+=3){const U=L,k=L+1,Z=L+2;r=wm(this,w,e,n,h,m,g,U,k,Z),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=E.materialIndex,t.push(r))}}else{const _=Math.max(0,S.start),T=Math.min(f.count,S.start+S.count);for(let E=_,w=T;E<w;E+=3){const C=E,R=E+1,L=E+2;r=wm(this,l,e,n,h,m,g,C,R,L),r&&(r.faceIndex=Math.floor(E/3),t.push(r))}}}}function LC(i,e,t,n,r,o,l,u){let f;if(e.side===Di?f=n.intersectTriangle(l,o,r,!0,u):f=n.intersectTriangle(r,o,l,e.side===Pa,u),f===null)return null;Sm.copy(u),Sm.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(Sm);return h<t.near||h>t.far?null:{distance:h,point:Sm.clone(),object:i}}function wm(i,e,t,n,r,o,l,u,f,h){i.getVertexPosition(u,cd),i.getVertexPosition(f,ud),i.getVertexPosition(h,dd);const m=LC(i,e,t,n,cd,ud,dd,_m);if(m){r&&(vm.fromBufferAttribute(r,u),xm.fromBufferAttribute(r,f),ym.fromBufferAttribute(r,h),m.uv=$i.getInterpolation(_m,cd,ud,dd,vm,xm,ym,new Ve)),o&&(vm.fromBufferAttribute(o,u),xm.fromBufferAttribute(o,f),ym.fromBufferAttribute(o,h),m.uv1=$i.getInterpolation(_m,cd,ud,dd,vm,xm,ym,new Ve),m.uv2=m.uv1),l&&(u1.fromBufferAttribute(l,u),d1.fromBufferAttribute(l,f),f1.fromBufferAttribute(l,h),m.normal=$i.getInterpolation(_m,cd,ud,dd,u1,d1,f1,new J),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const g={a:u,b:f,c:h,normal:new J,materialIndex:0};$i.getNormal(cd,ud,dd,g.normal),m.face=g}return m}class Jc extends fn{constructor(e=1,t=1,n=1,r=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:o,depthSegments:l};const u=this;r=Math.floor(r),o=Math.floor(o),l=Math.floor(l);const f=[],h=[],m=[],g=[];let v=0,S=0;_("z","y","x",-1,-1,n,t,e,l,o,0),_("z","y","x",1,-1,n,t,-e,l,o,1),_("x","z","y",1,1,e,n,t,r,l,2),_("x","z","y",1,-1,e,n,-t,r,l,3),_("x","y","z",1,-1,e,t,n,r,o,4),_("x","y","z",-1,-1,e,t,-n,r,o,5),this.setIndex(f),this.setAttribute("position",new Nt(h,3)),this.setAttribute("normal",new Nt(m,3)),this.setAttribute("uv",new Nt(g,2));function _(T,E,w,C,R,L,G,U,k,Z,D){const H=L/k,W=G/Z,ne=L/2,ge=G/2,$=U/2,ie=k+1,oe=Z+1;let fe=0,q=0;const K=new J;for(let V=0;V<oe;V++){const B=V*W-ge;for(let Y=0;Y<ie;Y++){const ee=Y*H-ne;K[T]=ee*C,K[E]=B*R,K[w]=$,h.push(K.x,K.y,K.z),K[T]=0,K[E]=0,K[w]=U>0?1:-1,m.push(K.x,K.y,K.z),g.push(Y/k),g.push(1-V/Z),fe+=1}}for(let V=0;V<Z;V++)for(let B=0;B<k;B++){const Y=v+B+ie*V,ee=v+B+ie*(V+1),he=v+(B+1)+ie*(V+1),Re=v+(B+1)+ie*V;f.push(Y,ee,Re),f.push(ee,he,Re),q+=6}u.addGroup(S,q,D),S+=q,v+=fe}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hd(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Li(i){const e={};for(let t=0;t<i.length;t++){const n=Hd(i[t]);for(const r in n)e[r]=n[r]}return e}function IC(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function DM(i){return i.getRenderTarget()===null?i.outputColorSpace:kn.workingColorSpace}const kM={clone:Hd,merge:Li};var DC=`void main() {
C:\puh\puh\manager\GestureOSManager\front\dist\assets\index-BOxduUqw.js:3713:`)+c.join(" > ")}return null},t.getPublicRootInstance=function(c){return c=c.current,c.child?c.child.tag===5?oe(c.child.stateNode):c.child.stateNode:null},t.injectIntoDevTools=function(c){if(c={bundleType:c.bundleType,version:c.version,rendererPackageName:c.rendererPackageName,rendererConfig:c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Xu,findFiberByHostInstance:c.findFiberByHostInstance||Ap,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)c=!0;else{try{Ol=d.inject(c),_s=d}catch{}c=!!d.checkDCE}}return c},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(c,d,x,b){if(!O)throw Error(l(363));c=Xs(c,d);var P=ot(c,x,b).disconnect;return{disconnect:function(){P()}}},t.registerMutableSourceForHydration=function(c,d){var x=d._getVersion;x=x(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,x]:c.mutableSourceEagerHydrationData.push(d,x)},t.runWithPriority=function(c,d){var x=an;try{return an=c,d()}finally{an=x}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(c,d,x,b){var P=d.current,I=Mn(),te=us(P);return x=bp(x),d.context===null?d.context=x:d.pendingContext=x,d=Ds(I,te),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),vo(P,d),c=Vr(P,te,I),c!==null&&cu(c,P,te),te},t}),Nv}var NS;function hD(){return NS||(NS=1,Cv.exports=fD()),Cv.exports}var pD=hD();const mD=ZS(pD);var LS=zE();const Dy={},gD=i=>{Object.assign(Dy,i)};function vD(i,e){function t(m,{args:g=[],attach:v,...S},_){let T=`${m[0].toUpperCase()}${m.slice(1)}`,E;if(m==="primitive"){if(S.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const w=S.object;E=Ed(w,{type:m,root:_,attach:v,primitive:!0})}else{const w=Dy[T];if(!w)throw new Error(`R3F: ${T} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(g))throw new Error("R3F: The args prop must be an array!");E=Ed(new w(...g),{type:m,root:_,attach:v,memoizedProps:{args:g}})}return E.__r3f.attach===void 0&&(E.isBufferGeometry?E.__r3f.attach="geometry":E.isMaterial&&(E.__r3f.attach="material")),T!=="inject"&&Dv(E,S),E}function n(m,g){let v=!1;if(g){var S,_;(S=g.__r3f)!=null&&S.attach?Iv(m,g,g.__r3f.attach):g.isObject3D&&m.isObject3D&&(m.add(g),v=!0),v||(_=m.__r3f)==null||_.objects.push(g),g.__r3f||Ed(g,{}),g.__r3f.parent=m,Fx(g),bd(g)}}function r(m,g,v){let S=!1;if(g){var _,T;if((_=g.__r3f)!=null&&_.attach)Iv(m,g,g.__r3f.attach);else if(g.isObject3D&&m.isObject3D){g.parent=m,g.dispatchEvent({type:"added"}),m.dispatchEvent({type:"childadded",child:g});const E=m.children.filter(C=>C!==g),w=E.indexOf(v);m.children=[...E.slice(0,w),g,...E.slice(w)],S=!0}S||(T=m.__r3f)==null||T.objects.push(g),g.__r3f||Ed(g,{}),g.__r3f.parent=m,Fx(g),bd(g)}}function o(m,g,v=!1){m&&[...m].forEach(S=>l(g,S,v))}function l(m,g,v){if(g){var S,_,T;if(g.__r3f&&(g.__r3f.parent=null),(S=m.__r3f)!=null&&S.objects&&(m.__r3f.objects=m.__r3f.objects.filter(L=>L!==g)),(_=g.__r3f)!=null&&_.attach)US(m,g,g.__r3f.attach);else if(g.isObject3D&&m.isObject3D){var E;m.remove(g),(E=g.__r3f)!=null&&E.root&&ED(ug(g),g)}const C=(T=g.__r3f)==null?void 0:T.primitive,R=!C&&(v===void 0?g.dispose!==null:v);if(!C){var w;o((w=g.__r3f)==null?void 0:w.objects,g,R),o(g.children,g,R)}if(delete g.__r3f,R&&g.dispose&&g.type!=="Scene"){const L=()=>{try{g.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?LS.unstable_scheduleCallback(LS.unstable_IdlePriority,L):L()}bd(m)}}function u(m,g,v,S){var _;const T=(_=m.__r3f)==null?void 0:_.parent;if(!T)return;const E=t(g,v,m.__r3f.root);if(m.children){for(const w of m.children)w.__r3f&&n(E,w);m.children=m.children.filter(w=>!w.__r3f)}m.__r3f.objects.forEach(w=>n(E,w)),m.__r3f.objects=[],m.__r3f.autoRemovedBeforeAppend||l(T,m),E.parent&&(E.__r3f.autoRemovedBeforeAppend=!0),n(T,E),E.raycast&&E.__r3f.eventCount&&ug(E).getState().internal.interaction.push(E),[S,S.alternate].forEach(w=>{w!==null&&(w.stateNode=E,w.ref&&(typeof w.ref=="function"?w.ref(E):w.ref.current=E))})}const f=()=>{};return{reconciler:mD({createInstance:t,removeChild:l,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(m,g)=>{if(!g)return;const v=m.getState().scene;v.__r3f&&(v.__r3f.root=m,n(v,g))},removeChildFromContainer:(m,g)=>{g&&l(m.getState().scene,g)},insertInContainerBefore:(m,g,v)=>{if(!g||!v)return;const S=m.getState().scene;S.__r3f&&r(S,g,v)},getRootHostContext:()=>null,getChildHostContext:m=>m,finalizeInitialChildren(m){var g;return!!((g=m?.__r3f)!=null?g:{}).handlers},prepareUpdate(m,g,v,S){var _;if(((_=m?.__r3f)!=null?_:{}).primitive&&S.object&&S.object!==m)return[!0];{const{args:E=[],children:w,...C}=S,{args:R=[],children:L,...G}=v;if(!Array.isArray(E))throw new Error("R3F: the args prop must be an array!");if(E.some((k,Z)=>k!==R[Z]))return[!0];const U=YE(m,C,G,!0);return U.changes.length?[!1,U]:null}},commitUpdate(m,[g,v],S,_,T,E){g?u(m,S,T,E):Dv(m,v)},commitMount(m,g,v,S){var _;const T=(_=m.__r3f)!=null?_:{};m.raycast&&T.handlers&&T.eventCount&&ug(m).getState().internal.interaction.push(m)},getPublicInstance:m=>m,prepareForCommit:()=>null,preparePortalMount:m=>Ed(m.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(m){var g;const{attach:v,parent:S}=(g=m.__r3f)!=null?g:{};v&&S&&US(S,m,v),m.isObject3D&&(m.visible=!1),bd(m)},unhideInstance(m,g){var v;const{attach:S,parent:_}=(v=m.__r3f)!=null?v:{};S&&_&&Iv(_,m,S),(m.isObject3D&&g.visible==null||g.visible)&&(m.visible=!0),bd(m)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>e?e():Id.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&$n.fun(performance.now)?performance.now:$n.fun(Date.now)?Date.now:()=>0,scheduleTimeout:$n.fun(setTimeout)?setTimeout:void 0,cancelTimeout:$n.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Dv}}var IS,DS;const Lv=i=>"colorSpace"in i||"outputColorSpace"in i,HE=()=>{var i;return(i=Dy.ColorManagement)!=null?i:null},jE=i=>i&&i.isOrthographicCamera,xD=i=>i&&i.hasOwnProperty("current"),tp=typeof window<"u"&&((IS=window.document)!=null&&IS.createElement||((DS=window.navigator)==null?void 0:DS.product)==="ReactNative")?X.useLayoutEffect:X.useEffect;function VE(i){const e=X.useRef(i);return tp(()=>{e.current=i},[i]),e}function yD({set:i}){return tp(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}class GE extends X.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}GE.getDerivedStateFromError=()=>({error:!0});const WE="__default",kS=new Map,_D=i=>i&&!!i.memoized&&!!i.changes;function XE(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}const sh=i=>{var e;return(e=i.__r3f)==null?void 0:e.root.getState()};function ug(i){let e=i.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const $n={obj:i=>i===Object(i)&&!$n.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if($n.str(i)||$n.num(i)||$n.boo(i))return i===e;const o=$n.obj(i);if(o&&n==="reference")return i===e;const l=$n.arr(i);if(l&&t==="reference")return i===e;if((l||o)&&i===e)return!0;let u;for(u in i)if(!(u in e))return!1;if(o&&t==="shallow"&&n==="shallow"){for(u in r?e:i)if(!$n.equ(i[u],e[u],{strict:r,objects:"reference"}))return!1}else for(u in r?e:i)if(i[u]!==e[u])return!1;if($n.und(u)){if(l&&i.length===0&&e.length===0||o&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function SD(i){i.dispose&&i.type!=="Scene"&&i.dispose();for(const e in i)e.dispose==null||e.dispose(),delete i[e]}function Ed(i,e){const t=i;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},i}function Ux(i,e){let t=i;if(e.includes("-")){const n=e.split("-"),r=n.pop();return t=n.reduce((o,l)=>o[l],i),{target:t,key:r}}else return{target:t,key:e}}const OS=/-\d+$/;function Iv(i,e,t){if($n.str(t)){if(OS.test(t)){const o=t.replace(OS,""),{target:l,key:u}=Ux(i,o);Array.isArray(l[u])||(l[u]=[])}const{target:n,key:r}=Ux(i,t);e.__r3f.previousAttach=n[r],n[r]=e}else e.__r3f.previousAttach=t(i,e)}function US(i,e,t){var n,r;if($n.str(t)){const{target:o,key:l}=Ux(i,t),u=e.__r3f.previousAttach;u===void 0?delete o[l]:o[l]=u}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(i,e);(r=e.__r3f)==null||delete r.previousAttach}function YE(i,{children:e,key:t,ref:n,...r},{children:o,key:l,ref:u,...f}={},h=!1){const m=i.__r3f,g=Object.entries(r),v=[];if(h){const _=Object.keys(f);for(let T=0;T<_.length;T++)r.hasOwnProperty(_[T])||g.unshift([_[T],WE+"remove"])}g.forEach(([_,T])=>{var E;if((E=i.__r3f)!=null&&E.primitive&&_==="object"||$n.equ(T,f[_]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(_))return v.push([_,T,!0,[]]);let w=[];_.includes("-")&&(w=_.split("-")),v.push([_,T,!1,w]);for(const C in r){const R=r[C];C.startsWith(`${_}-`)&&v.push([C,R,!1,C.split("-")])}});const S={...r};return m!=null&&m.memoizedProps&&m!=null&&m.memoizedProps.args&&(S.args=m.memoizedProps.args),m!=null&&m.memoizedProps&&m!=null&&m.memoizedProps.attach&&(S.attach=m.memoizedProps.attach),{memoized:S,changes:v}}function Dv(i,e){var t;const n=i.__r3f,r=n?.root,o=r==null||r.getState==null?void 0:r.getState(),{memoized:l,changes:u}=_D(e)?e:YE(i,e),f=n?.eventCount;i.__r3f&&(i.__r3f.memoizedProps=l);for(let v=0;v<u.length;v++){let[S,_,T,E]=u[v];if(Lv(i)){const L="srgb",G="srgb-linear";S==="encoding"?(S="colorSpace",_=_===3001?L:G):S==="outputEncoding"&&(S="outputColorSpace",_=_===3001?L:G)}let w=i,C=w[S];if(E.length&&(C=E.reduce((R,L)=>R[L],i),!(C&&C.set))){const[R,...L]=E.reverse();w=L.reverse().reduce((G,U)=>G[U],i),S=R}if(_===WE+"remove")if(w.constructor){let R=kS.get(w.constructor);R||(R=new w.constructor,kS.set(w.constructor,R)),_=R[S]}else _=0;if(T&&n)_?n.handlers[S]=_:delete n.handlers[S],n.eventCount=Object.keys(n.handlers).length;else if(C&&C.set&&(C.copy||C instanceof Vc)){if(Array.isArray(_))C.fromArray?C.fromArray(_):C.set(..._);else if(C.copy&&_&&_.constructor&&C.constructor===_.constructor)C.copy(_);else if(_!==void 0){var h;const R=(h=C)==null?void 0:h.isColor;!R&&C.setScalar?C.setScalar(_):C instanceof Vc&&_ instanceof Vc?C.mask=_.mask:C.set(_),!HE()&&o&&!o.linear&&R&&C.convertSRGBToLinear()}}else{var m;if(w[S]=_,(m=w[S])!=null&&m.isTexture&&w[S].format===Ii&&w[S].type===ko&&o){const R=w[S];Lv(R)&&Lv(o.gl)?R.colorSpace=o.gl.outputColorSpace:R.encoding=o.gl.outputEncoding}}bd(i)}if(n&&n.parent&&i.raycast&&f!==n.eventCount){const v=ug(i).getState().internal,S=v.interaction.indexOf(i);S>-1&&v.interaction.splice(S,1),n.eventCount&&v.interaction.push(i)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(t=i.__r3f)!=null&&t.parent&&Fx(i),i}function bd(i){var e,t;const n=(e=i.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Fx(i){i.onUpdate==null||i.onUpdate(i)}function wD(i,e){i.manual||(jE(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function Zm(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function MD(){var i;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Id.DefaultEventPriority;switch((i=e.event)==null?void 0:i.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Id.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Id.ContinuousEventPriority;default:return Id.DefaultEventPriority}}function qE(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function ED(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{qE(t.capturedMap,e,n,r)})}function bD(i){function e(f){const{internal:h}=i.getState(),m=f.offsetX-h.initialClick[0],g=f.offsetY-h.initialClick[1];return Math.round(Math.sqrt(m*m+g*g))}function t(f){return f.filter(h=>["Move","Over","Enter","Out","Leave"].some(m=>{var g;return(g=h.__r3f)==null?void 0:g.handlers["onPointer"+m]}))}function n(f,h){const m=i.getState(),g=new Set,v=[],S=h?h(m.internal.interaction):m.internal.interaction;for(let w=0;w<S.length;w++){const C=sh(S[w]);C&&(C.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(f,m);function _(w){const C=sh(w);if(!C||!C.events.enabled||C.raycaster.camera===null)return[];if(C.raycaster.camera===void 0){var R;C.events.compute==null||C.events.compute(f,C,(R=C.previousRoot)==null?void 0:R.getState()),C.raycaster.camera===void 0&&(C.raycaster.camera=null)}return C.raycaster.camera?C.raycaster.intersectObject(w,!0):[]}let T=S.flatMap(_).sort((w,C)=>{const R=sh(w.object),L=sh(C.object);return!R||!L?w.distance-C.distance:L.events.priority-R.events.priority||w.distance-C.distance}).filter(w=>{const C=Zm(w);return g.has(C)?!1:(g.add(C),!0)});m.events.filter&&(T=m.events.filter(T,m));for(const w of T){let C=w.object;for(;C;){var E;(E=C.__r3f)!=null&&E.eventCount&&v.push({...w,eventObject:C}),C=C.parent}}if("pointerId"in f&&m.internal.capturedMap.has(f.pointerId))for(let w of m.internal.capturedMap.get(f.pointerId).values())g.has(Zm(w.intersection))||v.push(w.intersection);return v}function r(f,h,m,g){const v=i.getState();if(f.length){const S={stopped:!1};for(const _ of f){const T=sh(_.object)||v,{raycaster:E,pointer:w,camera:C,internal:R}=T,L=new J(w.x,w.y,0).unproject(C),G=H=>{var W,ne;return(W=(ne=R.capturedMap.get(H))==null?void 0:ne.has(_.eventObject))!=null?W:!1},U=H=>{const W={intersection:_,target:h.target};R.capturedMap.has(H)?R.capturedMap.get(H).set(_.eventObject,W):R.capturedMap.set(H,new Map([[_.eventObject,W]])),h.target.setPointerCapture(H)},k=H=>{const W=R.capturedMap.get(H);W&&qE(R.capturedMap,_.eventObject,W,H)};let Z={};for(let H in h){let W=h[H];typeof W!="function"&&(Z[H]=W)}let D={..._,...Z,pointer:w,intersections:f,stopped:S.stopped,delta:m,unprojectedPoint:L,ray:E.ray,camera:C,stopPropagation(){const H="pointerId"in h&&R.capturedMap.get(h.pointerId);if((!H||H.has(_.eventObject))&&(D.stopped=S.stopped=!0,R.hovered.size&&Array.from(R.hovered.values()).find(W=>W.eventObject===_.eventObject))){const W=f.slice(0,f.indexOf(_));o([...W,_])}},target:{hasPointerCapture:G,setPointerCapture:U,releasePointerCapture:k},currentTarget:{hasPointerCapture:G,setPointerCapture:U,releasePointerCapture:k},nativeEvent:h};if(g(D),S.stopped===!0)break}}return f}function o(f){const{internal:h}=i.getState();for(const m of h.hovered.values())if(!f.length||!f.find(g=>g.object===m.object&&g.index===m.index&&g.instanceId===m.instanceId)){const v=m.eventObject.__r3f,S=v?.handlers;if(h.hovered.delete(Zm(m)),v!=null&&v.eventCount){const _={...m,intersections:f};S.onPointerOut==null||S.onPointerOut(_),S.onPointerLeave==null||S.onPointerLeave(_)}}}function l(f,h){for(let m=0;m<h.length;m++){const g=h[m].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return h=>{const{internal:m}=i.getState();"pointerId"in h&&m.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(h.pointerId)&&(m.capturedMap.delete(h.pointerId),o([]))})}}return function(m){const{onPointerMissed:g,internal:v}=i.getState();v.lastEvent.current=m;const S=f==="onPointerMove",_=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",E=n(m,S?t:void 0),w=_?e(m):0;f==="onPointerDown"&&(v.initialClick=[m.offsetX,m.offsetY],v.initialHits=E.map(R=>R.eventObject)),_&&!E.length&&w<=2&&(l(m,v.interaction),g&&g(m)),S&&o(E);function C(R){const L=R.eventObject,G=L.__r3f,U=G?.handlers;if(G!=null&&G.eventCount)if(S){if(U.onPointerOver||U.onPointerEnter||U.onPointerOut||U.onPointerLeave){const k=Zm(R),Z=v.hovered.get(k);Z?Z.stopped&&R.stopPropagation():(v.hovered.set(k,R),U.onPointerOver==null||U.onPointerOver(R),U.onPointerEnter==null||U.onPointerEnter(R))}U.onPointerMove==null||U.onPointerMove(R)}else{const k=U[f];k?(!_||v.initialHits.includes(L))&&(l(m,v.interaction.filter(Z=>!v.initialHits.includes(Z))),k(R)):_&&v.initialHits.includes(L)&&l(m,v.interaction.filter(Z=>!v.initialHits.includes(Z)))}}r(E,m,w,C)}}return{handlePointer:u}}const KE=i=>!!(i!=null&&i.render),ZE=X.createContext(null),TD=(i,e)=>{const t=uD((u,f)=>{const h=new J,m=new J,g=new J;function v(w=f().camera,C=m,R=f().size){const{width:L,height:G,top:U,left:k}=R,Z=L/G;C.isVector3?g.copy(C):g.set(...C);const D=w.getWorldPosition(h).distanceTo(g);if(jE(w))return{width:L/w.zoom,height:G/w.zoom,top:U,left:k,factor:1,distance:D,aspect:Z};{const H=w.fov*Math.PI/180,W=2*Math.tan(H/2)*D,ne=W*(L/G);return{width:ne,height:W,top:U,left:k,factor:L/ne,distance:D,aspect:Z}}}let S;const _=w=>u(C=>({performance:{...C.performance,current:w}})),T=new Ve;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(w=1)=>i(f(),w),advance:(w,C)=>e(w,C,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Ry,pointer:T,mouse:T,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const w=f();S&&clearTimeout(S),w.performance.current!==w.performance.min&&_(w.performance.min),S=setTimeout(()=>_(f().performance.max),w.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:w=>u(C=>({...C,events:{...C.events,...w}})),setSize:(w,C,R,L,G)=>{const U=f().camera,k={width:w,height:C,top:L||0,left:G||0,updateStyle:R};u(Z=>({size:k,viewport:{...Z.viewport,...v(U,m,k)}}))},setDpr:w=>u(C=>{const R=XE(w);return{viewport:{...C.viewport,dpr:R,initialDpr:C.viewport.initialDpr||R}}}),setFrameloop:(w="always")=>{const C=f().clock;C.stop(),C.elapsedTime=0,w!=="never"&&(C.start(),C.elapsedTime=0),u(()=>({frameloop:w}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:X.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(w,C,R)=>{const L=f().internal;return L.priority=L.priority+(C>0?1:0),L.subscribers.push({ref:w,priority:C,store:R}),L.subscribers=L.subscribers.sort((G,U)=>G.priority-U.priority),()=>{const G=f().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(C>0?1:0),G.subscribers=G.subscribers.filter(U=>U.ref!==w))}}}}}),n=t.getState();let r=n.size,o=n.viewport.dpr,l=n.camera;return t.subscribe(()=>{const{camera:u,size:f,viewport:h,gl:m,set:g}=t.getState();if(f.width!==r.width||f.height!==r.height||h.dpr!==o){var v;r=f,o=h.dpr,wD(u,f),m.setPixelRatio(h.dpr);const S=(v=f.updateStyle)!=null?v:typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(f.width,f.height,S)}u!==l&&(l=u,g(S=>({viewport:{...S.viewport,...S.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>i(u)),t};let Jm,AD=new Set,CD=new Set,RD=new Set;function kv(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function oh(i,e){switch(i){case"before":return kv(AD,e);case"after":return kv(CD,e);case"tail":return kv(RD,e)}}let Ov,Uv;function Fv(i,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),Ov=e.internal.subscribers,Jm=0;Jm<Ov.length;Jm++)Uv=Ov[Jm],Uv.ref.current(Uv.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function PD(i){let e=!1,t=!1,n,r,o;function l(h){r=requestAnimationFrame(l),e=!0,n=0,oh("before",h),t=!0;for(const g of i.values()){var m;o=g.store.getState(),o.internal.active&&(o.frameloop==="always"||o.internal.frames>0)&&!((m=o.gl.xr)!=null&&m.isPresenting)&&(n+=Fv(h,o))}if(t=!1,oh("after",h),n===0)return oh("tail",h),e=!1,cancelAnimationFrame(r)}function u(h,m=1){var g;if(!h)return i.forEach(v=>u(v.store.getState(),m));(g=h.gl.xr)!=null&&g.isPresenting||!h.internal.active||h.frameloop==="never"||(m>1?h.internal.frames=Math.min(60,h.internal.frames+m):t?h.internal.frames=2:h.internal.frames=1,e||(e=!0,requestAnimationFrame(l)))}function f(h,m=!0,g,v){if(m&&oh("before",h),g)Fv(h,g,v);else for(const S of i.values())Fv(h,S.store.getState());m&&oh("after",h)}return{loop:l,invalidate:u,advance:f}}function JE(){const i=X.useContext(ZE);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function ND(i=t=>t,e){return JE()(i,e)}function LD(i,e=0){const t=JE(),n=t.getState().internal.subscribe,r=VE(i);return tp(()=>n(r,e,t),[e,n,t]),null}const Vd=new Map,{invalidate:FS,advance:BS}=PD(Vd),{reconciler:yg,applyProps:Sd}=vD(Vd,MD),wd={objects:"shallow",strict:!1},ID=(i,e)=>{const t=typeof i=="function"?i(e):i;return KE(t)?t:new fy({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...i})};function DD(i,e){const t=typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement;if(e){const{width:n,height:r,top:o,left:l,updateStyle:u=t}=e;return{width:n,height:r,top:o,left:l,updateStyle:u}}else if(typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:n,height:r,top:o,left:l}=i.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:l,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function kD(i){const e=Vd.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,o=n||TD(FS,BS),l=t||yg.createContainer(o,Id.ConcurrentRoot,null,!1,null,"",r,null);e||Vd.set(i,{fiber:l,store:o});let u,f=!1,h;return{configure(m={}){let{gl:g,size:v,scene:S,events:_,onCreated:T,shadows:E=!1,linear:w=!1,flat:C=!1,legacy:R=!1,orthographic:L=!1,frameloop:G="always",dpr:U=[1,2],performance:k,raycaster:Z,camera:D,onPointerMissed:H}=m,W=o.getState(),ne=W.gl;W.gl||W.set({gl:ne=ID(g,i)});let ge=W.raycaster;ge||W.set({raycaster:ge=new Iy});const{params:$,...ie}=Z||{};if($n.equ(ie,ge,wd)||Sd(ge,{...ie}),$n.equ($,ge.params,wd)||Sd(ge,{params:{...ge.params,...$}}),!W.camera||W.camera===h&&!$n.equ(h,D,wd)){h=D;const V=D instanceof Xh,B=V?D:L?new Zh(0,0,0,0,.1,1e3):new qr(75,0,.1,1e3);V||(B.position.z=5,D&&(Sd(B,D),("aspect"in D||"left"in D||"right"in D||"bottom"in D||"top"in D)&&(B.manual=!0,B.updateProjectionMatrix())),!W.camera&&!(D!=null&&D.rotation)&&B.lookAt(0,0,0)),W.set({camera:B}),ge.camera=B}if(!W.scene){let V;S!=null&&S.isScene?V=S:(V=new hy,S&&Sd(V,S)),W.set({scene:Ed(V)})}if(!W.xr){var oe;const V=(ee,he)=>{const Re=o.getState();Re.frameloop!=="never"&&BS(ee,!0,Re,he)},B=()=>{const ee=o.getState();ee.gl.xr.enabled=ee.gl.xr.isPresenting,ee.gl.xr.setAnimationLoop(ee.gl.xr.isPresenting?V:null),ee.gl.xr.isPresenting||FS(ee)},Y={connect(){const ee=o.getState().gl;ee.xr.addEventListener("sessionstart",B),ee.xr.addEventListener("sessionend",B)},disconnect(){const ee=o.getState().gl;ee.xr.removeEventListener("sessionstart",B),ee.xr.removeEventListener("sessionend",B)}};typeof((oe=ne.xr)==null?void 0:oe.addEventListener)=="function"&&Y.connect(),W.set({xr:Y})}if(ne.shadowMap){const V=ne.shadowMap.enabled,B=ne.shadowMap.type;if(ne.shadowMap.enabled=!!E,$n.boo(E))ne.shadowMap.type=fh;else if($n.str(E)){var fe;const Y={basic:Nw,percentage:Cg,soft:fh,variance:so};ne.shadowMap.type=(fe=Y[E])!=null?fe:fh}else $n.obj(E)&&Object.assign(ne.shadowMap,E);(V!==ne.shadowMap.enabled||B!==ne.shadowMap.type)&&(ne.shadowMap.needsUpdate=!0)}const q=HE();q&&("enabled"in q?q.enabled=!R:"legacyMode"in q&&(q.legacyMode=R)),f||Sd(ne,{outputEncoding:w?3e3:3001,toneMapping:C?Do:Rg}),W.legacy!==R&&W.set(()=>({legacy:R})),W.linear!==w&&W.set(()=>({linear:w})),W.flat!==C&&W.set(()=>({flat:C})),g&&!$n.fun(g)&&!KE(g)&&!$n.equ(g,ne,wd)&&Sd(ne,g),_&&!W.events.handlers&&W.set({events:_(o)});const K=DD(i,v);return $n.equ(K,W.size,wd)||W.setSize(K.width,K.height,K.updateStyle,K.top,K.left),U&&W.viewport.dpr!==XE(U)&&W.setDpr(U),W.frameloop!==G&&W.setFrameloop(G),W.onPointerMissed||W.set({onPointerMissed:H}),k&&!$n.equ(k,W.performance,wd)&&W.set(V=>({performance:{...V.performance,...k}})),u=T,f=!0,this},render(m){return f||this.configure(),yg.updateContainer(M.jsx(OD,{store:o,children:m,onCreated:u,rootElement:i}),l,null,()=>{}),o},unmount(){$E(i)}}}function OD({store:i,children:e,onCreated:t,rootElement:n}){return tp(()=>{const r=i.getState();r.set(o=>({internal:{...o.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),M.jsx(ZE.Provider,{value:i,children:e})}function $E(i,e){const t=Vd.get(i),n=t?.fiber;if(n){const r=t?.store.getState();r&&(r.internal.active=!1),yg.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var o,l,u,f;r.events.disconnect==null||r.events.disconnect(),(o=r.gl)==null||(l=o.renderLists)==null||l.dispose==null||l.dispose(),(u=r.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=r.gl)!=null&&f.xr&&r.xr.disconnect(),SD(r),Vd.delete(i)}catch{}},500)})}}yg.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:X.version});const Bv={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function UD(i){const{handlePointer:e}=bD(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(Bv).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:o}=i.getState();o.disconnect==null||o.disconnect(),r(l=>({events:{...l.events,connected:t}})),Object.entries((n=o.handlers)!=null?n:[]).forEach(([l,u])=>{const[f,h]=Bv[l];t.addEventListener(f,u,{passive:h})})},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([o,l])=>{if(n&&n.connected instanceof HTMLElement){const[u]=Bv[o];n.connected.removeEventListener(u,l)}}),t(o=>({events:{...o.events,connected:void 0}}))}}}}function zS(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function FD({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,l]=X.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=X.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),f=i?typeof i=="number"?i:i.scroll:null,h=i?typeof i=="number"?i:i.resize:null,m=X.useRef(!1);X.useEffect(()=>(m.current=!0,()=>{m.current=!1}));const[g,v,S]=X.useMemo(()=>{const w=()=>{if(!u.current.element)return;const{left:C,top:R,width:L,height:G,bottom:U,right:k,x:Z,y:D}=u.current.element.getBoundingClientRect(),H={left:C,top:R,width:L,height:G,bottom:U,right:k,x:Z,y:D};u.current.element instanceof HTMLElement&&n&&(H.height=u.current.element.offsetHeight,H.width=u.current.element.offsetWidth),Object.freeze(H),m.current&&!jD(u.current.lastBounds,H)&&l(u.current.lastBounds=H)};return[w,h?zS(w,h):w,f?zS(w,f):w]},[l,n,f,h]);function _(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(w=>w.removeEventListener("scroll",S,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function T(){u.current.element&&(u.current.resizeObserver=new r(S),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(w=>w.addEventListener("scroll",S,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{S()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const E=w=>{!w||w===u.current.element||(_(),u.current.element=w,u.current.scrollContainers=QE(w),T())};return zD(S,!!e),BD(v),X.useEffect(()=>{_(),T()},[e,S,v]),X.useEffect(()=>_,[]),[E,o,g]}function BD(i){X.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[i])}function zD(i,e){X.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[i,e])}function QE(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(o=>o==="auto"||o==="scroll")&&e.push(i),[...e,...QE(i.parentElement)]}const HD=["x","y","top","bottom","left","right","width","height"],jD=(i,e)=>HD.every(t=>i[t]===e[t]);var VD=Object.defineProperty,GD=Object.defineProperties,WD=Object.getOwnPropertyDescriptors,HS=Object.getOwnPropertySymbols,XD=Object.prototype.hasOwnProperty,YD=Object.prototype.propertyIsEnumerable,jS=(i,e,t)=>e in i?VD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,VS=(i,e)=>{for(var t in e||(e={}))XD.call(e,t)&&jS(i,t,e[t]);if(HS)for(var t of HS(e))YD.call(e,t)&&jS(i,t,e[t]);return i},qD=(i,e)=>GD(i,WD(e)),GS,WS;typeof window<"u"&&((GS=window.document)!=null&&GS.createElement||((WS=window.navigator)==null?void 0:WS.product)==="ReactNative")?X.useLayoutEffect:X.useEffect;function eb(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=i.child;for(;n;){const r=eb(n,e,t);if(r)return r;n=n.sibling}}function tb(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const XS=console.error;console.error=function(){const i=[...arguments].join("");if(i?.startsWith("Warning:")&&i.includes("useContext")){console.error=XS;return}return XS.apply(this,arguments)};const ky=tb(X.createContext(null));class nb extends X.Component{render(){return X.createElement(ky.Provider,{value:this._reactInternals},this.props.children)}}function KD(){const i=X.useContext(ky);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=X.useId();return X.useMemo(()=>{for(const n of[i,i?.alternate]){if(!n)continue;const r=eb(n,!1,o=>{let l=o.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(r)return r}},[i,e])}function ZD(){const i=KD(),[e]=X.useState(()=>new Map);e.clear();let t=i;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==ky&&!e.has(r)&&e.set(r,X.useContext(tb(r)))}t=t.return}return e}function JD(){const i=ZD();return X.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>X.createElement(e,null,X.createElement(t.Provider,qD(VS({},n),{value:i.get(t)}))),e=>X.createElement(nb,VS({},e))),[i])}const $D=X.forwardRef(function({children:e,fallback:t,resize:n,style:r,gl:o,events:l=UD,eventSource:u,eventPrefix:f,shadows:h,linear:m,flat:g,legacy:v,orthographic:S,frameloop:_,dpr:T,performance:E,raycaster:w,camera:C,scene:R,onPointerMissed:L,onCreated:G,...U},k){X.useMemo(()=>gD(sD),[]);const Z=JD(),[D,H]=FD({scroll:!0,debounce:{scroll:50,resize:0},...n}),W=X.useRef(null),ne=X.useRef(null);X.useImperativeHandle(k,()=>W.current);const ge=VE(L),[$,ie]=X.useState(!1),[oe,fe]=X.useState(!1);if($)throw $;if(oe)throw oe;const q=X.useRef(null);tp(()=>{const V=W.current;H.width>0&&H.height>0&&V&&(q.current||(q.current=kD(V)),q.current.configure({gl:o,events:l,shadows:h,linear:m,flat:g,legacy:v,orthographic:S,frameloop:_,dpr:T,performance:E,raycaster:w,camera:C,scene:R,size:H,onPointerMissed:(...B)=>ge.current==null?void 0:ge.current(...B),onCreated:B=>{B.events.connect==null||B.events.connect(u?xD(u)?u.current:u:ne.current),f&&B.setEvents({compute:(Y,ee)=>{const he=Y[f+"X"],Re=Y[f+"Y"];ee.pointer.set(he/ee.size.width*2-1,-(Re/ee.size.height)*2+1),ee.raycaster.setFromCamera(ee.pointer,ee.camera)}}),G?.(B)}}),q.current.render(M.jsx(Z,{children:M.jsx(GE,{set:fe,children:M.jsx(X.Suspense,{fallback:M.jsx(yD,{set:ie}),children:e??null})})})))}),X.useEffect(()=>{const V=W.current;if(V)return()=>$E(V)},[]);const K=u?"none":"auto";return M.jsx("div",{ref:ne,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:K,...r},...U,children:M.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:M.jsx("canvas",{ref:W,style:{display:"block"},children:t})})})}),QD=X.forwardRef(function(e,t){return M.jsx(nb,{children:M.jsx($D,{...e,ref:t})})});function Lo(i,e,t){return Math.max(e,Math.min(t,i))}function YS(i){let e=i|0;return e^=e>>>16,e=Math.imul(e,2146121005),e^=e>>>15,e=Math.imul(e,2221713035),e^=e>>>16,(e>>>0)/4294967296}function ek(i,e,t,n,r,o){let l=0,u=1;const f=e.x-i.x,h=e.y-i.y,m=(v,S)=>{if(v===0)return S>=0;const _=S/v;if(v<0){if(_>u)return!1;_>l&&(l=_)}else{if(_<l)return!1;_<u&&(u=_)}return!0};if(!m(-f,i.x-t)||!m(f,n-i.x)||!m(-h,i.y-r)||!m(h,o-i.y)||l>u)return null;const g=(l+u)*.5;return{tEnter:l,tExit:u,tMid:g,ix:i.x+f*g,iy:i.y+h*g}}function tk(i){if(!i)return null;const e=i.enabled==null?!0:!!i.enabled,t=i.leftPointerX??i.pointerLeftX??i.handLeftX??i.leftX??i?.left?.x??i?.handLeft?.x??null,n=i.leftPointerY??i.pointerLeftY??i.handLeftY??i.leftY??i?.left?.y??i?.handLeft?.y??null,r=i.leftTracking??i.isLeftTracking??i.leftHandTracking??i.leftHandPresent??i?.left?.tracking??i?.handLeft?.tracking??null,o=i.rightPointerX??i.pointerRightX??i.handRightX??i.rightX??i?.right?.x??i?.handRight?.x??null,l=i.rightPointerY??i.pointerRightY??i.handRightY??i.rightY??i?.right?.y??i?.handRight?.y??null,u=i.rightTracking??i.isRightTracking??i.rightHandTracking??i.rightHandPresent??i?.right?.tracking??i?.handRight?.tracking??null,f=i.pointerX??i.cursorX??i.x??i?.pointer?.x??null,h=i.pointerY??i.cursorY??i.y??i?.pointer?.y??null,m=i.isTracking??i.tracking??i.handTracking??i.handPresent??null,g=t!=null&&n!=null,v=o!=null&&l!=null,S=f!=null&&h!=null;if(!g&&!v&&!S)return null;const _=(k,Z)=>{const D=Number(k);if(!Number.isFinite(D))return null;if(D>=0&&D<=1)return D;if(D>=-1.1&&D<=1.1)return Lo((D+1)*.5,0,1);const H=i.screenW??i.width??i.videoW??window.innerWidth??1920,W=i.screenH??i.height??i.videoH??window.innerHeight??1080,ne=Number(Z==="x"?H:W);return!Number.isFinite(ne)||ne<=0?Lo(D,0,1):Lo(D/ne,0,1)},T=i.leftGesture??i.leftHandGesture??i?.left?.gesture??i?.handLeft?.gesture??null,E=i.rightGesture??i.rightHandGesture??i?.right?.gesture??i?.handRight?.gesture??null,w=g?{nx:_(t,"x"),ny:_(n,"y"),tracking:(r==null?!0:!!r)&&e,gesture:T??"NONE"}:null,C=v?{nx:_(o,"x"),ny:_(l,"y"),tracking:(u==null?!0:!!u)&&e,gesture:E??"NONE"}:null,R=S?{nx:_(f,"x"),ny:_(h,"y"),tracking:(m==null?!0:!!m)&&e,gesture:"NONE"}:null,L=w&&w.nx!=null&&w.ny!=null?w:null,G=C&&C.nx!=null&&C.ny!=null?C:null,U=R&&R.nx!=null&&R.ny!=null?R:null;return!L&&!G&&!U?null:{left:L,right:G,single:U}}function nk({ndcX:i,ndcY:e,camera:t,trackObj:n,raycaster:r,invWorldRef:o,normalMatRef:l,originLRef:u,dirLRef:f,localZPlane:h,outLocal:m}){if(!n)return!1;r.setFromCamera({x:i,y:e},t),o.copy(n.matrixWorld).invert(),u.copy(r.ray.origin).applyMatrix4(o),l.getNormalMatrix(o),f.copy(r.ray.direction).applyMatrix3(l).normalize();const g=f.z;if(Math.abs(g)<1e-6)return!1;const v=(h-u.z)/g;return v<=0?!1:(m.copy(u).addScaledVector(f,v),!0)}function zv(i,e){return 1/(1+1/(2*Math.PI*i)/Math.max(e,1e-4))}function $m(i,e,t){return t*e+(1-t)*i}function rk(){const i=()=>document?.documentElement?.getAttribute("data-theme")||"dark",[e,t]=X.useState(i);return X.useEffect(()=>{const n=document.documentElement,r=new MutationObserver(()=>t(i()));r.observe(n,{attributes:!0,attributeFilter:["data-theme"]});const o=l=>{l.key==="theme"&&t(i())};return window.addEventListener("storage",o),()=>{r.disconnect(),window.removeEventListener("storage",o)}},[]),e}function ik({statusRef:i,onHUD:e,onJudge:t,songTimeRef:n,bpm:r=120,beatOffsetSec:o=.65,seed:l=1,playing:u=!1,resetNonce:f=0,onSliceSfx:h,allowMouseFallback:m=!1,themeColors:g,inputMode:v="HAND"}){const{camera:S,pointer:_}=ND(),T=[-2.1,2.1],E=5.2,w=.95,C=.45,R=Math.abs(T[1]-T[0])+1.2,L=E+.25,G=-23,U=13,k=E+10,Z=(E-G)/U,D=1.6,H=1.4,W=1.25,ne=.55,ge=2.2,$=26,ie=40,oe=120,fe=X.useRef(null),q=X.useRef(new Iy),K=X.useRef(new Kt),V=X.useRef(new ki),B=X.useRef(new J),Y=X.useRef(new J),ee=X.useRef(new Kt),he=X.useRef(new cn),Re=X.useRef(new J),Ue=X.useRef(new J),Fe=X.useRef(new J),Ge=X.useRef(new J(1,0,0)),qe=X.useRef(new J(0,1,0)),We=X.useRef(0),st=X.useRef(0),Q=X.useRef(0),De=X.useRef(0),Ee=X.useRef(1),ke=X.useRef({x:0,y:1.2,tx:0,ty:1.2,tracking:!1,gesture:"NONE",vx:0,vy:0,_lastT:null,_lastTx:0,_lastTy:0,_lastTrackMs:0,_sampleUpdated:!1,_sampleT:0,_sampleX:0,_sampleY:0,_euroInited:!1,_euroLastT:0,_euroLastX:0,_euroLastY:0,_euroX:0,_euroY:0,_euroDx:0,_euroDy:0}),Se=X.useRef({x:0,y:1.2,tx:0,ty:1.2,tracking:!1,gesture:"NONE",vx:0,vy:0,_lastT:null,_lastTx:0,_lastTy:0,_lastTrackMs:0,_sampleUpdated:!1,_sampleT:0,_sampleX:0,_sampleY:0,_euroInited:!1,_euroLastT:0,_euroLastX:0,_euroLastY:0,_euroX:0,_euroY:0,_euroDx:0,_euroDy:0}),be=X.useRef(null),se=X.useRef(null),F=X.useRef({x:0,y:0,tMs:0,has:!1}),O=X.useRef({x:0,y:0,tMs:0,has:!1}),ce=X.useRef(0),Pe=X.useRef(0),we=X.useRef(0),Te=X.useRef({perfect:0,good:0,miss:0,swingMiss:0}),rt=X.useRef(Array.from({length:$},()=>({alive:!1,judged:!1,lane:0,z:G,baseSize:.78}))),He=X.useRef(0),ot=X.useRef(Array.from({length:ie},()=>({alive:!1,life:0,pos:new J,vel:new J,rot:new Yd,rotVel:new J,scale:new J(1,1,1),color:new ht}))),_t=X.useRef(Array.from({length:oe},()=>({alive:!1,life:0,pos:new J,vel:new J}))),Et=X.useRef(new Float32Array(oe*3)),Oe=X.useRef(null),Ot=X.useRef(null),It=X.useRef(null),Ct=X.useRef(null),bt=X.useRef(null),yt=X.useRef({lastT:0}),Wt=X.useMemo(()=>new ht(g?.left||"#7dd3fc"),[g?.left]),on=X.useMemo(()=>new ht(g?.right||"#ff4fd8"),[g?.right]),tn=X.useMemo(()=>new Od({color:new ht(g?.lane||"#0a0f1f"),roughness:.3,metalness:.7}),[g?.lane]),Xt=X.useMemo(()=>new Ns({color:new ht(g?.rail||"#9be7ff"),transparent:!0,opacity:.9}),[g?.rail]),et=X.useMemo(()=>new Od({vertexColors:!0,roughness:.15,metalness:.9,emissive:new ht(g?.rail||"#2bbcff"),emissiveIntensity:.25}),[g?.rail]),ae=X.useMemo(()=>new Ns({color:new ht(g?.left||"#7dd3fc"),transparent:!0,opacity:.18,depthWrite:!1}),[g?.left]),it=X.useMemo(()=>new Od({vertexColors:!0,roughness:.22,metalness:.85,emissive:new ht(g?.rail||"#2bbcff"),emissiveIntensity:.2,transparent:!0,opacity:1}),[g?.rail]),lt=X.useMemo(()=>new Ns({color:new ht(g?.hitCore||"#c7f3ff"),transparent:!0,opacity:.9}),[g?.hitCore]),Dt=X.useMemo(()=>new Ns({color:new ht(g?.left||"#7dd3fc"),transparent:!0,opacity:.18,depthWrite:!1}),[g?.left]);X.useEffect(()=>{for(const je of rt.current)je.alive=!1,je.judged=!1,je.lane=0,je.z=G;for(const je of ot.current)je.alive=!1,je.life=0;for(const je of _t.current)je.alive=!1,je.life=0;for(let je=0;je<oe;je++)Et.current[je*3+0]=9999,Et.current[je*3+1]=9999,Et.current[je*3+2]=9999;ce.current=0,Pe.current=0,we.current=0,F.current.has=!1,O.current.has=!1,We.current=0,st.current=0,Q.current=0,De.current=0,Te.current.perfect=0,Te.current.good=0,Te.current.miss=0,Te.current.swingMiss=0;const gt=je=>{je.current.x=0,je.current.y=1.2,je.current.tx=0,je.current.ty=1.2,je.current.tracking=!1,je.current.gesture="NONE",je.current.vx=0,je.current.vy=0,je.current._lastT=null,je.current._lastTx=0,je.current._lastTy=0,je.current._lastTrackMs=0,je.current._sampleUpdated=!1,je.current._sampleT=0,je.current._sampleX=0,je.current._sampleY=0,je.current._euroInited=!1,je.current._euroLastT=0,je.current._euroLastX=0,je.current._euroLastY=0,je.current._euroX=0,je.current._euroY=0,je.current._euroDx=0,je.current._euroDy=0};if(gt(ke),gt(Se),Oe.current&&Ot.current){for(let je=0;je<$;je++)K.current.identity(),Y.current.set(1e-4,1e-4,1e-4),V.current.identity(),B.current.set(0,0,0),K.current.compose(B.current,V.current,Y.current),Oe.current.setMatrixAt(je,K.current),Ot.current.setMatrixAt(je,K.current);Oe.current.instanceMatrix.needsUpdate=!0,Ot.current.instanceMatrix.needsUpdate=!0}if(It.current){for(let je=0;je<ie;je++)K.current.identity(),Y.current.set(1e-4,1e-4,1e-4),V.current.identity(),B.current.set(0,0,0),K.current.compose(B.current,V.current,Y.current),It.current.setMatrixAt(je,K.current);It.current.instanceMatrix.needsUpdate=!0}Ct.current&&(Ct.current.attributes.position.needsUpdate=!0)},[f]);const Rt=(gt,je=0)=>{const Ut=rt.current,zt=He.current;He.current=(zt+1)%Ut.length;const dn=Ut[zt];dn.alive=!0,dn.judged=!1,dn.lane=gt;const Rn=Lo(je,0,Z);dn.z=G+U*Rn,dn.baseSize=.78},hn=gt=>{const je=Lo((gt.z-G)/(E-G),0,1),Ut=T[gt.lane],zt=Ad.lerp(2.9,w,je),dn=gt.baseSize*Ad.lerp(.55,1.25,je);return{x:Ut,y:zt,s:dn,z:gt.z}},pn=(gt,je,Ut="HIT")=>{gt==="PERFECT"?(ce.current+=1,we.current+=300,Te.current.perfect+=1):gt==="GOOD"?(ce.current+=1,we.current+=100,Te.current.good+=1):gt==="MISS"&&(ce.current=0,Ut==="AUTO"?Te.current.miss+=1:Te.current.swingMiss+=1),ce.current>Pe.current&&(Pe.current=ce.current),t?.(gt,je)},Ln=(gt,je,Ut)=>{const zt=Math.min(je.x,Ut.x),dn=Math.max(je.x,Ut.x),Rn=Math.min(je.y,Ut.y),Kn=Math.max(je.y,Ut.y),ue=zt<=T[gt]+W&&dn>=T[gt]-W,Be=Kn>=C-ne&&Rn<=w+ne;return ue&&Be},Yn=gt=>{for(const je of rt.current){if(!je.alive||je.lane!==gt||Math.abs(je.z-E)>ge)continue;const{y:zt}=hn(je);if(zt>=C-ne&&zt<=w+ne)return!0}return!1},mn=(gt,je,Ut,zt,dn)=>{const Rn=gt===0?Wt:on,Kn=Lo(dn??.5,.12,.88),ue=Kn,Be=1-Kn,j=zt==="Y"?qe.current:Ge.current,de=-(.5-ue/2)*Ut,ve=+(.5-Be/2)*Ut,ye=(_e,Ze,vt)=>{let ut=null;for(let kt=0;kt<ie;kt++)if(!ot.current[kt].alive){ut=ot.current[kt];break}ut||(ut=ot.current[Math.random()*ie|0]),ut.alive=!0,ut.life=.55+Math.random()*.25,ut.pos.copy(je).addScaledVector(j,vt);const tt=(6+Math.random()*3.2)*(1+(.35-Ze)*.6);ut.vel.copy(j).multiplyScalar(_e*tt),zt==="Y"?(ut.vel.y+=(_e>0?2.2:-1)+Math.random()*1.8,ut.vel.x+=(Math.random()-.5)*2):ut.vel.y+=2.4+Math.random()*3.8,ut.vel.z+=-1.6-Math.random()*2.6,ut.rot.set(0,0,0),ut.rotVel.set(2+Math.random()*2,(_e>0?1:-1)*(2+Math.random()*3),(_e>0?-1:1)*(1+Math.random()*2)),zt==="Y"?ut.scale.set(Ut*1,Ut*Ze,Ut*.35):ut.scale.set(Ut*Ze,Ut*1,Ut*.35),ut.color.copy(Rn)};ye(-1,ue,de),ye(1,Be,ve);for(let _e=0;_e<18;_e++){let Ze=null;for(let tt=0;tt<oe;tt++)if(!_t.current[tt].alive){Ze=_t.current[tt];break}Ze||(Ze=_t.current[Math.random()*oe|0]);const vt=Math.random()*Math.PI*2,ut=6+Math.random()*11;Ze.alive=!0,Ze.life=.45+Math.random()*.35,Ze.pos.copy(je),Ze.vel.set(Math.cos(vt)*ut,3+Math.random()*6,-2-Math.random()*4)}},qn=(gt,je,Ut)=>{let zt=null,dn=1e9,Rn=.5,Kn="X";for(const de of rt.current){if(!de.alive||de.lane!==gt)continue;const ve=Math.abs(de.z-E);if(ve>D)continue;const{x:ye,y:_e,s:Ze}=hn(de),vt=Ze*.55,ut=Ze*.55,tt=Ze*.18,kt=ek(je,Ut,ye-vt-tt,ye+vt+tt,_e-ut-tt,_e+ut+tt);if(!kt)continue;const Ft=Ut.x-je.x,jt=Ut.y-je.y,mt=Math.abs(Ft)>=Math.abs(jt)?"Y":"X",$e=mt==="Y"?(kt.iy-(_e-ut))/(2*ut):(kt.ix-(ye-vt))/(2*vt),Xe=Lo($e,.05,.95);ve<dn&&(dn=ve,zt=de,Rn=Xe,Kn=mt)}if(!zt)return;const j=dn<=.7?"PERFECT":dn<=1.6?"GOOD":"MISS";if(j!=="MISS"){const{x:de,y:ve,s:ye,z:_e}=hn(zt);Fe.current.set(de,ve,_e),mn(gt,Fe.current,ye,Kn,Rn),h?.(),zt.judged=!0,zt.alive=!1}pn(j,gt,j==="MISS"?"SWING":"HIT")},rr=(gt,je,Ut)=>{if(!gt.current.tracking)return je.current.has=!1,!1;if(!gt.current._sampleUpdated)return!1;const zt=gt.current._sampleX,dn=gt.current._sampleY,Rn=gt.current._sampleT;if(!je.current.has)return je.current.x=zt,je.current.y=dn,je.current.tMs=Rn,je.current.has=!0,!1;const Kn=je.current.x,ue=je.current.y,j=Math.max(1,Rn-(je.current.tMs||Rn))/1e3,de=zt-Kn,ve=dn-ue,ye=Math.sqrt(de*de+ve*ve)/Math.max(j,1e-4);let _e=!1;if(ye>=H){const Ze={x:Kn,y:ue},vt={x:zt,y:dn};Yn(Ut)&&Ln(Ut,Ze,vt)&&(_e=!0,qn(Ut,Ze,vt))}return je.current.x=zt,je.current.y=dn,je.current.tMs=Rn,_e},xs=(gt,je,Ut,zt)=>{if(!gt.current._euroInited)return gt.current._euroInited=!0,gt.current._euroLastT=je,gt.current._euroLastX=Ut,gt.current._euroLastY=zt,gt.current._euroX=Ut,gt.current._euroY=zt,gt.current._euroDx=0,gt.current._euroDy=0,{fx:Ut,fy:zt};const ue=Lo((je-gt.current._euroLastT)/1e3,.001,.2),Be=(Ut-gt.current._euroLastX)/ue,j=(zt-gt.current._euroLastY)/ue,de=zv(1,ue);gt.current._euroDx=$m(gt.current._euroDx,Be,de),gt.current._euroDy=$m(gt.current._euroDy,j,de);const ve=1.15+.03*Math.abs(gt.current._euroDx),ye=1.15+.03*Math.abs(gt.current._euroDy),_e=zv(ve,ue),Ze=zv(ye,ue);return gt.current._euroX=$m(gt.current._euroX,Ut,_e),gt.current._euroY=$m(gt.current._euroY,zt,Ze),gt.current._euroLastT=je,gt.current._euroLastX=Ut,gt.current._euroLastY=zt,{fx:gt.current._euroX,fy:gt.current._euroY}};return LD((gt,je)=>{const Ut=i.current,zt=tk(Ut),dn=Ut?.__ts??0,Rn=!!dn&&dn!==De.current;Rn&&(De.current=dn);const Kn=_.x,ue=_.y;let Be=null,j=null;const de=mt=>({x:mt.nx*2-1,y:(1-mt.ny)*2-1,tracking:mt.tracking,gesture:mt.gesture??"NONE"});if(zt){const mt=[];zt.left&&mt.push(de(zt.left)),zt.right&&mt.push(de(zt.right)),mt.length===0&&zt.single&&mt.push(de(zt.single));const $e=Xe=>String(Xe||"").toUpperCase();if(v==="COLOR"){const Xe=mt.findIndex(Yt=>$e(Yt.gesture)==="BLUE"),$t=mt.findIndex(Yt=>$e(Yt.gesture)==="RED"),ft=Xe>=0?mt[Xe]:null,ct=$t>=0?mt[$t]:null;if(ft&&(Be=ft),ct&&(j=ct),Be&&!j&&mt.length>=2){const Yt=mt.find((qt,vn)=>vn!==Xe);Yt&&(j=Yt)}if(j&&!Be&&mt.length>=2){const Yt=mt.find((qt,vn)=>vn!==$t);Yt&&(Be=Yt)}}if(!Be&&!j){if(mt.length>=2)mt.sort((Xe,$t)=>Xe.x-$t.x),Be=mt[0],j=mt[1],Ee.current=1;else if(mt.length===1){const Xe=mt[0],$t=.18;Xe.x<-$t?Ee.current=0:Xe.x>$t&&(Ee.current=1),Ee.current===0?Be=Xe:j=Xe}}Be&&!j&&(Ee.current=0),j&&!Be&&(Ee.current=1)}const ve=m&&!Be&&!j;ve&&(Be={x:Kn,y:ue,tracking:!0,gesture:"MOUSE"},j={x:Kn,y:ue,tracking:!0,gesture:"MOUSE"});const ye=fe.current,_e=q.current,Ze=(mt,$e,Xe,$t)=>{const ft=performance.now(),ct=120;if($e.current._sampleUpdated=!1,!mt){const Tn=!!$e.current._lastTrackMs&&ft-$e.current._lastTrackMs<ct;return $e.current.tracking=Tn,$e.current.gesture="NONE",!1}mt.tracking&&($e.current._lastTrackMs=ft);const Yt=!!mt.tracking||!!$e.current._lastTrackMs&&ft-$e.current._lastTrackMs<ct;if($e.current.tracking=Yt,$e.current.gesture=mt.gesture??"NONE",!ye||!Xe||!nk({ndcX:mt.x,ndcY:mt.y,camera:S,trackObj:ye,raycaster:_e,invWorldRef:ee.current,normalMatRef:he.current,originLRef:Re.current,dirLRef:Ue.current,localZPlane:L,outLocal:Fe.current}))return!1;const vn=Fe.current.x,ir=Fe.current.y,{fx:Qn,fy:In}=xs($e,$t,vn,ir);if($e.current._lastT!=null){const Tn=Math.max(1,$t-$e.current._lastT),Kr=(Qn-$e.current._lastTx)/Tn,po=(In-$e.current._lastTy)/Tn;$e.current.vx=$e.current.vx*.75+Kr*.25,$e.current.vy=$e.current.vy*.75+po*.25}return $e.current._lastT=$t,$e.current._lastTx=Qn,$e.current._lastTy=In,$e.current.tx=Qn,$e.current.ty=In,$e.current._sampleUpdated=!0,$e.current._sampleT=$t,$e.current._sampleX=vn,$e.current._sampleY=ir,!0},vt=dn||performance.now(),ut=performance.now();Ze(Be,ke,ve?!0:Rn,ve?ut:vt),Ze(j,Se,ve?!0:Rn,ve?ut:vt);{const $e=Xe=>{if(!Xe.current.tracking){const ir=Math.exp(-je*14);Xe.current.vx*=ir,Xe.current.vy*=ir}const $t=Xe.current.tx+Xe.current.vx*70,ft=Xe.current.ty+Xe.current.vy*70,ct=Math.hypot($t-Xe.current.x,ft-Xe.current.y),Yt=28+ct*.08,qt=Lo(Xe.current.tracking?Yt:Yt*.65,18,120),vn=1-Math.exp(-je*qt);ct>2.2&&Xe.current.tracking?(Xe.current.x=$t,Xe.current.y=ft):(Xe.current.x+=($t-Xe.current.x)*vn,Xe.current.y+=(ft-Xe.current.y)*vn)};$e(ke),$e(Se)}const tt=n?.current??0;if(tt<st.current-.05&&(We.current=0,Q.current=0),st.current=tt,u&&r>0){const $e=60/r*.5;for(;;){const Xe=We.current,ft=o+Xe*$e-Z;if(tt<ft)break;const ct=tt-ft,Yt=Xe%2===0,qt=YS(l*1e6+Xe|0);if(Yt?!0:qt<.35){let ir=Q.current^1;if(qt<(Yt?.2:.12)&&(ir=Q.current),Rt(ir,ct),Q.current=ir,Yt){const Qn=Xe/2|0,In=YS(l*777777+Qn|0);Qn%16===0&&In<.55&&Rt(ir^1,ct)}}We.current++}}if(Oe.current&&Ot.current){for(let mt=0;mt<$;mt++){const $e=rt.current[mt];if(u&&$e.alive&&($e.z+=U*je,!$e.judged&&$e.z>E+D&&($e.judged=!0,$e.alive=!1,pn("MISS",$e.lane,"AUTO")),$e.z>k&&($e.alive=!1)),!$e.alive){K.current.identity(),V.current.identity(),B.current.set(0,0,0),Y.current.set(1e-4,1e-4,1e-4),K.current.compose(B.current,V.current,Y.current),Oe.current.setMatrixAt(mt,K.current),Ot.current.setMatrixAt(mt,K.current);continue}const Xe=Lo(($e.z-G)/(E-G),0,1),$t=T[$e.lane],ft=Ad.lerp(2.9,w,Xe),ct=$e.z,Yt=$e.baseSize*Ad.lerp(.55,1.25,Xe);V.current.identity(),B.current.set($t,ft,ct),Y.current.set(Yt,Yt,Yt*.35),K.current.compose(B.current,V.current,Y.current),Oe.current.setMatrixAt(mt,K.current),B.current.set($t,ft,ct-.08),Y.current.set(Yt*1.25,Yt*1.25,Yt*.25),K.current.compose(B.current,V.current,Y.current),Ot.current.setMatrixAt(mt,K.current),Oe.current.setColorAt(mt,$e.lane===0?Wt:on)}Oe.current.instanceMatrix.needsUpdate=!0,Ot.current.instanceMatrix.needsUpdate=!0,Oe.current.instanceColor&&(Oe.current.instanceColor.needsUpdate=!0)}let kt=!1,Ft=!1;if(u&&(kt=rr(ke,F,0),Ft=rr(Se,O,1)),be.current&&(be.current.visible=ke.current.tracking,be.current.position.set(ke.current.x,ke.current.y,L)),se.current&&(se.current.visible=Se.current.tracking,se.current.position.set(Se.current.x,Se.current.y,L)),It.current){for(let $e=0;$e<ie;$e++){const Xe=ot.current[$e];if(!Xe.alive){K.current.identity(),V.current.identity(),B.current.set(0,0,0),Y.current.set(1e-4,1e-4,1e-4),K.current.compose(B.current,V.current,Y.current),It.current.setMatrixAt($e,K.current);continue}if(Xe.life-=je,Xe.life<=0){Xe.alive=!1,K.current.identity(),V.current.identity(),B.current.set(0,0,0),Y.current.set(1e-4,1e-4,1e-4),K.current.compose(B.current,V.current,Y.current),It.current.setMatrixAt($e,K.current);continue}Xe.vel.y+=-13*je,Xe.pos.addScaledVector(Xe.vel,je),Xe.rot.x+=Xe.rotVel.x*je,Xe.rot.y+=Xe.rotVel.y*je,Xe.rot.z+=Xe.rotVel.z*je,V.current.setFromEuler(Xe.rot),K.current.compose(Xe.pos,V.current,Xe.scale),It.current.setMatrixAt($e,K.current),It.current.setColorAt($e,Xe.color)}It.current.instanceMatrix.needsUpdate=!0,It.current.instanceColor&&(It.current.instanceColor.needsUpdate=!0)}{for(let $e=0;$e<oe;$e++){const Xe=_t.current[$e];if(!Xe.alive){Et.current[$e*3+0]=9999,Et.current[$e*3+1]=9999,Et.current[$e*3+2]=9999;continue}if(Xe.life-=je,Xe.life<=0){Xe.alive=!1,Et.current[$e*3+0]=9999,Et.current[$e*3+1]=9999,Et.current[$e*3+2]=9999;continue}Xe.vel.y+=-12*.7*je,Xe.pos.addScaledVector(Xe.vel,je),Et.current[$e*3+0]=Xe.pos.x,Et.current[$e*3+1]=Xe.pos.y,Et.current[$e*3+2]=Xe.pos.z}Ct.current&&(Ct.current.attributes.position.needsUpdate=!0),bt.current&&(bt.current.opacity=.9)}const jt=performance.now();jt-yt.current.lastT>100&&(yt.current.lastT=jt,e?.({trackingL:ke.current.tracking,trackingR:Se.current.tracking,firedL:kt,firedR:Ft,bpm:r,combo:ce.current,maxCombo:Pe.current,score:we.current,songTime:tt,beatOffsetSec:o,gestureL:ke.current.gesture,gestureR:Se.current.gesture,perfect:Te.current.perfect,good:Te.current.good,miss:Te.current.miss,swingMiss:Te.current.swingMiss}))}),M.jsxs(M.Fragment,{children:[M.jsx("color",{attach:"background",args:[g?.bg0||"#060a14"]}),M.jsx("fog",{attach:"fog",args:[g?.fog||g?.bg1||"#070a14",10,44]}),M.jsx("ambientLight",{intensity:.55}),M.jsx("directionalLight",{position:[6,8,6],intensity:.85}),M.jsx("pointLight",{position:[-6,3,2],intensity:1,color:g?.left||"#7dd3fc"}),M.jsx("pointLight",{position:[6,3,-10],intensity:.9,color:g?.right||"#ff4fd8"}),M.jsxs("group",{ref:fe,position:[0,.8,0],children:[M.jsx("mesh",{rotation:[-Math.PI/2,0,0],position:[0,0,-14],material:tn,children:M.jsx("planeGeometry",{args:[18,46]})}),M.jsx("mesh",{rotation:[-Math.PI/2,0,0],position:[-2.1,.01,-14],material:Xt,children:M.jsx("planeGeometry",{args:[.03,46]})}),M.jsx("mesh",{rotation:[-Math.PI/2,0,0],position:[2.1,.01,-14],material:Xt,children:M.jsx("planeGeometry",{args:[.03,46]})}),M.jsx("mesh",{position:[0,w,E],material:Dt,children:M.jsx("boxGeometry",{args:[R*1.06,.08,.08]})}),M.jsx("mesh",{position:[0,w,E],material:lt,children:M.jsx("boxGeometry",{args:[R,.022,.022]})}),M.jsx("mesh",{position:[0,C,E],material:Dt,children:M.jsx("boxGeometry",{args:[R*1.06,.08,.08]})}),M.jsx("mesh",{position:[0,C,E],material:lt,children:M.jsx("boxGeometry",{args:[R,.022,.022]})}),M.jsx("instancedMesh",{ref:Ot,args:[null,null,$],material:ae,children:M.jsx("boxGeometry",{args:[1,1,1]})}),M.jsx("instancedMesh",{ref:Oe,args:[null,null,$],material:et,children:M.jsx("boxGeometry",{args:[1,1,1]})}),M.jsx("instancedMesh",{ref:It,args:[null,null,ie],material:it,children:M.jsx("boxGeometry",{args:[1,1,1]})}),M.jsxs("points",{children:[M.jsx("bufferGeometry",{ref:Ct,children:M.jsx("bufferAttribute",{attach:"attributes-position",array:Et.current,itemSize:3,count:oe})}),M.jsx("pointsMaterial",{ref:bt,size:.08,color:g?.white||"#ffffff",transparent:!0,opacity:.9,depthWrite:!1})]}),M.jsxs("group",{ref:se,rotation:[0,0,-.6],renderOrder:999,children:[M.jsx("pointLight",{color:g?.right||"#ff4fd8",intensity:1.6,distance:7,decay:2}),M.jsxs("mesh",{renderOrder:999,children:[M.jsx("boxGeometry",{args:[.1,.85,.05]}),M.jsx("meshBasicMaterial",{color:g?.right||"#ff4fd8",transparent:!0,opacity:.18,depthTest:!1,depthWrite:!1})]}),M.jsxs("mesh",{position:[0,.06,0],renderOrder:999,children:[M.jsx("boxGeometry",{args:[.05,.72,.02]}),M.jsx("meshStandardMaterial",{color:g?.hitCore||"#c7f3ff",metalness:.85,roughness:.18,emissive:g?.right||"#ff4fd8",emissiveIntensity:.35,transparent:!0,opacity:.98,depthTest:!1,depthWrite:!1})]}),M.jsxs("mesh",{position:[0,-.34,0],renderOrder:999,children:[M.jsx("cylinderGeometry",{args:[.035,.035,.18,12]}),M.jsx("meshStandardMaterial",{color:g?.bg1||"#1a1f2e",metalness:.2,roughness:.85,depthTest:!1,depthWrite:!1})]})]}),M.jsxs("group",{ref:be,rotation:[0,0,.6],renderOrder:999,children:[M.jsx("pointLight",{color:g?.left||"#7dd3fc",intensity:1.6,distance:7,decay:2}),M.jsxs("mesh",{renderOrder:999,children:[M.jsx("boxGeometry",{args:[.1,.85,.05]}),M.jsx("meshBasicMaterial",{color:g?.left||"#7dd3fc",transparent:!0,opacity:.18,depthTest:!1,depthWrite:!1})]}),M.jsxs("mesh",{position:[0,.06,0],renderOrder:999,children:[M.jsx("boxGeometry",{args:[.05,.72,.02]}),M.jsx("meshStandardMaterial",{color:g?.hitCore||"#c7f3ff",metalness:.85,roughness:.18,emissive:g?.left||"#7dd3fc",emissiveIntensity:.35,transparent:!0,opacity:.98,depthTest:!1,depthWrite:!1})]}),M.jsxs("mesh",{position:[0,-.34,0],renderOrder:999,children:[M.jsx("cylinderGeometry",{args:[.035,.035,.18,12]}),M.jsx("meshStandardMaterial",{color:g?.bg1||"#1a1f2e",metalness:.2,roughness:.85,depthTest:!1,depthWrite:!1})]})]})]})]})}function sk({status:i,connected:e=!0}){const t=rk(),n=Al?.[t]?.colors||Al.dark.colors,r=X.useRef(null);X.useEffect(()=>{if(i!=null){const be={...i,__ts:performance.now()};r.current=be}},[i]),X.useEffect(()=>{let be=!0,se=null,F=null;const O=async()=>{if(be){F&&F.abort(),F=new AbortController;try{const Pe=await(await fetch("/api/control/status",{cache:"no-store",signal:F.signal})).json();Pe.__ts=performance.now(),be&&(r.current=Pe)}catch{}finally{be&&(se=setTimeout(O,33))}}};return O(),()=>{be=!1,F&&F.abort(),se&&clearTimeout(se)}},[]);const o=X.useMemo(()=>[{id:"da",title:"다 멍청해",src:encodeURI("/audio/다 멍청해.mp3"),bpm:120,offsetSec:.65,seed:11},{id:"lemon",title:"Lemon Tree",src:encodeURI("/audio/lemon_tree.mp3"),bpm:128,offsetSec:.8,seed:22},{id:"rush",title:"Rush F",src:encodeURI("/audio/rush_e.mp3"),bpm:112,offsetSec:.7,seed:33}],[]),[l,u]=X.useState(o[0].id),f=o.find(be=>be.id===l)||o[0],[h,m]=X.useState(()=>{const be={};for(const se of o)be[se.id]=se.offsetSec;return be}),g=h[l]??f.offsetSec,[v,S]=X.useState("HAND"),_=v==="COLOR"?"RUSH_COLOR":"RUSH_HAND",T=X.useRef(null),E=X.useRef(0),[w,C]=X.useState("LOBBY"),[R,L]=X.useState(!1),[G,U]=X.useState(0),[k,Z]=X.useState({trackingL:!1,trackingR:!1,firedL:!1,firedR:!1,bpm:f.bpm,combo:0,maxCombo:0,score:0,songTime:0,beatOffsetSec:g,gestureL:"NONE",gestureR:"NONE",perfect:0,good:0,miss:0,swingMiss:0}),[D,H]=X.useState(null),[W,ne]=X.useState(null),[ge,$]=X.useState(!1),[ie,oe]=X.useState(""),fe=X.useRef({ctx:null,buf:null,ready:!1}),q=async()=>{if(fe.current.ready)return;const be=window.AudioContext||window.webkitAudioContext;if(!be)return;fe.current.ctx||(fe.current.ctx=new be),fe.current.ctx.state!=="running"&&await fe.current.ctx.resume();const F=await(await fetch("/sfx/slice.wav",{cache:"force-cache"})).arrayBuffer(),O=await fe.current.ctx.decodeAudioData(F);fe.current.buf=O,fe.current.ready=!0},K=()=>{const be=fe.current.ctx,se=fe.current.buf;if(!be||!se)return;const F=be.createBufferSource();F.buffer=se;const O=be.createGain();O.gain.value=.65,F.connect(O).connect(be.destination),F.start(0)};X.useEffect(()=>{C("LOBBY"),L(!1),ne(null),U(se=>se+1);const be=T.current;be&&(be.pause(),be.currentTime=0,be.src=f.src)},[l,f.src]),X.useEffect(()=>{let be=0;const se=()=>{const F=T.current,O=F&&F.currentTime||0;E.current=O,F&&w==="PLAYING"&&F.duration&&F.currentTime>=F.duration-.02&&(F.pause(),L(!1),C("RESULT"),ne({songId:l,title:f.title,bpm:f.bpm,offsetSec:g,score:k.score,maxCombo:k.maxCombo,perfect:k.perfect,good:k.good,miss:k.miss,swingMiss:k.swingMiss})),be=requestAnimationFrame(se)};return be=requestAnimationFrame(se),()=>cancelAnimationFrame(be)},[w,l,f.title,f.bpm,g,k]);const V=X.useCallback(async()=>{$(!0),oe("");try{const se=await fetch(`/api/control/mode?mode=${encodeURIComponent(v==="COLOR"?"RUSH_COLOR":"RUSH_HAND")}`,{method:"POST"});if(!se.ok){const O=await se.text().catch(()=>"");throw new Error(`mode failed (${se.status}) ${O}`)}const F=await fetch("/api/control/start",{method:"POST"});if(!F.ok){const O=await F.text().catch(()=>"");throw new Error(`start failed (${F.status}) ${O}`)}}catch(be){oe(String(be?.message||be||"apply failed"))}finally{$(!1)}},[v]),B=async()=>{const be=T.current;if(be){await V();try{await q()}catch{}ne(null),U(se=>se+1),be.currentTime=0;try{await be.play(),C("PLAYING"),L(!0)}catch{L(!1),C("LOBBY")}}},Y=()=>{const be=T.current;be&&be.pause(),L(!1)},ee=async()=>{const be=T.current;if(be)try{await be.play(),L(!0)}catch{L(!1)}},he=()=>{const be=T.current;be&&(be.pause(),be.currentTime=0),L(!1),U(se=>se+1)},Re=async()=>{he(),await B()},Ue=()=>{he(),ne(null),C("LOBBY")},Fe=()=>{const be=T.current;if(!be)return;const se=be.currentTime||0;m(F=>({...F,[l]:se})),U(F=>F+1)},Ge=W?.perfect??k.perfect??0,qe=W?.good??k.good??0,We=W?.miss??k.miss??0,st=Ge+qe+We,Q=st>0?(Ge+qe)/st:0,De=Q>=.95?"S":Q>=.9?"A":Q>=.8?"B":Q>=.65?"C":"D",Ee=String(r.current?.mode||"").toUpperCase(),ke=e&&["RUSH","RUSH_HAND","RUSH_COLOR"].includes(Ee)&&!!r.current?.enabled,Se=D?.lane===0?"text-info":D?.lane===1?"text-secondary":"text-base-content";return M.jsxs("div",{className:"w-full bg-base-100 text-base-content relative overflow-hidden",style:{height:"100dvh"},children:[M.jsx("audio",{ref:T,preload:"metadata"}),M.jsx(QD,{dpr:1,gl:{antialias:!1,powerPreference:"high-performance"},camera:{position:[0,3.6,9.8],fov:60},onCreated:({gl:be})=>{be.toneMapping=Rg,be.toneMappingExposure=1.15},children:M.jsx("group",{rotation:[Ad.degToRad(-6),0,0],children:M.jsx(ik,{statusRef:r,songTimeRef:E,bpm:f.bpm,beatOffsetSec:g,seed:f.seed,playing:w==="PLAYING"&&R,resetNonce:G,onSliceSfx:K,onHUD:be=>Z(be),onJudge:(be,se)=>{H({text:be,lane:se,ts:performance.now()}),setTimeout(()=>H(null),420)},allowMouseFallback:!1,themeColors:n,inputMode:v})})}),w==="LOBBY"&&M.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-auto",children:[M.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-base-100/75 via-base-100/45 to-base-100/75"}),M.jsx("div",{className:"relative h-full flex items-start justify-center px-6 pt-8 pb-6",children:M.jsxs("div",{className:"w-[min(980px,94vw)] bg-base-200/55 border border-base-300/40 rounded-3xl p-6 backdrop-blur",children:[M.jsxs("div",{className:"flex items-start justify-between gap-4",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-xs tracking-[0.35em] text-base-content/70",children:"RHYTHM RUSH"}),M.jsx("div",{className:"text-2xl font-black mt-1",children:"Lobby"})]}),M.jsx("div",{className:"text-right",children:M.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border "+(ke?"border-success/30 bg-success/10 text-success":"border-error/30 bg-error/10 text-error"),children:M.jsx("span",{className:"text-xs font-semibold",children:ke?"RUSH READY":"CHECK MANAGER"})})})]}),M.jsx("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-3 gap-3",children:o.map(be=>{const se=be.id===l;return M.jsxs("button",{onClick:()=>u(be.id),className:"text-left rounded-2xl border p-4 transition "+(se?"bg-base-300/40 border-base-300/70":"bg-base-200/30 border-base-300/35 hover:bg-base-300/30"),children:[M.jsx("div",{className:"text-lg font-bold mt-1",children:be.title}),M.jsxs("div",{className:"text-xs text-base-content/60 mt-1",children:["BPM ",be.bpm]})]},be.id)})}),M.jsxs("div",{className:"mt-5 bg-base-200/35 border border-base-300/35 rounded-2xl p-4",children:[M.jsx("div",{className:"text-xs tracking-[0.25em] text-base-content/70",children:"BEAT OFFSET"}),M.jsxs("div",{className:"mt-3 bg-base-200/35 border border-base-300/35 rounded-2xl p-4",children:[M.jsx("div",{className:"flex items-start justify-between gap-3",children:M.jsxs("div",{children:[M.jsx("div",{className:"text-xs tracking-[0.25em] text-base-content/70",children:"RUSH INPUT"}),M.jsx("div",{className:"text-sm text-base-content/60 mt-1",children:"입력 방식 선택"})]})}),M.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[M.jsx("button",{className:"btn btn-sm rounded-xl "+(v==="HAND"?"btn-primary":"btn-ghost"),onClick:()=>S("HAND"),disabled:ge,children:"손 (Hand)"}),M.jsx("button",{className:"btn btn-sm rounded-xl "+(v==="COLOR"?"btn-primary":"btn-ghost"),onClick:()=>S("COLOR"),disabled:ge,children:"스틱 (Color)"}),M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40 rounded-xl ml-2",onClick:V,disabled:ge,title:"지금 바로 RUSH 모드+START 적용",children:ge?"Applying...":"모드 선택"})]}),ie?M.jsx("div",{className:"mt-2 text-xs text-error break-all",children:ie}):null]}),M.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[M.jsx("div",{children:M.jsx("div",{className:"text-sm text-base-content/60 mt-1",children:"첫 박 시작 시점(박자가 맞지 않으면 조정하세요)"})}),M.jsxs("div",{className:"text-xs text-base-content/70 tabular-nums",children:[Math.round(g*1e3),"ms"]})]}),M.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[M.jsx("input",{type:"range",min:0,max:2.5,step:.01,value:g,onChange:be=>{const se=Number(be.target.value);m(F=>({...F,[l]:se})),U(F=>F+1)},className:"w-full range range-sm"}),M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40",onClick:Fe,title:"음악 들으면서 '첫 박'에 맞춰 눌러 오프셋 잡기",children:"Now=1st Beat"})]})]}),M.jsxs("div",{className:"mt-5 flex items-center justify-between gap-3",children:[M.jsx("div",{className:"text-xs text-base-content/60 leading-5",children:"문제 발생 시 Manager 상태 확인"}),M.jsx("button",{onClick:B,className:"btn btn-primary rounded-xl px-6",disabled:ge,children:"Start Game"})]})]})})]}),w==="PLAYING"&&M.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 w-[min(820px,92vw)] pointer-events-auto",children:M.jsx("div",{className:"bg-base-200/55 border border-base-300/35 rounded-2xl px-4 py-3 backdrop-blur",children:M.jsxs("div",{className:"flex items-start justify-between gap-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-xs tracking-[0.25em] text-base-content/70",children:"NOW PLAYING"}),M.jsx("div",{className:"text-lg font-bold",children:f.title}),M.jsxs("div",{className:"text-xs text-base-content/60",children:["BPM ",f.bpm," · Offset"," ",Math.round(g*1e3),"ms · Score ",k.score," · Combo ",k.combo," · Input ",_]})]}),M.jsxs("div",{className:"flex gap-2",children:[R?M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40",onClick:Y,children:"Pause"}):M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40",onClick:ee,children:"Resume"}),M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40",onClick:he,children:"Reset"})]})]})})}),w==="PLAYING"&&M.jsxs("div",{className:"absolute top-28 left-1/2 -translate-x-1/2 text-center pointer-events-none z-10",children:[M.jsx("div",{className:"text-xs tracking-[0.35em] text-base-content/70",children:"SCORE"}),M.jsx("div",{className:"text-5xl font-black drop-shadow",children:k.score}),k.combo>1&&M.jsxs("div",{className:"mt-2 text-6xl font-black drop-shadow",children:[k.combo," ",M.jsx("span",{className:"text-base-content/80",children:"COMBO"})]}),M.jsxs("div",{className:"mt-1 text-sm text-base-content/60",children:["MAX ",k.maxCombo]})]}),w==="PLAYING"&&D&&M.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:M.jsx("div",{className:`text-6xl font-black drop-shadow ${Se}`,children:D.text})}),w==="RESULT"&&M.jsxs("div",{className:"absolute inset-0 z-30 pointer-events-auto",children:[M.jsx("div",{className:"absolute inset-0 bg-base-100/75"}),M.jsx("div",{className:"relative h-full flex items-center justify-center px-6",children:M.jsxs("div",{className:"w-[min(720px,92vw)] bg-base-200/55 border border-base-300/35 rounded-3xl p-6 backdrop-blur",children:[M.jsx("div",{className:"text-xs tracking-[0.35em] text-base-content/70",children:"RESULT"}),M.jsxs("div",{className:"mt-1 flex items-end justify-between gap-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-2xl font-black",children:f.title}),M.jsxs("div",{className:"text-sm text-base-content/60 mt-1",children:["BPM ",f.bpm," · Offset"," ",Math.round(g*1e3),"ms · Input"," ",_]})]}),M.jsxs("div",{className:"text-right",children:[M.jsx("div",{className:"text-xs text-base-content/60",children:"RANK"}),M.jsx("div",{className:"text-4xl font-black",children:De}),M.jsxs("div",{className:"text-xs text-base-content/60 mt-1",children:["ACC ",(Q*100).toFixed(1),"%"]})]})]}),M.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[M.jsxs("div",{className:"bg-base-200/35 border border-base-300/35 rounded-2xl p-4",children:[M.jsx("div",{className:"text-xs text-base-content/60",children:"FINAL SCORE"}),M.jsx("div",{className:"text-4xl font-black mt-1",children:W?.score??k.score})]}),M.jsxs("div",{className:"bg-base-200/35 border border-base-300/35 rounded-2xl p-4",children:[M.jsx("div",{className:"text-xs text-base-content/60",children:"MAX COMBO"}),M.jsx("div",{className:"text-4xl font-black mt-1",children:W?.maxCombo??k.maxCombo})]})]}),M.jsxs("div",{className:"mt-3 bg-base-200/35 border border-base-300/35 rounded-2xl p-4",children:[M.jsx("div",{className:"text-xs text-base-content/60 mb-2",children:"JUDGEMENT"}),M.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[M.jsxs("div",{className:"flex justify-between bg-base-100/35 rounded-xl px-3 py-2",children:[M.jsx("span",{className:"text-base-content/70",children:"PERFECT"}),M.jsx("span",{className:"font-bold",children:W?.perfect??k.perfect})]}),M.jsxs("div",{className:"flex justify-between bg-base-100/35 rounded-xl px-3 py-2",children:[M.jsx("span",{className:"text-base-content/70",children:"GOOD"}),M.jsx("span",{className:"font-bold",children:W?.good??k.good})]}),M.jsxs("div",{className:"flex justify-between bg-base-100/35 rounded-xl px-3 py-2",children:[M.jsx("span",{className:"text-base-content/70",children:"MISS"}),M.jsx("span",{className:"font-bold",children:W?.miss??k.miss})]}),M.jsxs("div",{className:"flex justify-between bg-base-100/35 rounded-xl px-3 py-2",children:[M.jsx("span",{className:"text-base-content/70",children:"SWING MISS"}),M.jsx("span",{className:"font-bold",children:W?.swingMiss??k.swingMiss})]})]})]}),M.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[M.jsx("button",{className:"btn btn-sm btn-ghost border border-base-300/40",onClick:Ue,children:"Back to Lobby"}),M.jsx("button",{className:"btn btn-sm btn-primary",onClick:Re,children:"Retry"})]})]})})]}),!e&&w!=="RESULT"&&M.jsx("div",{className:"absolute bottom-4 left-4 z-10 bg-base-200/70 border border-base-300/35 rounded-2xl px-4 py-3 text-xs backdrop-blur pointer-events-none",children:"백엔드 연결 OFF"})]})}var ok=Object.defineProperty,_g=Object.getOwnPropertySymbols,rb=Object.prototype.hasOwnProperty,ib=Object.prototype.propertyIsEnumerable,qS=(i,e,t)=>e in i?ok(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Bx=(i,e)=>{for(var t in e||(e={}))rb.call(e,t)&&qS(i,t,e[t]);if(_g)for(var t of _g(e))ib.call(e,t)&&qS(i,t,e[t]);return i},zx=(i,e)=>{var t={};for(var n in i)rb.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&_g)for(var n of _g(i))e.indexOf(n)<0&&ib.call(i,n)&&(t[n]=i[n]);return t};var Zc;(i=>{const e=class xn{constructor(f,h,m,g){if(this.version=f,this.errorCorrectionLevel=h,this.modules=[],this.isFunction=[],f<xn.MIN_VERSION||f>xn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let v=[];for(let _=0;_<this.size;_++)v.push(!1);for(let _=0;_<this.size;_++)this.modules.push(v.slice()),this.isFunction.push(v.slice());this.drawFunctionPatterns();const S=this.addEccAndInterleave(m);if(this.drawCodewords(S),g==-1){let _=1e9;for(let T=0;T<8;T++){this.applyMask(T),this.drawFormatBits(T);const E=this.getPenaltyScore();E<_&&(g=T,_=E),this.applyMask(T)}}r(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,h){const m=i.QrSegment.makeSegments(f);return xn.encodeSegments(m,h)}static encodeBinary(f,h){const m=i.QrSegment.makeBytes(f);return xn.encodeSegments([m],h)}static encodeSegments(f,h,m=1,g=40,v=-1,S=!0){if(!(xn.MIN_VERSION<=m&&m<=g&&g<=xn.MAX_VERSION)||v<-1||v>7)throw new RangeError("Invalid value");let _,T;for(_=m;;_++){const R=xn.getNumDataCodewords(_,h)*8,L=l.getTotalBits(f,_);if(L<=R){T=L;break}if(_>=g)throw new RangeError("Data too long")}for(const R of[xn.Ecc.MEDIUM,xn.Ecc.QUARTILE,xn.Ecc.HIGH])S&&T<=xn.getNumDataCodewords(_,R)*8&&(h=R);let E=[];for(const R of f){t(R.mode.modeBits,4,E),t(R.numChars,R.mode.numCharCountBits(_),E);for(const L of R.getData())E.push(L)}r(E.length==T);const w=xn.getNumDataCodewords(_,h)*8;r(E.length<=w),t(0,Math.min(4,w-E.length),E),t(0,(8-E.length%8)%8,E),r(E.length%8==0);for(let R=236;E.length<w;R^=253)t(R,8,E);let C=[];for(;C.length*8<E.length;)C.push(0);return E.forEach((R,L)=>C[L>>>3]|=R<<7-(L&7)),new xn(_,h,C,v)}getModule(f,h){return 0<=f&&f<this.size&&0<=h&&h<this.size&&this.modules[h][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let m=0;m<this.size;m++)this.setFunctionModule(6,m,m%2==0),this.setFunctionModule(m,6,m%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),h=f.length;for(let m=0;m<h;m++)for(let g=0;g<h;g++)m==0&&g==0||m==0&&g==h-1||m==h-1&&g==0||this.drawAlignmentPattern(f[m],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const h=this.errorCorrectionLevel.formatBits<<3|f;let m=h;for(let v=0;v<10;v++)m=m<<1^(m>>>9)*1335;const g=(h<<10|m)^21522;r(g>>>15==0);for(let v=0;v<=5;v++)this.setFunctionModule(8,v,n(g,v));this.setFunctionModule(8,7,n(g,6)),this.setFunctionModule(8,8,n(g,7)),this.setFunctionModule(7,8,n(g,8));for(let v=9;v<15;v++)this.setFunctionModule(14-v,8,n(g,v));for(let v=0;v<8;v++)this.setFunctionModule(this.size-1-v,8,n(g,v));for(let v=8;v<15;v++)this.setFunctionModule(8,this.size-15+v,n(g,v));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let m=0;m<12;m++)f=f<<1^(f>>>11)*7973;const h=this.version<<12|f;r(h>>>18==0);for(let m=0;m<18;m++){const g=n(h,m),v=this.size-11+m%3,S=Math.floor(m/3);this.setFunctionModule(v,S,g),this.setFunctionModule(S,v,g)}}drawFinderPattern(f,h){for(let m=-4;m<=4;m++)for(let g=-4;g<=4;g++){const v=Math.max(Math.abs(g),Math.abs(m)),S=f+g,_=h+m;0<=S&&S<this.size&&0<=_&&_<this.size&&this.setFunctionModule(S,_,v!=2&&v!=4)}}drawAlignmentPattern(f,h){for(let m=-2;m<=2;m++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,h+m,Math.max(Math.abs(g),Math.abs(m))!=1)}setFunctionModule(f,h,m){this.modules[h][f]=m,this.isFunction[h][f]=!0}addEccAndInterleave(f){const h=this.version,m=this.errorCorrectionLevel;if(f.length!=xn.getNumDataCodewords(h,m))throw new RangeError("Invalid argument");const g=xn.NUM_ERROR_CORRECTION_BLOCKS[m.ordinal][h],v=xn.ECC_CODEWORDS_PER_BLOCK[m.ordinal][h],S=Math.floor(xn.getNumRawDataModules(h)/8),_=g-S%g,T=Math.floor(S/g);let E=[];const w=xn.reedSolomonComputeDivisor(v);for(let R=0,L=0;R<g;R++){let G=f.slice(L,L+T-v+(R<_?0:1));L+=G.length;const U=xn.reedSolomonComputeRemainder(G,w);R<_&&G.push(0),E.push(G.concat(U))}let C=[];for(let R=0;R<E[0].length;R++)E.forEach((L,G)=>{(R!=T-v||G>=_)&&C.push(L[R])});return r(C.length==S),C}drawCodewords(f){if(f.length!=Math.floor(xn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let h=0;for(let m=this.size-1;m>=1;m-=2){m==6&&(m=5);for(let g=0;g<this.size;g++)for(let v=0;v<2;v++){const S=m-v,T=(m+1&2)==0?this.size-1-g:g;!this.isFunction[T][S]&&h<f.length*8&&(this.modules[T][S]=n(f[h>>>3],7-(h&7)),h++)}}r(h==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let h=0;h<this.size;h++)for(let m=0;m<this.size;m++){let g;switch(f){case 0:g=(m+h)%2==0;break;case 1:g=h%2==0;break;case 2:g=m%3==0;break;case 3:g=(m+h)%3==0;break;case 4:g=(Math.floor(m/3)+Math.floor(h/2))%2==0;break;case 5:g=m*h%2+m*h%3==0;break;case 6:g=(m*h%2+m*h%3)%2==0;break;case 7:g=((m+h)%2+m*h%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[h][m]&&g&&(this.modules[h][m]=!this.modules[h][m])}}getPenaltyScore(){let f=0;for(let v=0;v<this.size;v++){let S=!1,_=0,T=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[v][E]==S?(_++,_==5?f+=xn.PENALTY_N1:_>5&&f++):(this.finderPenaltyAddHistory(_,T),S||(f+=this.finderPenaltyCountPatterns(T)*xn.PENALTY_N3),S=this.modules[v][E],_=1);f+=this.finderPenaltyTerminateAndCount(S,_,T)*xn.PENALTY_N3}for(let v=0;v<this.size;v++){let S=!1,_=0,T=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[E][v]==S?(_++,_==5?f+=xn.PENALTY_N1:_>5&&f++):(this.finderPenaltyAddHistory(_,T),S||(f+=this.finderPenaltyCountPatterns(T)*xn.PENALTY_N3),S=this.modules[E][v],_=1);f+=this.finderPenaltyTerminateAndCount(S,_,T)*xn.PENALTY_N3}for(let v=0;v<this.size-1;v++)for(let S=0;S<this.size-1;S++){const _=this.modules[v][S];_==this.modules[v][S+1]&&_==this.modules[v+1][S]&&_==this.modules[v+1][S+1]&&(f+=xn.PENALTY_N2)}let h=0;for(const v of this.modules)h=v.reduce((S,_)=>S+(_?1:0),h);const m=this.size*this.size,g=Math.ceil(Math.abs(h*20-m*10)/m)-1;return r(0<=g&&g<=9),f+=g*xn.PENALTY_N4,r(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,h=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let m=[6];for(let g=this.size-7;m.length<f;g-=h)m.splice(1,0,g);return m}}static getNumRawDataModules(f){if(f<xn.MIN_VERSION||f>xn.MAX_VERSION)throw new RangeError("Version number out of range");let h=(16*f+128)*f+64;if(f>=2){const m=Math.floor(f/7)+2;h-=(25*m-10)*m-55,f>=7&&(h-=36)}return r(208<=h&&h<=29648),h}static getNumDataCodewords(f,h){return Math.floor(xn.getNumRawDataModules(f)/8)-xn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][f]*xn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let h=[];for(let g=0;g<f-1;g++)h.push(0);h.push(1);let m=1;for(let g=0;g<f;g++){for(let v=0;v<h.length;v++)h[v]=xn.reedSolomonMultiply(h[v],m),v+1<h.length&&(h[v]^=h[v+1]);m=xn.reedSolomonMultiply(m,2)}return h}static reedSolomonComputeRemainder(f,h){let m=h.map(g=>0);for(const g of f){const v=g^m.shift();m.push(0),h.forEach((S,_)=>m[_]^=xn.reedSolomonMultiply(S,v))}return m}static reedSolomonMultiply(f,h){if(f>>>8||h>>>8)throw new RangeError("Byte out of range");let m=0;for(let g=7;g>=0;g--)m=m<<1^(m>>>7)*285,m^=(h>>>g&1)*f;return r(m>>>8==0),m}finderPenaltyCountPatterns(f){const h=f[1];r(h<=this.size*3);const m=h>0&&f[2]==h&&f[3]==h*3&&f[4]==h&&f[5]==h;return(m&&f[0]>=h*4&&f[6]>=h?1:0)+(m&&f[6]>=h*4&&f[0]>=h?1:0)}finderPenaltyTerminateAndCount(f,h,m){return f&&(this.finderPenaltyAddHistory(h,m),h=0),h+=this.size,this.finderPenaltyAddHistory(h,m),this.finderPenaltyCountPatterns(m)}finderPenaltyAddHistory(f,h){h[0]==0&&(f+=this.size),h.pop(),h.unshift(f)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],i.QrCode=e;function t(u,f,h){if(f<0||f>31||u>>>f)throw new RangeError("Value out of range");for(let m=f-1;m>=0;m--)h.push(u>>>m&1)}function n(u,f){return(u>>>f&1)!=0}function r(u){if(!u)throw new Error("Assertion error")}const o=class fr{constructor(f,h,m){if(this.mode=f,this.numChars=h,this.bitData=m,h<0)throw new RangeError("Invalid argument");this.bitData=m.slice()}static makeBytes(f){let h=[];for(const m of f)t(m,8,h);return new fr(fr.Mode.BYTE,f.length,h)}static makeNumeric(f){if(!fr.isNumeric(f))throw new RangeError("String contains non-numeric characters");let h=[];for(let m=0;m<f.length;){const g=Math.min(f.length-m,3);t(parseInt(f.substring(m,m+g),10),g*3+1,h),m+=g}return new fr(fr.Mode.NUMERIC,f.length,h)}static makeAlphanumeric(f){if(!fr.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let h=[],m;for(m=0;m+2<=f.length;m+=2){let g=fr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(m))*45;g+=fr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(m+1)),t(g,11,h)}return m<f.length&&t(fr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(m)),6,h),new fr(fr.Mode.ALPHANUMERIC,f.length,h)}static makeSegments(f){return f==""?[]:fr.isNumeric(f)?[fr.makeNumeric(f)]:fr.isAlphanumeric(f)?[fr.makeAlphanumeric(f)]:[fr.makeBytes(fr.toUtf8ByteArray(f))]}static makeEci(f){let h=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,h);else if(f<16384)t(2,2,h),t(f,14,h);else if(f<1e6)t(6,3,h),t(f,21,h);else throw new RangeError("ECI assignment value out of range");return new fr(fr.Mode.ECI,0,h)}static isNumeric(f){return fr.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return fr.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,h){let m=0;for(const g of f){const v=g.mode.numCharCountBits(h);if(g.numChars>=1<<v)return 1/0;m+=4+v+g.bitData.length}return m}static toUtf8ByteArray(f){f=encodeURI(f);let h=[];for(let m=0;m<f.length;m++)f.charAt(m)!="%"?h.push(f.charCodeAt(m)):(h.push(parseInt(f.substring(m+1,m+3),16)),m+=2);return h}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;i.QrSegment=o})(Zc||(Zc={}));(i=>{(e=>{const t=class{constructor(r,o){this.ordinal=r,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(i.QrCode||(i.QrCode={}))})(Zc||(Zc={}));(i=>{(e=>{const t=class{constructor(r,o){this.modeBits=r,this.numBitsCharCount=o}numCharCountBits(r){return this.numBitsCharCount[Math.floor((r+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(i.QrSegment||(i.QrSegment={}))})(Zc||(Zc={}));var Dd=Zc;var ak={L:Dd.QrCode.Ecc.LOW,M:Dd.QrCode.Ecc.MEDIUM,Q:Dd.QrCode.Ecc.QUARTILE,H:Dd.QrCode.Ecc.HIGH},sb=128,ob="L",ab="#FFFFFF",lb="#000000",cb=!1,ub=1,lk=4,ck=0,uk=.1;function db(i,e=0){const t=[];return i.forEach(function(n,r){let o=null;n.forEach(function(l,u){if(!l&&o!==null){t.push(`M${o+e} ${r+e}h${u-o}v1H${o+e}z`),o=null;return}if(u===n.length-1){if(!l)return;o===null?t.push(`M${u+e},${r+e} h1v1H${u+e}z`):t.push(`M${o+e},${r+e} h${u+1-o}v1H${o+e}z`);return}l&&o===null&&(o=u)})}),t.join("")}function fb(i,e){return i.slice().map((t,n)=>n<e.y||n>=e.y+e.h?t:t.map((r,o)=>o<e.x||o>=e.x+e.w?r:!1))}function dk(i,e,t,n){if(n==null)return null;const r=i.length+t*2,o=Math.floor(e*uk),l=r/e,u=(n.width||o)*l,f=(n.height||o)*l,h=n.x==null?i.length/2-u/2:n.x*l,m=n.y==null?i.length/2-f/2:n.y*l,g=n.opacity==null?1:n.opacity;let v=null;if(n.excavate){let _=Math.floor(h),T=Math.floor(m),E=Math.ceil(u+h-_),w=Math.ceil(f+m-T);v={x:_,y:T,w:E,h:w}}const S=n.crossOrigin;return{x:h,y:m,h:f,w:u,excavation:v,opacity:g,crossOrigin:S}}function fk(i,e){return e!=null?Math.max(Math.floor(e),0):i?lk:ck}function hb({value:i,level:e,minVersion:t,includeMargin:n,marginSize:r,imageSettings:o,size:l,boostLevel:u}){let f=Or.useMemo(()=>{const _=(Array.isArray(i)?i:[i]).reduce((T,E)=>(T.push(...Dd.QrSegment.makeSegments(E)),T),[]);return Dd.QrCode.encodeSegments(_,ak[e],t,void 0,void 0,u)},[i,e,t,u]);const{cells:h,margin:m,numCells:g,calculatedImageSettings:v}=Or.useMemo(()=>{let S=f.getModules();const _=fk(n,r),T=S.length+_*2,E=dk(S,l,_,o);return{cells:S,margin:_,numCells:T,calculatedImageSettings:E}},[f,l,o,n,r]);return{qrcode:f,margin:m,cells:h,numCells:g,calculatedImageSettings:v}}var hk=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),pb=Or.forwardRef(function(e,t){const n=e,{value:r,size:o=sb,level:l=ob,bgColor:u=ab,fgColor:f=lb,includeMargin:h=cb,minVersion:m=ub,boostLevel:g,marginSize:v,imageSettings:S}=n,T=zx(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:E}=T,w=zx(T,["style"]),C=S?.src,R=Or.useRef(null),L=Or.useRef(null),G=Or.useCallback($=>{R.current=$,typeof t=="function"?t($):t&&(t.current=$)},[t]),[U,k]=Or.useState(!1),{margin:Z,cells:D,numCells:H,calculatedImageSettings:W}=hb({value:r,level:l,minVersion:m,boostLevel:g,includeMargin:h,marginSize:v,imageSettings:S,size:o});Or.useEffect(()=>{if(R.current!=null){const $=R.current,ie=$.getContext("2d");if(!ie)return;let oe=D;const fe=L.current,q=W!=null&&fe!==null&&fe.complete&&fe.naturalHeight!==0&&fe.naturalWidth!==0;q&&W.excavation!=null&&(oe=fb(D,W.excavation));const K=window.devicePixelRatio||1;$.height=$.width=o*K;const V=o/H*K;ie.scale(V,V),ie.fillStyle=u,ie.fillRect(0,0,H,H),ie.fillStyle=f,hk?ie.fill(new Path2D(db(oe,Z))):D.forEach(function(B,Y){B.forEach(function(ee,he){ee&&ie.fillRect(he+Z,Y+Z,1,1)})}),W&&(ie.globalAlpha=W.opacity),q&&ie.drawImage(fe,W.x+Z,W.y+Z,W.w,W.h)}}),Or.useEffect(()=>{k(!1)},[C]);const ne=Bx({height:o,width:o},E);let ge=null;return C!=null&&(ge=Or.createElement("img",{src:C,key:C,style:{display:"none"},onLoad:()=>{k(!0)},ref:L,crossOrigin:W?.crossOrigin})),Or.createElement(Or.Fragment,null,Or.createElement("canvas",Bx({style:ne,height:o,width:o,ref:G,role:"img"},w)),ge)});pb.displayName="QRCodeCanvas";var pk=Or.forwardRef(function(e,t){const n=e,{value:r,size:o=sb,level:l=ob,bgColor:u=ab,fgColor:f=lb,includeMargin:h=cb,minVersion:m=ub,boostLevel:g,title:v,marginSize:S,imageSettings:_}=n,T=zx(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:E,cells:w,numCells:C,calculatedImageSettings:R}=hb({value:r,level:l,minVersion:m,boostLevel:g,includeMargin:h,marginSize:S,imageSettings:_,size:o});let L=w,G=null;_!=null&&R!=null&&(R.excavation!=null&&(L=fb(w,R.excavation)),G=Or.createElement("image",{href:_.src,height:R.h,width:R.w,x:R.x+E,y:R.y+E,preserveAspectRatio:"none",opacity:R.opacity,crossOrigin:R.crossOrigin}));const U=db(L,E);return Or.createElement("svg",Bx({height:o,width:o,viewBox:`0 0 ${C} ${C}`,ref:t,role:"img"},T),!!v&&Or.createElement("title",null,v),Or.createElement("path",{fill:u,d:`M0,0 h${C}v${C}H0z`,shapeRendering:"crispEdges"}),Or.createElement("path",{fill:f,d:U,shapeRendering:"crispEdges"}),G)});pk.displayName="QRCodeSVG";function ba(...i){return i.filter(Boolean).join(" ")}function ah({tone:i="neutral",children:e,title:t}){return M.jsx("span",{className:ba("inline-flex items-center rounded-full px-2.5 py-1 text-[11px] font-semibold ring-1 select-none",i==="ok"?"bg-emerald-500/15 ring-emerald-400/30":i==="bad"?"bg-rose-500/15 ring-rose-400/30":"bg-base-100/25 ring-base-300/50 opacity-90"),title:t,children:e})}function mk({open:i,onClose:e,pairing:t}){const n=X.useMemo(()=>{const v=String(t?.pc||"").trim(),S=Number(t?.httpPort||0),_=Number(t?.udpPort||0),T=encodeURIComponent(String(t?.name||"PC"));return!v||!S||!_?"":`gestureos://pair?pc=${v}&http=${S}&udp=${_}&name=${T}`},[t]),r=X.useMemo(()=>{const v=String(t?.pc||"").trim(),S=Number(t?.httpPort||0);return!v||!S?"":`http://${v}:${S}/mjpeg`},[t]),o=!!n,[l,u]=X.useState({status:"idle",ms:null,error:""});X.useEffect(()=>{i&&u({status:"idle",ms:null,error:""})},[i,t?.pc,t?.httpPort]);const f=async()=>{if(n)try{await navigator.clipboard.writeText(n)}catch{}},h=()=>{r&&window.open(r,"_blank","noopener,noreferrer")},m=async()=>{if(!r)return;const v=performance.now();u({status:"checking",ms:null,error:""});try{const S=await new Promise((T,E)=>{const w=new Image,C=setTimeout(()=>{R(),E(new Error("timeout"))},1200),R=()=>{clearTimeout(C),w.onload=null,w.onerror=null};w.onload=()=>{R(),T(!0)},w.onerror=()=>{R(),E(new Error("load failed"))},w.src=`${r}?t=${Date.now()}`}),_=Math.round(performance.now()-v);return u({status:"ok",ms:_,error:""}),S}catch(S){const _=Math.round(performance.now()-v);return u({status:"fail",ms:_,error:S?.message||"failed"}),!1}};if(!i)return null;const g=r?l.status==="checking"?M.jsx(ah,{children:"STREAM: CHECK…"}):l.status==="ok"?M.jsxs(ah,{tone:"ok",children:["STREAM: OK (",l.ms,"ms)"]}):l.status==="fail"?M.jsxs(ah,{tone:"bad",title:l.error||"fail",children:["STREAM: FAIL (",l.ms,"ms)"]}):M.jsx(ah,{children:"STREAM: -"}):M.jsx(ah,{children:"STREAM: -"});return M.jsx("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/60 px-4 py-6",onMouseDown:v=>{v.target===v.currentTarget&&e?.()},children:M.jsxs("div",{className:ba("w-full max-w-[720px] max-h-[85vh] overflow-auto","rounded-3xl ring-1 p-6","bg-base-200 text-base-content border border-base-300/60","shadow-2xl"),role:"dialog","aria-modal":"true",children:[M.jsxs("div",{className:"flex items-start justify-between gap-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-base font-semibold",children:"폰 페어링"}),M.jsx("div",{className:"text-xs opacity-70 mt-1",children:"QR을 스캔하면 IP/포트가 자동 설정됩니다."}),M.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[g,M.jsx("button",{type:"button",onClick:m,disabled:!r||l.status==="checking",className:ba("px-3 py-1 rounded-xl text-[11px] font-semibold ring-1","transition-all duration-150",!r||l.status==="checking"?"opacity-60 cursor-not-allowed bg-base-100/20 ring-base-300/40":"bg-base-100/20 ring-base-300/50 hover:bg-base-100/45"),title:"스트림 접근을 간단히 점검",children:l.status==="checking"?"점검 중...":"스트림 점검"}),M.jsx("button",{type:"button",onClick:h,disabled:!r,className:ba("px-3 py-1 rounded-xl text-[11px] font-semibold ring-1","transition-all duration-150",r?"bg-base-100/20 ring-base-300/50 hover:bg-base-100/45":"opacity-60 cursor-not-allowed bg-base-100/20 ring-base-300/40"),title:"새 탭에서 스트림을 직접 열어 확인",children:"스트림 열기"})]})]}),M.jsx("button",{type:"button",onClick:e,className:ba("h-9 w-9 grid place-items-center rounded-xl ring-1","bg-base-100/30 ring-base-300/60","transition-all duration-150","hover:bg-base-100/60 hover:-translate-y-[1px] hover:shadow-sm","active:translate-y-0 active:shadow-none"),title:"닫기",children:"×"})]}),M.jsxs("div",{className:"mt-5 flex flex-col md:flex-row gap-5",children:[M.jsxs("div",{className:"flex-1 min-w-0",children:[M.jsxs("div",{className:"rounded-2xl ring-1 bg-base-100/25 ring-base-300/50 p-5",children:[M.jsx("div",{className:"text-xs opacity-70",children:"연결 정보"}),M.jsxs("div",{className:"mt-3 grid grid-cols-[72px_1fr] gap-y-2 text-sm",children:[M.jsx("div",{className:"opacity-70",children:"PC"}),M.jsx("div",{className:"text-right font-semibold break-all min-w-0",children:t?.pc||"-"}),M.jsx("div",{className:"opacity-70",children:"HTTP"}),M.jsx("div",{className:"text-right font-semibold",children:t?.httpPort??"-"}),M.jsx("div",{className:"opacity-70",children:"UDP"}),M.jsx("div",{className:"text-right font-semibold",children:t?.udpPort??"-"}),M.jsx("div",{className:"opacity-70",children:"Name"}),M.jsx("div",{className:"text-right font-semibold break-all min-w-0",children:t?.name??"-"})]}),M.jsxs("div",{className:"mt-5 flex flex-wrap gap-2",children:[M.jsx("button",{type:"button",onClick:f,disabled:!o,className:ba("px-4 py-2 rounded-2xl text-xs font-semibold ring-1","transition-all duration-150 whitespace-nowrap",o?"bg-base-100/35 ring-base-300/60 hover:bg-base-100/60 hover:-translate-y-[1px] hover:shadow-sm":"opacity-50 cursor-not-allowed bg-base-100/20 ring-base-300/40"),children:"페어링 문자열 복사"}),M.jsx("button",{type:"button",onClick:()=>e?.(),className:ba("px-4 py-2 rounded-2xl text-xs font-semibold ring-1","bg-base-100/20 ring-base-300/50 hover:bg-base-100/45 transition whitespace-nowrap"),children:"닫기"})]}),M.jsxs("div",{className:"mt-4",children:[M.jsx("div",{className:"text-[11px] opacity-60 mb-1",children:"페어링 URI"}),M.jsx("div",{className:ba("text-[11px] opacity-70 break-all","rounded-xl ring-1 bg-base-100/20 ring-base-300/40","p-3 max-h-20 overflow-auto"),children:n||"pairing 정보가 없습니다. (/api/pairing 확인)"}),M.jsxs("div",{className:"mt-3",children:[M.jsx("div",{className:"text-[11px] opacity-60 mb-1",children:"스트림 URL"}),M.jsx("div",{className:ba("text-[11px] opacity-70 break-all","rounded-xl ring-1 bg-base-100/20 ring-base-300/40","p-3"),children:r||"-"}),l.status==="fail"&&l.error?M.jsxs("div",{className:"mt-2 text-[11px] opacity-70",children:["오류: ",M.jsx("span",{className:"font-semibold",children:l.error})]}):null]}),M.jsxs("div",{className:"mt-4 rounded-2xl ring-1 bg-base-100/18 ring-base-300/40 p-4",children:[M.jsx("div",{className:"text-xs font-semibold",children:"연결 안내"}),M.jsxs("ul",{className:"mt-2 space-y-1 text-[11px] opacity-70 leading-relaxed list-disc pl-4",children:[M.jsxs("li",{children:["PC와 휴대폰은 ",M.jsx("b",{children:"같은 Wi-Fi(같은 네트워크)"}),"에 연결되어야 합니다."]}),M.jsxs("li",{children:["학원/회사 ",M.jsx("b",{children:"게스트 Wi-Fi"}),"는 단말 간 통신이 차단될 수 있습니다."]}),M.jsxs("li",{children:["연결이 안 되면 ",M.jsx("b",{children:"휴대폰 핫스팟에 PC를 연결"}),"하는 방법이 가장 확실합니다."]}),M.jsxs("li",{children:["원격(외부망) 연결은 ",M.jsx("b",{children:"VPN(Tailscale 등) 설치"}),"가 필요합니다."]})]})]})]})]}),M.jsx("div",{className:"mt-3 text-[11px] opacity-55",children:"팁: 스캔이 잘 안되면 창을 크게 하고, QR을 더 크게 표시하세요."})]}),M.jsx("div",{className:"shrink-0 w-full md:w-[320px]",children:M.jsx("div",{className:"rounded-2xl ring-1 bg-base-100/25 ring-base-300/50 p-5 flex items-center justify-center",children:o?M.jsx("div",{className:"bg-white rounded-2xl p-4 ring-1 ring-black/10 shadow-sm",children:M.jsx(pb,{value:n,size:248,includeMargin:!0})}):M.jsx("div",{className:"text-sm opacity-70",children:"QR 생성 불가"})})})]})]})})}const gk=120,vk=50,Hv=["OPEN_PALM","FIST","V_SIGN","PINCH_INDEX","OTHER"],lh={OPEN_PALM:"오픈 팜",FIST:"피스트",V_SIGN:"브이",PINCH_INDEX:"핀치",OTHER:"기타"},jv=[{id:"cursor",label:"주 손(커서)"},{id:"other",label:"보조 손"}],gi=Xn.create({baseURL:"/api",timeout:8e3,headers:{Accept:"application/json"}});function Ji(...i){return i.filter(Boolean).join(" ")}const xk=[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[17,18],[18,19],[19,20],[0,17]];function Td(i){return Array.isArray(i)&&i.length===21&&i.every(e=>e&&typeof e.x=="number"&&typeof e.y=="number")}function yk(i,e){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=i,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function _k(i,e){const{cursorLm:t,otherLm:n,theme:r,cursorLabel:o,otherLabel:l}=e,u=i;if(!u)return;const f=u.getBoundingClientRect(),h=Math.max(10,Math.floor(f.width)),m=Math.max(10,Math.floor(f.height)),g=window.devicePixelRatio||1;(u.width!==Math.floor(h*g)||u.height!==Math.floor(m*g))&&(u.width=Math.floor(h*g),u.height=Math.floor(m*g));const v=u.getContext("2d");if(!v)return;v.setTransform(g,0,0,g,0,0),v.clearRect(0,0,h,m),v.save(),v.globalAlpha=.25,v.lineWidth=1,v.strokeStyle=r==="light"?"rgba(0,0,0,0.35)":"rgba(255,255,255,0.25)";const S=40;for(let T=S;T<h;T+=S)v.beginPath(),v.moveTo(T,0),v.lineTo(T,m),v.stroke();for(let T=S;T<m;T+=S)v.beginPath(),v.moveTo(0,T),v.lineTo(h,T),v.stroke();v.restore();const _=(T,E,w,C,R)=>{if(Td(T)){v.save(),v.lineWidth=2,v.strokeStyle=E,v.globalAlpha=.95;for(const[L,G]of xk){const U=T[L],k=T[G];v.beginPath(),v.moveTo(U.x*h,U.y*m),v.lineTo(k.x*h,k.y*m),v.stroke()}v.fillStyle=w;for(let L=0;L<T.length;L++){const G=T[L],U=G.x*h,k=G.y*m,Z=L===8||L===4?5:3;v.beginPath(),v.arc(U,k,Z,0,Math.PI*2),v.fill()}v.globalAlpha=1,v.font="12px ui-sans-serif, system-ui, -apple-system",v.fillStyle=r==="light"?"rgba(0,0,0,0.75)":"rgba(255,255,255,0.85)",v.fillText(C,10,R),v.restore()}};_(t,"rgba(0,255,255,0.9)","rgba(0,255,255,0.9)",o||"주 손",18),_(n,"rgba(255,0,255,0.9)","rgba(255,0,255,0.9)",l||"보조 손",36)}function Sk(i,e,t){if(!i)return 0;const n=i[e];if(!n)return 0;const r=n[t];return typeof r=="number"?r:0}function Po({tone:i="neutral",children:e,title:t}){const n="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] leading-none ring-1 select-none",r=i==="ok"?"bg-emerald-500/12 ring-emerald-400/25 text-base-content":i==="bad"?"bg-rose-500/12 ring-rose-400/25 text-base-content":i==="warn"?"bg-amber-500/12 ring-amber-400/25 text-base-content":"bg-base-100/35 ring-base-300/50 text-base-content opacity-95";return M.jsx("span",{className:Ji(n,r),title:t,children:e})}function ch({done:i,label:e,hint:t}){return M.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[M.jsx("span",{className:Ji("h-2.5 w-2.5 rounded-full ring-1",i?"bg-emerald-400/80 ring-emerald-300/40":"bg-base-100/40 ring-base-300/50")}),M.jsxs("div",{className:"min-w-0",children:[M.jsx("div",{className:"text-[12px] font-semibold leading-none truncate",children:e}),t?M.jsx("div",{className:"text-[11px] opacity-70 leading-none mt-0.5 truncate",children:t}):null]})]})}function Qm(i){return String(i||"").trim().replace(/[^\p{Script=Hangul}a-zA-Z0-9 _-]/gu,"").slice(0,32).trim()}function wk({theme:i="dark"}){const{user:e,isAuthed:t}=Wx(),[n,r]=X.useState(null),[o,l]=X.useState(""),[u,f]=X.useState(""),[h,m]=X.useState(!0),[g,v]=X.useState("OPEN_PALM"),[S,_]=X.useState("cursor"),[T,E]=X.useState(2),[w,C]=X.useState(!1),R=X.useRef(null),[L,G]=X.useState(2),[U,k]=X.useState(0),Z=X.useRef(null),D=X.useRef(null),[H,W]=X.useState(!1),[ne,ge]=X.useState(""),[$,ie]=X.useState(""),[oe,fe]=X.useState([]),[q,K]=X.useState(0),[V,B]=X.useState(0),Y=e?.id??e?.memberId??e?.member_id??e?.email??null,ee=!t||!Y,he=X.useMemo(()=>ee?{}:{"X-User-Id":String(Y)},[ee,Y]),Re=X.useCallback(ue=>{const Be=String(ue||"");return Be==="default"?"기본(default)":Be},[]),Ue=X.useCallback((ue="이 작업")=>ee?(f(`게스트 모드에서는 ${ue}을(를) 사용할 수 없어. 로그인 후 다시 시도해줘. (기본 프로필만 사용 가능)`),!0):!1,[ee]),Fe=X.useMemo(()=>`trainingLab.dataset.v1.${ee?"guest":String(Y).replace(/[^a-zA-Z0-9_-]/g,"_").toLowerCase()}`,[ee,Y]),Ge=X.useRef({meta:{app:"GestureOS TrainingLab",createdAt:new Date().toISOString(),schema:"v1"},samples:[]}),[qe,We]=X.useState(0);X.useEffect(()=>{C(!1),R.current=null,B(0);try{const ue=localStorage.getItem(Fe);if(!ue){Ge.current={meta:{app:"GestureOS TrainingLab",createdAt:new Date().toISOString(),schema:"v1"},samples:[]},We(j=>j+1);return}const Be=JSON.parse(ue);Be&&Array.isArray(Be.samples)&&(Ge.current=Be,We(j=>j+1))}catch{}},[Fe]),X.useEffect(()=>{try{localStorage.setItem(Fe,JSON.stringify(Ge.current))}catch{}},[qe,Fe]),X.useEffect(()=>{K(Ge.current.samples.length)},[qe]),X.useEffect(()=>{if(!u&&!o)return;const ue=setTimeout(()=>{f(""),l("")},2400);return()=>clearTimeout(ue)},[u,o]);const st=X.useRef(null),Q=X.useRef(null),De=X.useRef(!1),Ee=X.useRef(null),ke=X.useRef(null);X.useEffect(()=>{ke.current=n},[n]);const Se=n?.cursorLandmarks??[],be=n?.otherLandmarks??[],se=!!n?.learnEnabled,F=n?.learnCounts||null,O=n?.learnCapture||null,ce=n?.learnLastTrainTs||0,Pe=n?.learnProfile||"default",we=Array.isArray(n?.learnProfiles)?n.learnProfiles:["default"],Te=typeof n?.learnHasBackup=="boolean"?n.learnHasBackup:null,rt=Te===null?!0:!!Te,He=X.useMemo(()=>{const ue=n||{};return{connected:!!ue.connected,mode:ue.mode||"-",gesture:ue.gesture||"NONE",otherGesture:ue.otherGesture||"NONE",fps:typeof ue.fps=="number"?ue.fps:null,cursorLmOk:Td(Se),otherLmOk:Td(be)}},[n,Se,be]),ot=S==="cursor"?He.cursorLmOk:He.otherLmOk,_t=Sk(F,S,g),Et=ue=>{const Be=ke.current||n||{},j=ue==="cursor"?Be.cursorLandmarks??[]:Be.otherLandmarks??[];return Td(j)},Oe=async(ue,Be=2500)=>{const j=Date.now();for(;Date.now()-j<Be;){if(Et(ue))return!0;await new Promise(de=>setTimeout(de,120))}return Et(ue)},Ot=!0,It=!!ot,Ct=_t>=vk,bt=Number(ce||0)>0,yt=!!se,Wt=X.useMemo(()=>{const ue={};for(const Be of jv){ue[Be.id]={};for(const j of Hv)ue[Be.id][j]=0}for(const Be of Ge.current.samples)ue?.[Be.hand]?.[Be.label]!==void 0&&(ue[Be.hand][Be.label]+=1);return ue},[qe]);X.useEffect(()=>{if(ee){fe([]);return}let ue=!0;return(async()=>{try{const{data:Be}=await gi.get("/train/profile/db/list",{headers:he}),j=Array.isArray(Be?.profiles)?Be.profiles:[];ue&&fe(j)}catch{ue&&fe([])}})(),()=>{ue=!1}},[ee,he]);const on=X.useMemo(()=>{const ue=new Set(["default",Pe,...we||[],...oe||[]]),Be=Array.from(ue).filter(Boolean),j=Be.filter(ve=>ve==="default").map(ve=>({value:ve,label:Re(ve)})),de=Be.filter(ve=>ve!=="default").sort((ve,ye)=>String(ve).localeCompare(String(ye))).map(ve=>({value:ve,label:Re(ve)}));return[...j,...de]},[Pe,we,oe,Re]),tn=X.useCallback(async()=>{st.current&&st.current.abort();const ue=new AbortController;st.current=ue;try{const{data:Be}=await gi.get("/train/stats",{signal:ue.signal,headers:he});r(Be),l("")}catch(Be){if(Be?.name==="CanceledError"||Be?.name==="AbortError")return;const j=Be?.response?`상태 조회 실패 (HTTP ${Be.response.status})${Be.response.data?`: ${String(Be.response.data)}`:""}`:Be?.message||"상태 조회 실패";l(j)}finally{m(!1)}},[he]),Xt=X.useCallback(()=>{De.current||(Q.current&&clearTimeout(Q.current),Q.current=setTimeout(async()=>{await tn(),Xt()},gk))},[tn]);X.useEffect(()=>(De.current=!1,(async()=>(await tn(),Xt()))(),()=>{De.current=!0,Q.current&&clearTimeout(Q.current),st.current&&st.current.abort(),D.current&&clearInterval(D.current)}),[tn,Xt]),X.useEffect(()=>{const ue=Ee.current;ue&&_k(ue,{cursorLm:Se,otherLm:be,theme:i,cursorLabel:`주 손 (${He.gesture})`,otherLabel:`보조 손 (${He.otherGesture})`})},[Se,be,i,He.gesture,He.otherGesture]),X.useEffect(()=>{if(!w)return;const ue=R.current;if(!ue)return;const j=Date.now()-ue.startedAt,de=Math.max(.5,Number(ue.seconds)||2)*1e3,ve=ue.hand==="cursor"?Se:be;Td(ve)&&(Ge.current.samples.push({ts:new Date().toISOString(),hand:ue.hand,label:ue.label,mode:n?.mode??null,제스처:n?.gesture??null,otherGesture:n?.otherGesture??null,landmarks:ve.map(ye=>({x:ye.x,y:ye.y,z:ye.z}))}),ue.collected+=1,B(ue.collected),K(Ge.current.samples.length),We(ye=>ye+1)),j>=de&&(C(!1),R.current=null,We(ye=>ye+1))},[n,Se,be,w]);const et=()=>{const ue=Math.max(.5,Math.min(10,Number(T)||2));R.current={startedAt:Date.now(),seconds:ue,label:g,hand:S,collected:0},B(0),C(!0)},ae=()=>{const ue=S==="cursor"?Se:be;if(!Td(ue)){l("랜드마크가 아직 안 잡혔어 (21개 포인트 필요)");return}Ge.current.samples.push({ts:new Date().toISOString(),hand:S,label:g,mode:n?.mode??null,제스처:n?.gesture??null,otherGesture:n?.otherGesture??null,landmarks:ue.map(Be=>({x:Be.x,y:Be.y,z:Be.z}))}),K(Ge.current.samples.length),We(Be=>Be+1)},it=()=>{Ge.current={meta:{app:"GestureOS TrainingLab",createdAt:new Date().toISOString(),schema:"v1"},samples:[]},B(0),K(0),We(ue=>ue+1)},lt=()=>{const ue=new Date().toISOString().replace(/[:.]/g,"-");yk(`gestureos-training-${ue}.json`,Ge.current)},Dt=X.useCallback(()=>{D.current&&(clearInterval(D.current),D.current=null),Z.current=null,k(0)},[]),Rt=X.useRef(!1),hn=()=>{Pe==="default"&&(Rt.current||(Rt.current=!0,f("기본(default) 프로필은 공용일 수 있어. 가능하면 새 프로필 만들어서 진행해.")))},pn=async ue=>{if(l(""),f(""),Ue("서버 샘플 수집"))return;const Be=ue?.hand??S,j=ue?.label??g,de=ue?.seconds??(Number(T)||2),ve=ue?.hz??15;hn(),W(!0);try{const{data:ye}=await gi.post("/train/capture",null,{params:{hand:Be,label:j,seconds:de,hz:ve},headers:he});f(ye?.ok?"서버 샘플 수집 시작":"서버 샘플 수집 실패"),await tn()}catch(ye){const _e=ye?.response?`서버 샘플 수집 실패 (HTTP ${ye.response.status})${ye.response.data?`: ${String(ye.response.data)}`:""}`:ye?.message||"서버 샘플 수집 실패";l(_e)}finally{W(!1)}},Ln=()=>{if(l(""),f(""),Ue("서버 샘플 수집"))return;const ue=Math.max(0,Math.min(10,Number(L)||0)),Be={kind:"server",fireAt:Date.now()+ue*1e3,hand:S,label:g,seconds:Number(T)||2,hz:15};if(ue<=.01){pn(Be);return}Dt(),Z.current=Be,k(Math.ceil(ue)),D.current=setInterval(()=>{const j=Be.fireAt-Date.now();j<=0?(Dt(),(async()=>{if(!await Oe(Be.hand,2500)){l("손이 아직 안 잡혀서 수집을 시작 못했어. 손을 올린 뒤 다시 눌러줘");return}await pn(Be)})()):k(Math.ceil(j/1e3))},100)},Yn=async()=>{if(l(""),f(""),!Ue("서버 학습")){hn(),W(!0);try{const{data:ue}=await gi.post("/train/train",null,{headers:he});f(ue?.ok?"학습 완료":"학습 실패"),await tn()}catch(ue){const Be=ue?.response?`서버 학습 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"서버 학습 실패";l(Be)}finally{W(!1)}}},mn=async()=>{if(l(""),f(""),!Ue("학습 적용")){W(!0);try{const ue=!se,{data:Be}=await gi.post("/train/enable",null,{params:{적용:ue},headers:he});f(Be?.ok?ue?"학습 적용: 켜짐":"학습 적용: 꺼짐":"적용 전환 실패"),await tn()}catch(ue){const Be=ue?.response?`적용 전환 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"적용 전환 실패";l(Be)}finally{W(!1)}}},qn=async()=>{if(l(""),f(""),!Ue("초기화")){if(Pe==="default"){f("기본(default)은 공용일 수 있어서 초기화는 막아뒀어. 새 프로필로 진행해.");return}W(!0);try{const{data:ue}=await gi.post("/train/reset",null,{headers:he});f(ue?.ok?"초기화 완료":"초기화 실패"),await tn()}catch(ue){const Be=ue?.response?`초기화 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"초기화 실패";l(Be)}finally{W(!1)}}},rr=async()=>{if(l(""),f(""),!Ue("되돌리기")){if(Pe==="default"){f("기본(default)은 공용일 수 있어서 되돌리기는 막아뒀어. 새 프로필로 진행해.");return}W(!0);try{const{data:ue}=await gi.post("/train/rollback",null,{headers:he});f(ue?.ok?"되돌리기 완료":"되돌리기 실패"),await tn()}catch(ue){const Be=ue?.response?`되돌리기 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"되돌리기 실패";l(Be)}finally{W(!1)}}},xs=async ue=>{const Be=ee?"default":String(ue||"default");if(ee&&Be!=="default"){f("게스트 모드에서는 기본(default)만 사용할 수 있어.");return}l(""),f(""),W(!0);try{const{data:j}=await gi.post("/train/profile/set",null,{params:{name:Be},headers:he});f(j?.ok?`프로필 적용: ${Re(Be)}`:"프로필 적용 실패"),await tn()}catch(j){const de=j?.response?`프로필 적용 실패 (HTTP ${j.response.status})${j.response.data?`: ${String(j.response.data)}`:""}`:j?.message||"프로필 적용 실패";l(de)}finally{W(!1)}},gt=async()=>{if(Ue("프로필 생성"))return;const ue=Qm(ne);if(!ue){l("프로필 이름이 비었거나 사용할 수 없는 문자야.");return}l(""),f(""),W(!0);try{const{data:Be}=await gi.post("/train/profile/create",null,{params:{name:ue,copy:!0},headers:he});if(!Be?.ok){l(`프로필 생성 실패${Be?`: ${JSON.stringify(Be)}`:""}`);return}f(`프로필 생성: ${Re(ue)}`),ge(""),await xs(ue);try{const j=await gi.get("/train/profile/db/list",{headers:he});fe(Array.isArray(j?.data?.profiles)?j.data.profiles:[])}catch{}}catch(Be){const j=Be?.response?`프로필 생성 실패 (HTTP ${Be.response.status})${Be.response.data?`: ${String(Be.response.data)}`:""}`:Be?.message||"프로필 생성 실패";l(j)}finally{W(!1)}},je=async()=>{if(!Ue("프로필 삭제")){if(Pe==="default"){f("기본(default)은 삭제할 수 없어.");return}l(""),f(""),W(!0);try{const{data:ue}=await gi.post("/train/profile/delete",null,{params:{name:Pe},headers:he});f(ue?.ok?`프로필 삭제: ${Re(Pe)}`:"프로필 삭제 실패"),await tn();try{const Be=await gi.get("/train/profile/db/list",{headers:he});fe(Array.isArray(Be?.data?.profiles)?Be.data.profiles:[])}catch{}}catch(ue){const Be=ue?.response?`프로필 삭제 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"프로필 삭제 실패";l(Be)}finally{W(!1)}}},Ut=async()=>{if(Ue("프로필 이름 변경"))return;if(Pe==="default"){f("기본(default)은 이름을 바꿀 수 없어.");return}const ue=Qm($);if(!ue){l("새 이름이 비었거나 사용할 수 없는 문자야.");return}l(""),f(""),W(!0);try{const{data:Be}=await gi.post("/train/profile/rename",null,{params:{from:Pe,to:ue},headers:he});f(Be?.ok?`이름 변경: ${Re(Pe)} → ${Re(ue)}`:"이름 변경 실패"),ie(""),await tn();try{const j=await gi.get("/train/profile/db/list",{headers:he});fe(Array.isArray(j?.data?.profiles)?j.data.profiles:[])}catch{}}catch(Be){const j=Be?.response?`이름 변경 실패 (HTTP ${Be.response.status})${Be.response.data?`: ${String(Be.response.data)}`:""}`:Be?.message||"이름 변경 실패";l(j)}finally{W(!1)}},zt=X.useRef(!1);X.useEffect(()=>{if(ee||!He.connected){zt.current=!1;return}zt.current||(zt.current=!0,(async()=>{try{const ue="main";if(!new Set([...we||[],...oe||[],Pe]).has(ue)){const j=await gi.post("/train/profile/create",null,{params:{name:ue,copy:!0},headers:he});if(!j?.data?.ok){l(`자동 main 생성 실패: ${JSON.stringify(j?.data||{})}`);return}}if(Pe==="default"){const j=await gi.post("/train/profile/set",null,{params:{name:ue},headers:he});if(!j?.data?.ok){l(`자동 main 선택 실패: ${JSON.stringify(j?.data||{})}`);return}}await tn()}catch(ue){const Be=ue?.response?`자동 main 세팅 실패 (HTTP ${ue.response.status})${ue.response.data?`: ${String(ue.response.data)}`:""}`:ue?.message||"자동 main 세팅 실패";l(Be)}})())},[ee,He.connected]);const dn=X.useMemo(()=>{if(!O)return null;const ue=O.hand||"-",Be=O.label||"-",j=O.collected??0,de=ue==="cursor"?"주 손":ue==="other"?"보조 손":ue,ve=lh[Be]??Be;return`수집 중: ${de} / ${ve} / ${j}`},[O]),Rn=X.useMemo(()=>{if(!U)return null;const ue=Z.current,Be=ue?.hand||S,j=ue?.label||g,de=Be==="cursor"?"주 손":Be==="other"?"보조 손":Be,ve=lh[j]??j;return`준비 중: ${de} / ${ve} / ${U}s`},[U,S,g]),Kn=X.useMemo(()=>{const ue=Number(ce||0);if(!ue)return null;try{return new Date(ue*1e3).toLocaleString()}catch{return String(ue)}},[ce]);return M.jsxs("div",{className:"p-6 space-y-6 relative",children:[M.jsxs("div",{className:"toast toast-top toast-end z-[10050] mt-16",children:[u?M.jsxs("div",{className:"flex items-start gap-3 rounded-2xl px-4 py-3 shadow-xl backdrop-blur-md bg-base-100/80 ring-1 ring-emerald-400/20",children:[M.jsx("svg",{className:"h-5 w-5 mt-0.5 shrink-0 text-emerald-400",viewBox:"0 0 24 24",fill:"none",children:M.jsx("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round"})}),M.jsxs("div",{className:"text-sm leading-snug min-w-[220px]",children:[M.jsx("div",{className:"font-semibold text-emerald-400",children:"완료"}),M.jsx("div",{className:"opacity-80",children:u})]}),M.jsx("button",{type:"button",className:"btn btn-ghost btn-xs rounded-xl",onClick:()=>f(""),"aria-label":"close",title:"닫기",children:"✕"})]}):null,o?M.jsxs("div",{className:"flex items-start gap-3 rounded-2xl px-4 py-3 shadow-xl backdrop-blur-md bg-base-100/80 ring-1 ring-rose-400/20",children:[M.jsx("svg",{className:"h-5 w-5 mt-0.5 shrink-0 text-rose-400",viewBox:"0 0 24 24",fill:"none",children:M.jsx("path",{d:"M12 9v4m0 4h.01M10.29 3.86l-7.2 12.47A2 2 0 004.82 19h14.36a2 2 0 001.73-2.67l-7.2-12.47a2 2 0 00-3.46 0z",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round"})}),M.jsxs("div",{className:"text-sm leading-snug min-w-[220px]",children:[M.jsx("div",{className:"font-semibold text-rose-400",children:"오류"}),M.jsx("div",{className:"opacity-80",children:o})]}),M.jsx("button",{type:"button",className:"btn btn-ghost btn-xs rounded-xl",onClick:()=>l(""),"aria-label":"close",title:"닫기",children:"✕"})]}):null]}),M.jsx("div",{className:"flex items-end justify-between gap-4 flex-wrap",children:M.jsxs("div",{className:"space-y-2",children:[M.jsxs("div",{className:"flex items-baseline gap-3 flex-wrap",children:[M.jsx("div",{className:"text-2xl font-bold",children:"모션 인식 학습"}),M.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[M.jsx(Po,{tone:ee?"warn":"ok",title:"로그인 상태",children:ee?"게스트":"로그인됨"}),M.jsx(Po,{tone:He.connected?"ok":"bad",title:"Agent WebSocket",children:He.connected?"연결됨":"연결 끊김"}),M.jsxs(Po,{title:"현재 모드",children:["모드: ",He.mode]}),M.jsxs(Po,{title:"학습 프로필",children:["프로필: ",Re(Pe)]}),M.jsxs(Po,{tone:se?"ok":"neutral",title:"학습 적용",children:["학습 적용: ",se?"켜짐":"꺼짐"]})]})]}),M.jsxs("details",{className:"max-w-[720px]",children:[M.jsx("summary",{className:"cursor-pointer text-xs opacity-70 select-none",children:"사용 방법(간단)"}),M.jsxs("div",{className:"mt-2 text-xs opacity-75 leading-relaxed",children:["1) ",M.jsx("b",{children:"프로필"})," 선택 → 2) ",M.jsx("b",{children:"샘플 수집"})," (준비시간 후 시작) → 3) ",M.jsx("b",{children:"학습"})," → 4) ",M.jsx("b",{children:"적용 켜기"}),". 문제가 생기면 ",M.jsx("b",{children:"되돌리기"})," 또는 ",M.jsx("b",{children:"초기화"}),".",ee?M.jsxs(M.Fragment,{children:[M.jsx("br",{}),M.jsx("span",{className:"text-amber-300/90",children:"게스트 모드: 서버 학습/프로필 저장은 제한되며 기본 프로필만 사용 가능"})]}):null]})]})]})}),M.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[M.jsxs("div",{className:Ji("rounded-2xl ring-1 ring-base-300/50 bg-base-200/70 shadow-xl overflow-hidden"),children:[M.jsxs("div",{className:"px-5 py-4 border-b border-base-300/40 flex items-center justify-between",children:[M.jsx("div",{className:"font-semibold",children:"랜드마크 미리보기"}),M.jsx("div",{className:"text-xs opacity-70",children:h?"불러오는 중...":He.connected?"연결됨":"연결 끊김"})]}),M.jsxs("div",{className:"p-4",children:[M.jsx("div",{className:"w-full aspect-video rounded-xl ring-1 ring-base-300/40 bg-base-100/30 overflow-hidden",children:M.jsx("canvas",{ref:Ee,className:"w-full h-full"})}),M.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[M.jsxs("div",{className:Ji("rounded-xl ring-1 ring-base-300/40 bg-base-100/25 p-3"),children:[M.jsx("div",{className:"text-xs opacity-70",children:"주 손 랜드마크"}),M.jsx("div",{className:"mt-1 text-sm font-semibold",children:He.cursorLmOk?"정상 (21)":Array.isArray(Se)?`미인식 (${Se.length||0})`:"-"}),M.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["제스처: ",He.gesture]})]}),M.jsxs("div",{className:Ji("rounded-xl ring-1 ring-base-300/40 bg-base-100/25 p-3"),children:[M.jsx("div",{className:"text-xs opacity-70",children:"보조 손 랜드마크"}),M.jsx("div",{className:"mt-1 text-sm font-semibold",children:He.otherLmOk?"정상 (21)":Array.isArray(be)?`미인식 (${be.length||0})`:"-"}),M.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["제스처: ",He.otherGesture]})]})]})]})]}),M.jsxs("div",{className:Ji("rounded-2xl ring-1 ring-base-300/50 bg-base-200/70 shadow-xl overflow-hidden"),children:[M.jsxs("div",{className:"px-5 py-4 border-b border-base-300/40 flex items-center justify-between gap-3 flex-wrap",children:[M.jsx("div",{className:"font-semibold",children:"설정"}),M.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[M.jsx(Po,{tone:It?"ok":"warn",title:"선택한 손 랜드마크 상태",children:It?"손 인식됨":"손 미인식"}),M.jsxs(Po,{tone:Ct?"ok":"neutral",title:"학습에 필요한 샘플 상태",children:["샘플: ",Ct?"충분":"부족"]}),Kn?M.jsxs(Po,{title:"마지막 학습",children:["최근 학습: ",Kn]}):null]})]}),M.jsxs("div",{className:"p-5 space-y-4",children:[M.jsxs("div",{className:Ji("rounded-2xl ring-1 ring-base-300/40 bg-base-100/15 p-4"),title:"프로필 → 수집 → 학습 → 적용 순서",children:[M.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[M.jsx(ch,{done:Ot,label:"1. 프로필",hint:Re(Pe)}),M.jsx(ch,{done:It,label:"2. 인식",hint:It?"정상":"손이 안 잡힘"}),M.jsx(ch,{done:Ct,label:"3. 수집",hint:Ct?"충분":"부족"}),M.jsx(ch,{done:bt,label:"4. 학습",hint:bt?"완료":"미실행"}),M.jsx(ch,{done:yt,label:"5. 적용",hint:yt?"적용됨":"꺼짐"})]}),M.jsxs("div",{className:"mt-3 flex items-center justify-between gap-3 flex-wrap",children:[M.jsxs("div",{className:"text-xs opacity-70",children:["선택: ",M.jsx("b",{children:S==="cursor"?"주 손":"보조 손"})," · ",M.jsx("b",{children:lh[g]??g})," ·"," ",Number(T)||2,"초"]}),M.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Rn?M.jsx(Po,{tone:"warn",title:"준비 중",children:Rn}):null,dn?M.jsx(Po,{tone:"warn",title:"서버 수집 중",children:dn}):null,M.jsx("button",{type:"button",className:Ji("btn btn-xs btn-ghost rounded-xl"),onClick:tn,title:"상태 새로고침",children:"새로고침"})]})]})]}),M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"라벨"}),M.jsx("select",{className:"select select-sm w-full rounded-xl",value:g,onChange:ue=>v(ue.target.value),children:Hv.map(ue=>M.jsx("option",{value:ue,children:lh[ue]??ue},ue))})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"손"}),M.jsx("select",{className:"select select-sm w-full rounded-xl",value:S,onChange:ue=>_(ue.target.value),children:jv.map(ue=>M.jsx("option",{value:ue.id,children:ue.label},ue.id))})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"수집 시간(초)"}),M.jsx("input",{className:"input input-sm w-full rounded-xl",type:"number",min:.5,max:10,step:.5,value:T,onChange:ue=>E(ue.target.value)})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"준비 시간(초)"}),M.jsx("input",{className:"input input-sm w-full rounded-xl",type:"number",min:0,max:10,step:.5,value:L,onChange:ue=>G(ue.target.value)})]})]}),M.jsxs("div",{className:"rounded-xl ring-1 ring-base-300/40 bg-base-100/20 p-4",children:[M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsxs("div",{children:[M.jsx("div",{className:"font-semibold text-sm",children:"서버 학습기"}),M.jsx("div",{className:"text-xs opacity-70 mt-1",children:"샘플 수집 → 학습 → 적용"})]}),M.jsxs("div",{className:"text-xs opacity-70",children:["적용:"," ",M.jsx("span",{className:Ji("font-semibold",se?"text-success":"opacity-70"),children:se?"켜짐":"꺼짐"})]})]}),M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-3",children:[M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"프로필"}),M.jsx("select",{className:"select select-sm w-full rounded-xl",value:Pe,disabled:H,onChange:ue=>xs(ue.target.value),children:on.map(ue=>M.jsx("option",{value:ue.value,children:ue.label},ue.value))})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"새 프로필"}),M.jsx("input",{className:"input input-sm w-full rounded-xl",value:ne,onChange:ue=>ge(ue.target.value),placeholder:"예: main, office, myhand",disabled:H||ee})]}),M.jsx("div",{className:"flex items-end",children:M.jsx("button",{className:"btn btn-sm rounded-xl w-full",onClick:gt,disabled:H||ee||!Qm(ne),title:ee?"게스트 모드에서는 프로필 생성 불가":"",children:"생성(복사)"})})]}),M.jsxs("details",{className:"mt-3 rounded-xl ring-1 ring-base-300/40 bg-base-100/10 p-3",children:[M.jsx("summary",{className:"cursor-pointer select-none text-sm font-semibold",children:"고급: 이름 변경 / 삭제"}),M.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3",children:[M.jsxs("div",{className:"md:col-span-2",children:[M.jsx("div",{className:"text-xs opacity-70 mb-1",children:"이름 변경(현재 → 새 이름)"}),M.jsx("input",{className:"input input-sm w-full rounded-xl",value:$,onChange:ue=>ie(ue.target.value),placeholder:ee?"게스트는 이름 변경 불가":Pe==="default"?"기본 프로필은 이름 변경 불가":"새 이름",disabled:H||ee||Pe==="default"})]}),M.jsx("div",{className:"flex items-end gap-2",children:M.jsx("button",{className:"btn btn-sm rounded-xl w-full",onClick:Ut,disabled:H||ee||Pe==="default"||!Qm($),children:"이름 변경"})})]}),M.jsx("div",{className:"mt-3",children:M.jsx("button",{className:"btn btn-sm btn-ghost rounded-xl",onClick:()=>{ee||Pe!=="default"&&window.confirm(`프로필 '${Re(Pe)}' 를 삭제할까요?`)&&je()},disabled:H||ee||Pe==="default",children:"현재 프로필 삭제"})})]}),M.jsxs("div",{className:"flex items-center gap-2 flex-wrap mt-3",children:[M.jsx("button",{type:"button",className:Ji("btn btn-sm rounded-xl",U>0?"btn-warning":"btn-primary"),onClick:()=>{U>0?Dt():Ln()},disabled:H||!He.connected||ee,title:ot?"":"손이 안 잡혀도 예약 수집 가능. 준비 시간 안에 손을 올려줘",children:U>0?`준비중 ${U}s · 취소`:"샘플 수집"}),M.jsx("button",{type:"button",className:Ji("btn btn-sm rounded-xl"),onClick:Yn,disabled:H||!He.connected||!Ct||ee,title:Ct?"":"샘플이 아직 부족해. 샘플 수집을 더 해줘",children:"학습"}),M.jsx("button",{type:"button",className:Ji("btn btn-sm rounded-xl",se?"btn-warning":"btn-success"),onClick:mn,disabled:H||!He.connected||ee||!se&&!bt,title:!se&&!bt?"적용 전에 학습을 먼저 해줘":"",children:se?"적용 끄기":"적용 켜기"}),M.jsx("button",{type:"button",className:Ji("btn btn-sm btn-ghost rounded-xl"),onClick:()=>{if(!ee){if(Pe==="default"){f("기본(default)은 공용일 수 있어서 초기화는 막아뒀어. 새 프로필로 진행해.");return}window.confirm("서버 학습기를 초기화할까요? (프로필 모델이 리셋돼요)")&&qn()}},disabled:H||!He.connected||ee,children:"초기화"}),M.jsx("button",{type:"button",className:Ji("btn btn-sm rounded-xl","btn-outline"),onClick:()=>{if(!ee&&rt){if(Pe==="default"){f("기본(default)은 공용일 수 있어서 되돌리기는 막아뒀어. 새 프로필로 진행해.");return}window.confirm("직전 학습 상태로 되돌릴까요?")&&rr()}},disabled:H||!He.connected||!rt||ee,title:rt?"바로 이전 학습 상태로 되돌리기":"백업이 없어서 되돌리기 불가",children:"되돌리기"})]}),Rn?M.jsx("div",{className:"mt-2 text-xs opacity-70",children:Rn}):null,dn?M.jsx("div",{className:"mt-2 text-xs opacity-70",children:dn}):null,Kn?M.jsxs("div",{className:"mt-1 text-xs opacity-70",children:["최근 학습: ",M.jsx("span",{className:"font-semibold opacity-90",children:Kn})]}):null]}),M.jsxs("details",{className:"rounded-xl ring-1 ring-base-300/40 bg-base-100/10 p-4",children:[M.jsx("summary",{className:"cursor-pointer select-none text-sm font-semibold",children:"로컬 샘플 관리"}),M.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3",children:[M.jsxs("div",{className:"rounded-xl ring-1 ring-base-300/30 bg-base-100/15 p-3",children:[M.jsx("div",{className:"text-xs opacity-70",children:"로컬 누적 샘플"}),M.jsx("div",{className:"mt-1 text-sm font-semibold",children:q}),w?M.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["수집 중… (+",V,")"]}):M.jsx("div",{className:"text-xs opacity-70 mt-1",children:"대기"})]}),M.jsx("div",{className:"flex items-end gap-2",children:M.jsx("button",{className:"btn btn-sm rounded-xl w-full",onClick:et,disabled:!He.connected,children:"로컬 연속 수집"})}),M.jsx("div",{className:"flex items-end gap-2",children:M.jsx("button",{className:"btn btn-sm btn-ghost rounded-xl w-full",onClick:ae,disabled:!He.connected,children:"스냅샷 1장 추가"})})]}),M.jsxs("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[M.jsx("button",{className:"btn btn-sm btn-ghost rounded-xl",onClick:lt,children:"내보내기(JSON)"}),M.jsx("button",{className:"btn btn-sm btn-ghost rounded-xl",onClick:()=>{window.confirm("로컬 샘플을 전부 지울까?")&&it()},children:"로컬 초기화"})]}),M.jsxs("details",{className:"mt-3",children:[M.jsx("summary",{className:"cursor-pointer select-none text-xs opacity-70",children:"라벨별 로컬 카운트 보기"}),M.jsx("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2",children:jv.map(ue=>M.jsxs("div",{className:"rounded-xl ring-1 ring-base-300/30 bg-base-100/15 p-3",children:[M.jsx("div",{className:"text-xs opacity-70",children:ue.label}),M.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:Hv.map(Be=>M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("span",{className:"opacity-80",children:lh[Be]??Be}),M.jsx("span",{className:"font-semibold",children:Wt?.[ue.id]?.[Be]??0})]},Be))})]},ue.id))})]})]})]})]})]})]})}const KS=new Set(["dark","light","neon","rose","devil"]);function Md(...i){return i.filter(Boolean).join(" ")}function Mk(){const[i,e]=X.useState(()=>{const k=localStorage.getItem("hudOn");return k===null?!0:k==="1"}),[t,n]=X.useState(()=>{const k=localStorage.getItem("osHudOn");return k===null?!0:k==="1"});X.useEffect(()=>window.managerWin?.onDeepLink?window.managerWin.onDeepLink(async Z=>{try{let D=null;try{D=new URL(Z).searchParams.get("code")}catch{const ne=Z.split("?")[1]||"";D=new URLSearchParams(ne).get("code")}if(!D)return;const H=await fetch("/api/auth/bridge/consume",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({code:D})});if(!H.ok)throw new Error(`consume failed: ${H.status}`);const W=await H.json();W?.accessToken&&localStorage.setItem("accessToken",W.accessToken),window.location.reload()}catch(D){console.error("deeplink auth failed:",D)}}):void 0,[]),X.useEffect(()=>{localStorage.setItem("hudOn",i?"1":"0")},[i]),X.useEffect(()=>{localStorage.setItem("osHudOn",t?"1":"0"),fetch(`/api/hud/show?enabled=${t?"true":"false"}`,{method:"POST"}).catch(()=>{})},[t]);const r=()=>e(k=>!k),o=()=>n(k=>!k),[l,u]=X.useState("dashboard"),[f,h]=X.useState(null),m=X.useRef({}),[g,v]=X.useState(!1),[S,_]=X.useState(()=>({pc:"",httpPort:8081,udpPort:39500,name:"PC"})),T=()=>{let k=!1;return fetch("/api/pairing").then(Z=>Z.ok?Z.json():Promise.reject(Z.status)).then(Z=>{k||!Z||_(D=>({...D,...Z}))}).catch(()=>{}),()=>{k=!0}},E=async k=>{const Z=String(k||"").trim()||"PC";try{await fetch("/api/pairing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Z})})}catch{}T()},w=async k=>{const Z=String(k||"").trim();if(Z){try{await fetch("/api/pairing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pc:Z})})}catch{}T()}};X.useEffect(()=>T(),[]);const[C,R]=X.useState(()=>{const k=localStorage.getItem("theme")||"dark";return KS.has(k)?k:"dark"}),L=k=>{const Z=String(k||"").trim();KS.has(Z)&&R(Z)};X.useEffect(()=>{document.documentElement.setAttribute("data-theme",C),localStorage.setItem("theme",C)},[C]);const G=Al[C]||Al.dark,U=X.useMemo(()=>({connected:!!f?.connected,locked:!!f?.locked,mode:f?.mode??"DEFAULT",cameraPresent:f?.cameraPresent??null,modeText:f?.modeText??void 0}),[f]);return M.jsxs("div",{"data-theme":C,className:Md("w-[100dvw] h-[100dvh] flex flex-col overflow-hidden min-w-0 min-h-0 relative",G.page),children:[M.jsxs("div",{className:"pointer-events-none fixed inset-0 z-0",children:[M.jsx("div",{className:Md("absolute -top-40 -left-40 h-[520px] w-[520px] rounded-full blur-3xl",G.glow1)}),M.jsx("div",{className:Md("absolute -bottom-52 -right-48 h-[560px] w-[560px] rounded-full blur-3xl",G.glow2)}),M.jsx("div",{className:Md("absolute inset-0 bg-[size:60px_60px]",G.grid)})]}),M.jsx("div",{className:"relative z-30",children:M.jsx(PA,{hudOn:i,onToggleHud:r,osHudOn:t,onToggleOsHud:o,screen:l,onChangeScreen:u,theme:C,setTheme:L,agentStatus:U,onOpenPairing:()=>{T(),v(!0)}})}),M.jsxs("main",{className:Md("relative z-10 flex-1 min-h-0 min-w-0 text-sm",l==="rush"?"overflow-hidden":"overflow-auto",l!=="rush"?i?"pb-28":"pb-6":""),children:[M.jsx("div",{className:Md(l==="dashboard"?"block":"hidden","w-full min-w-0"),children:M.jsx(r2,{hudOn:i,onToggleHud:r,onHudState:h,onHudActions:k=>{m.current=k||{}},theme:C,onChangeScreen:u})}),l==="rush"&&M.jsx(sk,{status:f?.status,connected:f?.connected??!0}),l==="settings"&&M.jsx(i2,{theme:C}),l==="train"&&M.jsx(wk,{theme:C})]}),M.jsxs("div",{className:"relative z-40",children:[i&&M.jsx(d2,{status:f?.status,connected:f?.connected??!0,modeOptions:f?.modeOptions,onSetMode:k=>m.current.applyMode?.(k),onEnableToggle:k=>k?m.current.start?.():m.current.stop?.(),onPreviewToggle:()=>m.current.togglePreview?.(),onLockToggle:k=>m.current.setLock?m.current.setLock(k):m.current.lockToggle?.(),onRequestHide:()=>e(!1)}),M.jsx(mk,{open:g,onClose:()=>v(!1),pairing:S,onSaveName:E,onSavePc:w})]})]})}const Ek={dark:"auto",neon:"auto",rose:"auto",devil:"url('/cursor/devil.png') 16 16, auto"};function bk(i){const e=Sw.includes(i)?i:"dark";document.documentElement.setAttribute("data-theme",e),document.body.style.cursor=Ek[e]||"auto";try{localStorage.setItem("theme",e)}catch{}return e}function Tk(){try{const i=localStorage.getItem("theme");if(i&&Sw.includes(i))return i}catch{}return"dark"}bk(Tk());Xb.createRoot(document.getElementById("root")).render(M.jsx(X.StrictMode,{children:M.jsx(kA,{children:M.jsx(Mk,{})})}));
C:\puh\puh\manager\GestureOSManager\front\dist\audio\rush_e.mp3:5660:�	َ� @�}�I��ك��a!���!9����`���a�`��0l80��80\0$U
